
(env) F:\Lab\nfs\base-ndiris>python runner.py 
2021-11-19 14:45:29.996835: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-11-19 14:45:31.462868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 14:45:31.464394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
F:\Lab\env\lib\site-packages\tensorflow_addons\utils\ensure_tf_install.py:53: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.3.0 and strictly below 2.6.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.7.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  warnings.warn(
WARNING:tensorflow:From F:\Lab\nfs\base-ndiris\main.py:20: The name tf.keras.backend.set_session is deprecated. Please use tf.compat.v1.keras.backend.set_session instead.

2021-11-19 14:45:32.138087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 14:45:32.138131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
WARNING:tensorflow:From F:\Lab\nfs\base-ndiris\dataset.py:119: rejection_resample (from tensorflow.python.data.experimental.ops.resampling) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.rejection_resample(...)`.
WARNING:tensorflow:From F:\Lab\env\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:6093: Print (from tensorflow.python.ops.logging_ops) is deprecated and will be removed after 2018-08-20.
Instructions for updating:
Use tf.print instead of tf.Print. Note that tf.print returns a no-output operator that directly prints the output. Outside of defuns or eager mode, this operator will not be executed unless it is directly specified in session.run or used as a control dependency for other operators. This is only a concern in graph mode. Below is an example of how to ensure tf.print executes in graph mode:

2021-11-19 14:47:11.813242: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8202
2021-11-19 14:47:12.366462: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8202
Running... {'run_id': 'EfficientNetB4_Notredame_band_aug_gender_base_F50M50', 'model': 'EfficientNetB4', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb4 (Functional)  (None, 6, 7, 1792)       17673823  
                                                                 
 global_average_pooling2d (G  (None, 1792)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 1024)              1836032   
                                                                 
 batch_normalization (BatchN  (None, 1024)             4096      
 ormalization)                                                   
                                                                 
 dropout (Dropout)           (None, 1024)              0         
                                                                 
 activation (Activation)     (None, 1024)              0         
                                                                 
 dense_1 (Dense)             (None, 2)                 2050      
                                                                 
=================================================================
Total params: 19,516,001
Trainable params: 1,840,130
Non-trainable params: 17,675,871
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 277s - loss: 1.5785 - accuracy: 0.5261 - val_loss: 0.7717 - val_accuracy: 0.5406 - 277s/epoch - 9s/step
Epoch 2/1000
31/31 - 26s - loss: 0.9297 - accuracy: 0.4444 - val_loss: 0.9003 - val_accuracy: 0.5003 - 26s/epoch - 826ms/step
Epoch 3/1000
31/31 - 26s - loss: 1.0856 - accuracy: 0.3436 - val_loss: 0.8910 - val_accuracy: 0.5067 - 26s/epoch - 826ms/step
Epoch 4/1000
31/31 - 26s - loss: 1.0092 - accuracy: 0.3694 - val_loss: 0.9190 - val_accuracy: 0.5070 - 26s/epoch - 828ms/step
Epoch 5/1000
31/31 - 25s - loss: 0.9959 - accuracy: 0.3665 - val_loss: 0.9874 - val_accuracy: 0.5159 - 25s/epoch - 805ms/step
Epoch 6/1000
31/31 - 27s - loss: 0.9798 - accuracy: 0.3760 - val_loss: 0.8723 - val_accuracy: 0.5067 - 27s/epoch - 858ms/step
Epoch 7/1000
31/31 - 25s - loss: 0.9581 - accuracy: 0.3786 - val_loss: 0.8905 - val_accuracy: 0.5254 - 25s/epoch - 799ms/step
Epoch 8/1000
31/31 - 25s - loss: 0.9501 - accuracy: 0.3905 - val_loss: 0.9671 - val_accuracy: 0.5070 - 25s/epoch - 804ms/step
Epoch 9/1000
31/31 - 26s - loss: 0.9291 - accuracy: 0.3978 - val_loss: 0.9326 - val_accuracy: 0.5102 - 26s/epoch - 833ms/step
Epoch 10/1000
31/31 - 25s - loss: 0.9177 - accuracy: 0.4020 - val_loss: 0.9127 - val_accuracy: 0.5171 - 25s/epoch - 811ms/step
Epoch 11/1000
31/31 - 24s - loss: 0.9037 - accuracy: 0.4121 - val_loss: 0.9038 - val_accuracy: 0.5298 - 24s/epoch - 772ms/step
Epoch 12/1000
31/31 - 26s - loss: 0.8941 - accuracy: 0.4218 - val_loss: 0.8854 - val_accuracy: 0.5213 - 26s/epoch - 850ms/step
Epoch 13/1000
31/31 - 27s - loss: 0.8760 - accuracy: 0.4341 - val_loss: 0.7685 - val_accuracy: 0.5502 - 27s/epoch - 886ms/step
Epoch 14/1000
31/31 - 26s - loss: 0.8664 - accuracy: 0.4382 - val_loss: 0.8118 - val_accuracy: 0.5346 - 26s/epoch - 828ms/step
Epoch 15/1000
31/31 - 26s - loss: 0.8546 - accuracy: 0.4517 - val_loss: 0.8180 - val_accuracy: 0.5279 - 26s/epoch - 849ms/step
Epoch 16/1000
31/31 - 24s - loss: 0.8536 - accuracy: 0.4498 - val_loss: 0.9400 - val_accuracy: 0.5156 - 24s/epoch - 778ms/step
Epoch 17/1000
31/31 - 27s - loss: 0.8403 - accuracy: 0.4642 - val_loss: 0.7586 - val_accuracy: 0.5502 - 27s/epoch - 876ms/step
Epoch 18/1000
31/31 - 27s - loss: 0.8357 - accuracy: 0.4661 - val_loss: 0.7807 - val_accuracy: 0.5505 - 27s/epoch - 858ms/step
Epoch 19/1000
31/31 - 26s - loss: 0.8198 - accuracy: 0.4759 - val_loss: 0.7424 - val_accuracy: 0.5511 - 26s/epoch - 838ms/step
Epoch 20/1000
31/31 - 25s - loss: 0.8074 - accuracy: 0.4873 - val_loss: 0.7681 - val_accuracy: 0.5527 - 25s/epoch - 801ms/step
Epoch 21/1000
31/31 - 25s - loss: 0.7969 - accuracy: 0.4987 - val_loss: 0.8464 - val_accuracy: 0.5349 - 25s/epoch - 814ms/step
Epoch 22/1000
31/31 - 25s - loss: 0.7922 - accuracy: 0.5060 - val_loss: 0.9084 - val_accuracy: 0.5381 - 25s/epoch - 817ms/step
Epoch 23/1000
31/31 - 25s - loss: 0.7822 - accuracy: 0.5138 - val_loss: 0.9815 - val_accuracy: 0.5279 - 25s/epoch - 815ms/step
Epoch 24/1000
31/31 - 26s - loss: 0.7792 - accuracy: 0.5206 - val_loss: 0.8985 - val_accuracy: 0.5349 - 26s/epoch - 841ms/step
Epoch 25/1000
31/31 - 26s - loss: 0.7655 - accuracy: 0.5276 - val_loss: 0.9252 - val_accuracy: 0.5295 - 26s/epoch - 841ms/step
Epoch 26/1000
31/31 - 26s - loss: 0.7702 - accuracy: 0.5252 - val_loss: 0.8471 - val_accuracy: 0.5413 - 26s/epoch - 841ms/step
Epoch 27/1000
31/31 - 24s - loss: 0.7506 - accuracy: 0.5397 - val_loss: 0.8506 - val_accuracy: 0.5470 - 24s/epoch - 769ms/step
Epoch 28/1000
31/31 - 26s - loss: 0.7491 - accuracy: 0.5473 - val_loss: 0.8628 - val_accuracy: 0.5419 - 26s/epoch - 830ms/step
Epoch 29/1000
31/31 - 26s - loss: 0.7462 - accuracy: 0.5511 - val_loss: 0.9116 - val_accuracy: 0.5251 - 26s/epoch - 847ms/step
Epoch 30/1000
31/31 - 25s - loss: 0.7339 - accuracy: 0.5588 - val_loss: 0.9944 - val_accuracy: 0.5254 - 25s/epoch - 811ms/step
Epoch 31/1000
31/31 - 25s - loss: 0.7209 - accuracy: 0.5702 - val_loss: 0.9467 - val_accuracy: 0.5444 - 25s/epoch - 818ms/step
Epoch 32/1000
31/31 - 25s - loss: 0.7167 - accuracy: 0.5766 - val_loss: 1.0625 - val_accuracy: 0.5216 - 25s/epoch - 808ms/step
Epoch 33/1000
31/31 - 25s - loss: 0.7141 - accuracy: 0.5791 - val_loss: 0.9399 - val_accuracy: 0.5314 - 25s/epoch - 809ms/step
Epoch 34/1000
31/31 - 25s - loss: 0.7064 - accuracy: 0.5854 - val_loss: 1.0028 - val_accuracy: 0.5295 - 25s/epoch - 808ms/step
Epoch 35/1000
31/31 - 26s - loss: 0.6975 - accuracy: 0.5911 - val_loss: 0.8862 - val_accuracy: 0.5425 - 26s/epoch - 826ms/step
Epoch 36/1000
31/31 - 25s - loss: 0.6978 - accuracy: 0.5923 - val_loss: 1.0033 - val_accuracy: 0.5381 - 25s/epoch - 817ms/step
Epoch 37/1000
31/31 - 26s - loss: 0.6954 - accuracy: 0.5946 - val_loss: 0.9154 - val_accuracy: 0.5451 - 26s/epoch - 847ms/step
Epoch 38/1000
31/31 - 26s - loss: 0.6858 - accuracy: 0.6030 - val_loss: 1.0097 - val_accuracy: 0.5279 - 26s/epoch - 825ms/step
Epoch 39/1000
31/31 - 26s - loss: 0.6763 - accuracy: 0.6130 - val_loss: 0.9301 - val_accuracy: 0.5378 - 26s/epoch - 845ms/step
Epoch 40/1000
31/31 - 25s - loss: 0.6825 - accuracy: 0.6096 - val_loss: 0.9390 - val_accuracy: 0.5352 - 25s/epoch - 808ms/step
2021-11-19 15:08:16.862068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 15:08:16.862124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 15:16:36.530839: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 932 of 1024
2021-11-19 15:16:37.445777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'DenseNet121_Notredame_band_aug_gender_base_F50M50', 'model': 'DenseNet121', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 densenet121 (Functional)    (None, 5, 7, 1024)        7037504   
                                                                 
 global_average_pooling2d_1   (None, 1024)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_2 (Dense)             (None, 1024)              1049600   
                                                                 
 batch_normalization_1 (Batc  (None, 1024)             4096      
 hNormalization)                                                 
                                                                 
 dropout_1 (Dropout)         (None, 1024)              0         
                                                                 
 activation_1 (Activation)   (None, 1024)              0         
                                                                 
 dense_3 (Dense)             (None, 2)                 2050      
                                                                 
=================================================================
Total params: 8,093,250
Trainable params: 1,053,698
Non-trainable params: 7,039,552
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 376s - loss: 1.5040 - accuracy: 0.5085 - val_loss: 0.7135 - val_accuracy: 0.5537 - 376s/epoch - 12s/step
Epoch 2/1000
31/31 - 18s - loss: 0.8603 - accuracy: 0.4561 - val_loss: 0.7717 - val_accuracy: 0.5117 - 18s/epoch - 571ms/step
Epoch 3/1000
31/31 - 17s - loss: 1.0251 - accuracy: 0.3237 - val_loss: 0.7169 - val_accuracy: 0.5302 - 17s/epoch - 561ms/step
Epoch 4/1000
31/31 - 18s - loss: 0.9416 - accuracy: 0.3733 - val_loss: 0.6892 - val_accuracy: 0.5508 - 18s/epoch - 596ms/step
Epoch 5/1000
31/31 - 18s - loss: 0.9341 - accuracy: 0.3784 - val_loss: 0.7218 - val_accuracy: 0.5267 - 18s/epoch - 565ms/step
Epoch 6/1000
31/31 - 18s - loss: 0.9140 - accuracy: 0.3899 - val_loss: 0.7359 - val_accuracy: 0.5206 - 18s/epoch - 572ms/step
Epoch 7/1000
31/31 - 19s - loss: 0.8950 - accuracy: 0.4023 - val_loss: 0.6497 - val_accuracy: 0.6105 - 19s/epoch - 605ms/step
Epoch 8/1000
31/31 - 17s - loss: 0.8807 - accuracy: 0.4118 - val_loss: 0.6903 - val_accuracy: 0.5629 - 17s/epoch - 554ms/step
Epoch 9/1000
31/31 - 17s - loss: 0.8693 - accuracy: 0.4223 - val_loss: 0.6989 - val_accuracy: 0.5533 - 17s/epoch - 564ms/step
Epoch 10/1000
31/31 - 17s - loss: 0.8612 - accuracy: 0.4280 - val_loss: 0.7211 - val_accuracy: 0.5429 - 17s/epoch - 555ms/step
Epoch 11/1000
31/31 - 17s - loss: 0.8447 - accuracy: 0.4418 - val_loss: 0.6724 - val_accuracy: 0.5806 - 17s/epoch - 552ms/step
Epoch 12/1000
31/31 - 17s - loss: 0.8352 - accuracy: 0.4496 - val_loss: 0.6939 - val_accuracy: 0.5508 - 17s/epoch - 551ms/step
Epoch 13/1000
31/31 - 17s - loss: 0.8262 - accuracy: 0.4544 - val_loss: 0.7177 - val_accuracy: 0.5381 - 17s/epoch - 564ms/step
Epoch 14/1000
31/31 - 18s - loss: 0.8152 - accuracy: 0.4672 - val_loss: 0.6145 - val_accuracy: 0.6714 - 18s/epoch - 596ms/step
Epoch 15/1000
31/31 - 18s - loss: 0.8061 - accuracy: 0.4725 - val_loss: 0.6804 - val_accuracy: 0.5756 - 18s/epoch - 566ms/step
Epoch 16/1000
31/31 - 17s - loss: 0.7987 - accuracy: 0.4827 - val_loss: 0.6431 - val_accuracy: 0.6397 - 17s/epoch - 564ms/step
Epoch 17/1000
31/31 - 17s - loss: 0.7855 - accuracy: 0.4891 - val_loss: 0.6783 - val_accuracy: 0.5730 - 17s/epoch - 534ms/step
Epoch 18/1000
31/31 - 17s - loss: 0.7767 - accuracy: 0.4980 - val_loss: 0.6896 - val_accuracy: 0.5625 - 17s/epoch - 560ms/step
Epoch 19/1000
31/31 - 17s - loss: 0.7663 - accuracy: 0.5078 - val_loss: 0.7544 - val_accuracy: 0.5238 - 17s/epoch - 554ms/step
Epoch 20/1000
31/31 - 17s - loss: 0.7610 - accuracy: 0.5175 - val_loss: 0.7159 - val_accuracy: 0.5400 - 17s/epoch - 542ms/step
Epoch 21/1000
31/31 - 17s - loss: 0.7506 - accuracy: 0.5252 - val_loss: 0.6593 - val_accuracy: 0.6073 - 17s/epoch - 560ms/step
Epoch 22/1000
31/31 - 17s - loss: 0.7432 - accuracy: 0.5339 - val_loss: 0.6379 - val_accuracy: 0.6324 - 17s/epoch - 536ms/step
Epoch 23/1000
31/31 - 17s - loss: 0.7363 - accuracy: 0.5397 - val_loss: 0.6529 - val_accuracy: 0.6038 - 17s/epoch - 554ms/step
Epoch 24/1000
31/31 - 17s - loss: 0.7299 - accuracy: 0.5449 - val_loss: 0.6146 - val_accuracy: 0.6559 - 17s/epoch - 557ms/step
Epoch 25/1000
31/31 - 18s - loss: 0.7210 - accuracy: 0.5559 - val_loss: 0.6134 - val_accuracy: 0.6498 - 18s/epoch - 586ms/step
Epoch 26/1000
31/31 - 17s - loss: 0.7175 - accuracy: 0.5562 - val_loss: 0.6531 - val_accuracy: 0.6083 - 17s/epoch - 558ms/step
Epoch 27/1000
31/31 - 18s - loss: 0.7063 - accuracy: 0.5701 - val_loss: 0.5904 - val_accuracy: 0.7159 - 18s/epoch - 577ms/step
Epoch 28/1000
31/31 - 17s - loss: 0.7036 - accuracy: 0.5739 - val_loss: 0.6235 - val_accuracy: 0.6546 - 17s/epoch - 559ms/step
Epoch 29/1000
31/31 - 17s - loss: 0.6951 - accuracy: 0.5775 - val_loss: 0.6407 - val_accuracy: 0.6257 - 17s/epoch - 557ms/step
Epoch 30/1000
31/31 - 17s - loss: 0.6873 - accuracy: 0.5866 - val_loss: 0.6265 - val_accuracy: 0.6375 - 17s/epoch - 548ms/step
Epoch 31/1000
31/31 - 17s - loss: 0.6784 - accuracy: 0.5959 - val_loss: 0.6688 - val_accuracy: 0.5711 - 17s/epoch - 559ms/step
Epoch 32/1000
31/31 - 17s - loss: 0.6739 - accuracy: 0.6020 - val_loss: 0.6021 - val_accuracy: 0.6594 - 17s/epoch - 557ms/step
Epoch 33/1000
31/31 - 17s - loss: 0.6635 - accuracy: 0.6100 - val_loss: 0.6017 - val_accuracy: 0.6775 - 17s/epoch - 545ms/step
Epoch 34/1000
31/31 - 17s - loss: 0.6619 - accuracy: 0.6116 - val_loss: 0.6738 - val_accuracy: 0.5806 - 17s/epoch - 547ms/step
Epoch 35/1000
31/31 - 17s - loss: 0.6541 - accuracy: 0.6210 - val_loss: 0.6404 - val_accuracy: 0.6263 - 17s/epoch - 556ms/step
Epoch 36/1000
31/31 - 17s - loss: 0.6481 - accuracy: 0.6284 - val_loss: 0.6457 - val_accuracy: 0.6130 - 17s/epoch - 550ms/step
Epoch 37/1000
31/31 - 17s - loss: 0.6483 - accuracy: 0.6273 - val_loss: 0.5996 - val_accuracy: 0.6898 - 17s/epoch - 555ms/step
Epoch 38/1000
31/31 - 17s - loss: 0.6378 - accuracy: 0.6397 - val_loss: 0.5952 - val_accuracy: 0.6854 - 17s/epoch - 550ms/step
Epoch 39/1000
31/31 - 18s - loss: 0.6286 - accuracy: 0.6472 - val_loss: 0.5787 - val_accuracy: 0.7210 - 18s/epoch - 594ms/step
Epoch 40/1000
31/31 - 17s - loss: 0.6247 - accuracy: 0.6507 - val_loss: 0.5962 - val_accuracy: 0.6924 - 17s/epoch - 541ms/step
Epoch 41/1000
31/31 - 18s - loss: 0.6194 - accuracy: 0.6573 - val_loss: 0.5672 - val_accuracy: 0.7311 - 18s/epoch - 581ms/step
Epoch 42/1000
31/31 - 17s - loss: 0.6105 - accuracy: 0.6671 - val_loss: 0.5986 - val_accuracy: 0.6848 - 17s/epoch - 559ms/step
Epoch 43/1000
31/31 - 17s - loss: 0.6100 - accuracy: 0.6662 - val_loss: 0.6099 - val_accuracy: 0.6410 - 17s/epoch - 560ms/step
Epoch 44/1000
31/31 - 17s - loss: 0.5970 - accuracy: 0.6806 - val_loss: 0.6285 - val_accuracy: 0.6302 - 17s/epoch - 538ms/step
Epoch 45/1000
31/31 - 17s - loss: 0.5923 - accuracy: 0.6855 - val_loss: 0.5903 - val_accuracy: 0.7095 - 17s/epoch - 542ms/step
Epoch 46/1000
31/31 - 17s - loss: 0.5883 - accuracy: 0.6847 - val_loss: 0.5803 - val_accuracy: 0.7114 - 17s/epoch - 553ms/step
Epoch 47/1000
31/31 - 17s - loss: 0.5860 - accuracy: 0.6917 - val_loss: 0.6292 - val_accuracy: 0.6375 - 17s/epoch - 555ms/step
Epoch 48/1000
31/31 - 17s - loss: 0.5782 - accuracy: 0.6958 - val_loss: 0.6427 - val_accuracy: 0.6143 - 17s/epoch - 546ms/step
Epoch 49/1000
31/31 - 17s - loss: 0.5761 - accuracy: 0.6944 - val_loss: 0.6582 - val_accuracy: 0.6086 - 17s/epoch - 549ms/step
Epoch 50/1000
31/31 - 17s - loss: 0.5712 - accuracy: 0.7060 - val_loss: 0.6159 - val_accuracy: 0.6540 - 17s/epoch - 554ms/step
Epoch 51/1000
31/31 - 18s - loss: 0.5624 - accuracy: 0.7083 - val_loss: 0.5514 - val_accuracy: 0.7381 - 18s/epoch - 581ms/step
Epoch 52/1000
31/31 - 18s - loss: 0.5571 - accuracy: 0.7201 - val_loss: 0.5855 - val_accuracy: 0.6914 - 18s/epoch - 569ms/step
Epoch 53/1000
31/31 - 17s - loss: 0.5517 - accuracy: 0.7239 - val_loss: 0.5842 - val_accuracy: 0.7060 - 17s/epoch - 547ms/step
Epoch 54/1000
31/31 - 17s - loss: 0.5454 - accuracy: 0.7276 - val_loss: 0.6073 - val_accuracy: 0.6749 - 17s/epoch - 539ms/step
Epoch 55/1000
31/31 - 16s - loss: 0.5417 - accuracy: 0.7336 - val_loss: 0.6306 - val_accuracy: 0.6378 - 16s/epoch - 532ms/step
Epoch 56/1000
31/31 - 17s - loss: 0.5330 - accuracy: 0.7364 - val_loss: 0.5642 - val_accuracy: 0.7251 - 17s/epoch - 546ms/step
Epoch 57/1000
31/31 - 17s - loss: 0.5320 - accuracy: 0.7402 - val_loss: 0.6331 - val_accuracy: 0.6343 - 17s/epoch - 546ms/step
Epoch 58/1000
31/31 - 17s - loss: 0.5235 - accuracy: 0.7460 - val_loss: 0.6021 - val_accuracy: 0.6838 - 17s/epoch - 548ms/step
Epoch 59/1000
31/31 - 17s - loss: 0.5196 - accuracy: 0.7500 - val_loss: 0.6560 - val_accuracy: 0.6232 - 17s/epoch - 557ms/step
Epoch 60/1000
31/31 - 17s - loss: 0.5126 - accuracy: 0.7564 - val_loss: 0.6334 - val_accuracy: 0.6330 - 17s/epoch - 542ms/step
Epoch 61/1000
31/31 - 17s - loss: 0.5135 - accuracy: 0.7568 - val_loss: 0.5863 - val_accuracy: 0.6962 - 17s/epoch - 550ms/step
Epoch 62/1000
31/31 - 17s - loss: 0.5043 - accuracy: 0.7654 - val_loss: 0.6314 - val_accuracy: 0.6381 - 17s/epoch - 552ms/step
Epoch 63/1000
31/31 - 17s - loss: 0.4995 - accuracy: 0.7699 - val_loss: 0.5584 - val_accuracy: 0.7263 - 17s/epoch - 544ms/step
Epoch 64/1000
31/31 - 17s - loss: 0.4975 - accuracy: 0.7724 - val_loss: 0.6460 - val_accuracy: 0.6286 - 17s/epoch - 548ms/step
Epoch 65/1000
31/31 - 17s - loss: 0.4911 - accuracy: 0.7758 - val_loss: 0.5711 - val_accuracy: 0.7054 - 17s/epoch - 543ms/step
Epoch 66/1000
31/31 - 18s - loss: 0.4877 - accuracy: 0.7801 - val_loss: 0.5999 - val_accuracy: 0.6756 - 18s/epoch - 566ms/step
Epoch 67/1000
31/31 - 17s - loss: 0.4824 - accuracy: 0.7804 - val_loss: 0.6056 - val_accuracy: 0.6730 - 17s/epoch - 557ms/step
Epoch 68/1000
31/31 - 18s - loss: 0.4774 - accuracy: 0.7866 - val_loss: 0.5464 - val_accuracy: 0.7308 - 18s/epoch - 586ms/step
Epoch 69/1000
31/31 - 17s - loss: 0.4753 - accuracy: 0.7896 - val_loss: 0.5915 - val_accuracy: 0.6829 - 17s/epoch - 558ms/step
Epoch 70/1000
31/31 - 17s - loss: 0.4688 - accuracy: 0.7941 - val_loss: 0.5814 - val_accuracy: 0.6902 - 17s/epoch - 544ms/step
Epoch 71/1000
31/31 - 17s - loss: 0.4643 - accuracy: 0.7996 - val_loss: 0.5692 - val_accuracy: 0.7019 - 17s/epoch - 553ms/step
2021-11-19 15:37:54.079286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 15:37:54.079339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
F:\Lab\env\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [96, 128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
2021-11-19 15:46:39.202392: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 1013 of 1024
2021-11-19 15:46:39.298146: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'MobileNetV2_Notredame_band_aug_gender_base_F50M50', 'model': 'MobileNetV2', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 mobilenetv2_1.00_224 (Funct  (None, 6, 7, 1280)       2257984   
 ional)                                                          
                                                                 
 global_average_pooling2d_2   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_4 (Dense)             (None, 1024)              1311744   
                                                                 
 batch_normalization_2 (Batc  (None, 1024)             4096      
 hNormalization)                                                 
                                                                 
 dropout_2 (Dropout)         (None, 1024)              0         
                                                                 
 activation_2 (Activation)   (None, 1024)              0         
                                                                 
 dense_5 (Dense)             (None, 2)                 2050      
                                                                 
=================================================================
Total params: 3,575,874
Trainable params: 1,315,842
Non-trainable params: 2,260,032
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 383s - loss: 1.3549 - accuracy: 0.4452 - val_loss: 0.6184 - val_accuracy: 0.6571 - 383s/epoch - 12s/step
Epoch 2/1000
31/31 - 9s - loss: 0.8919 - accuracy: 0.4263 - val_loss: 0.7933 - val_accuracy: 0.5121 - 9s/epoch - 292ms/step
Epoch 3/1000
31/31 - 9s - loss: 0.9864 - accuracy: 0.3520 - val_loss: 0.7400 - val_accuracy: 0.5178 - 9s/epoch - 290ms/step
Epoch 4/1000
31/31 - 9s - loss: 0.9131 - accuracy: 0.3953 - val_loss: 0.6739 - val_accuracy: 0.5660 - 9s/epoch - 298ms/step
Epoch 5/1000
31/31 - 9s - loss: 0.8973 - accuracy: 0.4081 - val_loss: 0.6958 - val_accuracy: 0.5552 - 9s/epoch - 281ms/step
Epoch 6/1000
31/31 - 9s - loss: 0.8740 - accuracy: 0.4232 - val_loss: 0.6776 - val_accuracy: 0.5781 - 9s/epoch - 285ms/step
Epoch 7/1000
31/31 - 9s - loss: 0.8591 - accuracy: 0.4348 - val_loss: 0.6446 - val_accuracy: 0.6159 - 9s/epoch - 286ms/step
Epoch 8/1000
31/31 - 9s - loss: 0.8403 - accuracy: 0.4478 - val_loss: 0.6549 - val_accuracy: 0.5892 - 9s/epoch - 285ms/step
Epoch 9/1000
31/31 - 9s - loss: 0.8222 - accuracy: 0.4644 - val_loss: 0.6648 - val_accuracy: 0.5917 - 9s/epoch - 299ms/step
Epoch 10/1000
31/31 - 9s - loss: 0.8063 - accuracy: 0.4806 - val_loss: 0.6605 - val_accuracy: 0.5832 - 9s/epoch - 284ms/step
Epoch 11/1000
31/31 - 9s - loss: 0.7885 - accuracy: 0.4902 - val_loss: 0.6291 - val_accuracy: 0.6403 - 9s/epoch - 293ms/step
Epoch 12/1000
31/31 - 9s - loss: 0.7756 - accuracy: 0.5006 - val_loss: 0.6623 - val_accuracy: 0.5981 - 9s/epoch - 292ms/step
Epoch 13/1000
31/31 - 9s - loss: 0.7623 - accuracy: 0.5157 - val_loss: 0.6834 - val_accuracy: 0.5651 - 9s/epoch - 288ms/step
Epoch 14/1000
31/31 - 9s - loss: 0.7506 - accuracy: 0.5242 - val_loss: 0.6485 - val_accuracy: 0.6130 - 9s/epoch - 289ms/step
Epoch 15/1000
31/31 - 10s - loss: 0.7360 - accuracy: 0.5432 - val_loss: 0.5964 - val_accuracy: 0.6933 - 10s/epoch - 314ms/step
Epoch 16/1000
31/31 - 9s - loss: 0.7185 - accuracy: 0.5574 - val_loss: 0.6359 - val_accuracy: 0.6314 - 9s/epoch - 287ms/step
Epoch 17/1000
31/31 - 9s - loss: 0.7106 - accuracy: 0.5634 - val_loss: 0.6337 - val_accuracy: 0.6441 - 9s/epoch - 295ms/step
Epoch 18/1000
31/31 - 9s - loss: 0.7024 - accuracy: 0.5728 - val_loss: 0.6590 - val_accuracy: 0.5898 - 9s/epoch - 293ms/step
Epoch 19/1000
31/31 - 9s - loss: 0.6904 - accuracy: 0.5830 - val_loss: 0.6397 - val_accuracy: 0.6073 - 9s/epoch - 289ms/step
Epoch 20/1000
31/31 - 9s - loss: 0.6794 - accuracy: 0.5959 - val_loss: 0.6698 - val_accuracy: 0.5743 - 9s/epoch - 301ms/step
Epoch 21/1000
31/31 - 9s - loss: 0.6655 - accuracy: 0.6075 - val_loss: 0.6200 - val_accuracy: 0.6425 - 9s/epoch - 293ms/step
Epoch 22/1000
31/31 - 9s - loss: 0.6519 - accuracy: 0.6243 - val_loss: 0.5985 - val_accuracy: 0.6768 - 9s/epoch - 289ms/step
Epoch 23/1000
31/31 - 9s - loss: 0.6449 - accuracy: 0.6286 - val_loss: 0.6530 - val_accuracy: 0.6086 - 9s/epoch - 296ms/step
Epoch 24/1000
31/31 - 9s - loss: 0.6362 - accuracy: 0.6390 - val_loss: 0.6401 - val_accuracy: 0.6194 - 9s/epoch - 296ms/step
Epoch 25/1000
31/31 - 9s - loss: 0.6225 - accuracy: 0.6547 - val_loss: 0.6563 - val_accuracy: 0.5841 - 9s/epoch - 292ms/step
Epoch 26/1000
31/31 - 9s - loss: 0.6158 - accuracy: 0.6590 - val_loss: 0.6854 - val_accuracy: 0.5730 - 9s/epoch - 292ms/step
Epoch 27/1000
31/31 - 9s - loss: 0.6116 - accuracy: 0.6649 - val_loss: 0.6357 - val_accuracy: 0.6248 - 9s/epoch - 295ms/step
Epoch 28/1000
31/31 - 9s - loss: 0.5979 - accuracy: 0.6784 - val_loss: 0.7370 - val_accuracy: 0.5444 - 9s/epoch - 293ms/step
Epoch 29/1000
31/31 - 9s - loss: 0.5915 - accuracy: 0.6808 - val_loss: 0.6036 - val_accuracy: 0.6654 - 9s/epoch - 297ms/step
Epoch 30/1000
31/31 - 9s - loss: 0.5812 - accuracy: 0.6928 - val_loss: 0.5979 - val_accuracy: 0.6749 - 9s/epoch - 293ms/step
Epoch 31/1000
31/31 - 9s - loss: 0.5724 - accuracy: 0.7060 - val_loss: 0.6231 - val_accuracy: 0.6410 - 9s/epoch - 295ms/step
Epoch 32/1000
31/31 - 9s - loss: 0.5631 - accuracy: 0.7142 - val_loss: 0.6054 - val_accuracy: 0.6717 - 9s/epoch - 296ms/step
Epoch 33/1000
31/31 - 9s - loss: 0.5525 - accuracy: 0.7179 - val_loss: 0.6335 - val_accuracy: 0.6244 - 9s/epoch - 296ms/step
Epoch 34/1000
31/31 - 9s - loss: 0.5454 - accuracy: 0.7284 - val_loss: 0.6076 - val_accuracy: 0.6708 - 9s/epoch - 296ms/step
Epoch 35/1000
31/31 - 9s - loss: 0.5403 - accuracy: 0.7349 - val_loss: 0.6361 - val_accuracy: 0.6203 - 9s/epoch - 298ms/step
2021-11-19 15:52:28.733813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 15:52:28.733942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
Running... {'run_id': 'InceptionV3_Notredame_band_aug_gender_base_F50M50', 'model': 'InceptionV3', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inception_v3 (Functional)   (None, 3, 5, 2048)        21802784  
                                                                 
 global_average_pooling2d_3   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_6 (Dense)             (None, 1024)              2098176   
                                                                 
 batch_normalization_97 (Bat  (None, 1024)             4096      
 chNormalization)                                                
                                                                 
 dropout_3 (Dropout)         (None, 1024)              0         
                                                                 
 activation_97 (Activation)  (None, 1024)              0         
                                                                 
 dense_7 (Dense)             (None, 2)                 2050      
                                                                 
=================================================================
Total params: 23,907,106
Trainable params: 2,102,274
Non-trainable params: 21,804,832
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 406s - loss: 1.4777 - accuracy: 0.4991 - val_loss: 1.4299 - val_accuracy: 0.5048 - 406s/epoch - 13s/step
Epoch 2/1000
31/31 - 12s - loss: 0.8856 - accuracy: 0.4520 - val_loss: 1.3400 - val_accuracy: 0.5006 - 12s/epoch - 391ms/step
Epoch 3/1000
31/31 - 12s - loss: 0.9991 - accuracy: 0.3588 - val_loss: 1.2016 - val_accuracy: 0.5016 - 12s/epoch - 394ms/step
Epoch 4/1000
31/31 - 12s - loss: 0.9152 - accuracy: 0.4028 - val_loss: 1.0335 - val_accuracy: 0.5019 - 12s/epoch - 391ms/step
Epoch 5/1000
31/31 - 11s - loss: 0.8912 - accuracy: 0.4142 - val_loss: 1.1936 - val_accuracy: 0.5000 - 11s/epoch - 351ms/step
Epoch 6/1000
31/31 - 12s - loss: 0.8607 - accuracy: 0.4356 - val_loss: 1.1107 - val_accuracy: 0.5022 - 12s/epoch - 376ms/step
Epoch 7/1000
31/31 - 12s - loss: 0.8320 - accuracy: 0.4606 - val_loss: 0.9695 - val_accuracy: 0.5098 - 12s/epoch - 393ms/step
Epoch 8/1000
31/31 - 11s - loss: 0.8150 - accuracy: 0.4749 - val_loss: 1.0545 - val_accuracy: 0.5067 - 11s/epoch - 347ms/step
Epoch 9/1000
31/31 - 12s - loss: 0.7949 - accuracy: 0.4933 - val_loss: 0.8659 - val_accuracy: 0.5213 - 12s/epoch - 379ms/step
Epoch 10/1000
31/31 - 10s - loss: 0.7765 - accuracy: 0.5062 - val_loss: 0.9546 - val_accuracy: 0.5111 - 10s/epoch - 338ms/step
Epoch 11/1000
31/31 - 12s - loss: 0.7627 - accuracy: 0.5218 - val_loss: 0.7795 - val_accuracy: 0.5495 - 12s/epoch - 386ms/step
Epoch 12/1000
31/31 - 11s - loss: 0.7452 - accuracy: 0.5366 - val_loss: 0.9302 - val_accuracy: 0.5130 - 11s/epoch - 350ms/step
Epoch 13/1000
31/31 - 11s - loss: 0.7210 - accuracy: 0.5602 - val_loss: 0.8874 - val_accuracy: 0.5108 - 11s/epoch - 352ms/step
Epoch 14/1000
31/31 - 11s - loss: 0.7062 - accuracy: 0.5769 - val_loss: 0.7986 - val_accuracy: 0.5308 - 11s/epoch - 350ms/step
Epoch 15/1000
31/31 - 11s - loss: 0.6931 - accuracy: 0.5889 - val_loss: 0.9002 - val_accuracy: 0.5105 - 11s/epoch - 341ms/step
Epoch 16/1000
31/31 - 11s - loss: 0.6807 - accuracy: 0.5978 - val_loss: 0.8427 - val_accuracy: 0.5314 - 11s/epoch - 350ms/step
Epoch 17/1000
31/31 - 11s - loss: 0.6661 - accuracy: 0.6156 - val_loss: 0.9100 - val_accuracy: 0.5146 - 11s/epoch - 363ms/step
Epoch 18/1000
31/31 - 11s - loss: 0.6522 - accuracy: 0.6244 - val_loss: 0.8381 - val_accuracy: 0.5156 - 11s/epoch - 364ms/step
Epoch 19/1000
31/31 - 11s - loss: 0.6398 - accuracy: 0.6405 - val_loss: 0.9506 - val_accuracy: 0.5149 - 11s/epoch - 353ms/step
Epoch 20/1000
31/31 - 11s - loss: 0.6247 - accuracy: 0.6529 - val_loss: 0.8773 - val_accuracy: 0.5210 - 11s/epoch - 360ms/step
Epoch 21/1000
31/31 - 11s - loss: 0.6170 - accuracy: 0.6637 - val_loss: 0.7905 - val_accuracy: 0.5146 - 11s/epoch - 363ms/step
Epoch 22/1000
31/31 - 11s - loss: 0.6020 - accuracy: 0.6761 - val_loss: 0.8654 - val_accuracy: 0.5305 - 11s/epoch - 350ms/step
Epoch 23/1000
31/31 - 11s - loss: 0.5953 - accuracy: 0.6800 - val_loss: 0.8878 - val_accuracy: 0.5067 - 11s/epoch - 356ms/step
Epoch 24/1000
31/31 - 11s - loss: 0.5814 - accuracy: 0.6999 - val_loss: 0.8706 - val_accuracy: 0.5114 - 11s/epoch - 358ms/step
Epoch 25/1000
31/31 - 11s - loss: 0.5681 - accuracy: 0.7106 - val_loss: 0.9656 - val_accuracy: 0.5095 - 11s/epoch - 363ms/step
Epoch 26/1000
31/31 - 11s - loss: 0.5598 - accuracy: 0.7204 - val_loss: 0.9461 - val_accuracy: 0.5175 - 11s/epoch - 366ms/step
Epoch 27/1000
31/31 - 11s - loss: 0.5492 - accuracy: 0.7258 - val_loss: 0.8726 - val_accuracy: 0.5149 - 11s/epoch - 362ms/step
Epoch 28/1000
31/31 - 11s - loss: 0.5417 - accuracy: 0.7407 - val_loss: 0.8854 - val_accuracy: 0.4943 - 11s/epoch - 364ms/step
Epoch 29/1000
31/31 - 11s - loss: 0.5276 - accuracy: 0.7493 - val_loss: 0.9625 - val_accuracy: 0.5152 - 11s/epoch - 363ms/step
Epoch 30/1000
31/31 - 11s - loss: 0.5215 - accuracy: 0.7553 - val_loss: 1.0012 - val_accuracy: 0.5219 - 11s/epoch - 363ms/step
Epoch 31/1000
31/31 - 11s - loss: 0.5089 - accuracy: 0.7675 - val_loss: 0.8425 - val_accuracy: 0.5260 - 11s/epoch - 362ms/step
2021-11-19 16:08:28.999252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 16:08:28.999364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
Running... {'run_id': 'InceptionResNetV2_Notredame_band_aug_gender_base_F50M50', 'model': 'InceptionResNetV2', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inception_resnet_v2 (Functi  (None, 3, 5, 1536)       54336736  
 onal)                                                           
                                                                 
 global_average_pooling2d_4   (None, 1536)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_8 (Dense)             (None, 1024)              1573888   
                                                                 
 batch_normalization_301 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_4 (Dropout)         (None, 1024)              0         
                                                                 
 activation_301 (Activation)  (None, 1024)             0         
                                                                 
 dense_9 (Dense)             (None, 2)                 2050      
                                                                 
=================================================================
Total params: 55,916,770
Trainable params: 1,577,986
Non-trainable params: 54,338,784
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 440s - loss: 1.3690 - accuracy: 0.4754 - val_loss: 1.2900 - val_accuracy: 0.5000 - 440s/epoch - 14s/step
Epoch 2/1000
31/31 - 20s - loss: 0.9886 - accuracy: 0.3983 - val_loss: 1.1311 - val_accuracy: 0.5000 - 20s/epoch - 645ms/step
Epoch 3/1000
31/31 - 21s - loss: 1.0284 - accuracy: 0.3547 - val_loss: 0.6688 - val_accuracy: 0.5924 - 21s/epoch - 683ms/step
Epoch 4/1000
31/31 - 18s - loss: 0.9701 - accuracy: 0.3859 - val_loss: 0.7098 - val_accuracy: 0.5562 - 18s/epoch - 575ms/step
Epoch 5/1000
31/31 - 18s - loss: 0.9500 - accuracy: 0.3943 - val_loss: 0.6970 - val_accuracy: 0.5679 - 18s/epoch - 585ms/step
Epoch 6/1000
31/31 - 18s - loss: 0.9380 - accuracy: 0.4032 - val_loss: 0.8256 - val_accuracy: 0.5044 - 18s/epoch - 582ms/step
Epoch 7/1000
31/31 - 18s - loss: 0.9142 - accuracy: 0.4136 - val_loss: 0.6992 - val_accuracy: 0.5524 - 18s/epoch - 582ms/step
Epoch 8/1000
31/31 - 18s - loss: 0.8984 - accuracy: 0.4229 - val_loss: 0.6842 - val_accuracy: 0.5832 - 18s/epoch - 590ms/step
Epoch 9/1000
31/31 - 18s - loss: 0.8880 - accuracy: 0.4313 - val_loss: 0.7277 - val_accuracy: 0.5394 - 18s/epoch - 580ms/step
Epoch 10/1000
31/31 - 18s - loss: 0.8729 - accuracy: 0.4451 - val_loss: 0.7872 - val_accuracy: 0.5279 - 18s/epoch - 567ms/step
Epoch 11/1000
31/31 - 18s - loss: 0.8675 - accuracy: 0.4476 - val_loss: 0.8218 - val_accuracy: 0.5146 - 18s/epoch - 588ms/step
Epoch 12/1000
31/31 - 18s - loss: 0.8400 - accuracy: 0.4675 - val_loss: 0.8203 - val_accuracy: 0.5130 - 18s/epoch - 565ms/step
Epoch 13/1000
31/31 - 17s - loss: 0.8428 - accuracy: 0.4656 - val_loss: 0.7244 - val_accuracy: 0.5578 - 17s/epoch - 559ms/step
Epoch 14/1000
31/31 - 18s - loss: 0.8270 - accuracy: 0.4747 - val_loss: 0.8893 - val_accuracy: 0.5083 - 18s/epoch - 593ms/step
Epoch 15/1000
31/31 - 18s - loss: 0.8210 - accuracy: 0.4867 - val_loss: 0.7320 - val_accuracy: 0.5546 - 18s/epoch - 591ms/step
Epoch 16/1000
31/31 - 17s - loss: 0.8094 - accuracy: 0.4942 - val_loss: 0.7077 - val_accuracy: 0.5683 - 17s/epoch - 555ms/step
Epoch 17/1000
31/31 - 18s - loss: 0.7981 - accuracy: 0.5014 - val_loss: 0.8310 - val_accuracy: 0.5111 - 18s/epoch - 571ms/step
Epoch 18/1000
31/31 - 18s - loss: 0.7909 - accuracy: 0.5048 - val_loss: 0.7861 - val_accuracy: 0.5330 - 18s/epoch - 570ms/step
Epoch 19/1000
31/31 - 18s - loss: 0.7822 - accuracy: 0.5159 - val_loss: 0.7093 - val_accuracy: 0.5721 - 18s/epoch - 568ms/step
Epoch 20/1000
31/31 - 18s - loss: 0.7724 - accuracy: 0.5264 - val_loss: 0.8122 - val_accuracy: 0.5229 - 18s/epoch - 573ms/step
Epoch 21/1000
31/31 - 18s - loss: 0.7691 - accuracy: 0.5256 - val_loss: 0.7647 - val_accuracy: 0.5333 - 18s/epoch - 577ms/step
Epoch 22/1000
31/31 - 18s - loss: 0.7522 - accuracy: 0.5376 - val_loss: 0.7697 - val_accuracy: 0.5581 - 18s/epoch - 595ms/step
Epoch 23/1000
31/31 - 18s - loss: 0.7538 - accuracy: 0.5443 - val_loss: 0.7384 - val_accuracy: 0.5708 - 18s/epoch - 567ms/step
2021-11-19 16:24:12.713995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 16:24:12.714060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 16:35:36.586627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 879 of 1024
2021-11-19 16:35:38.104833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'ResNet50_Notredame_band_aug_gender_base_F50M50', 'model': 'ResNet50', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 6, 7, 2048)        23587712  
                                                                 
 global_average_pooling2d_5   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_10 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_302 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_5 (Dropout)         (None, 1024)              0         
                                                                 
 activation_302 (Activation)  (None, 1024)             0         
                                                                 
 dense_11 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 25,692,034
Trainable params: 2,102,274
Non-trainable params: 23,589,760
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 486s - loss: 1.4057 - accuracy: 0.4737 - val_loss: 0.9731 - val_accuracy: 0.5146 - 486s/epoch - 16s/step
Epoch 2/1000
31/31 - 17s - loss: 0.9433 - accuracy: 0.4157 - val_loss: 0.9141 - val_accuracy: 0.5048 - 17s/epoch - 564ms/step
Epoch 3/1000
31/31 - 16s - loss: 1.0111 - accuracy: 0.3566 - val_loss: 0.9243 - val_accuracy: 0.5003 - 16s/epoch - 521ms/step
Epoch 4/1000
31/31 - 17s - loss: 0.9378 - accuracy: 0.3989 - val_loss: 0.7289 - val_accuracy: 0.5594 - 17s/epoch - 554ms/step
Epoch 5/1000
31/31 - 17s - loss: 0.9221 - accuracy: 0.4073 - val_loss: 0.7775 - val_accuracy: 0.5527 - 17s/epoch - 538ms/step
Epoch 6/1000
31/31 - 17s - loss: 0.8974 - accuracy: 0.4253 - val_loss: 0.8500 - val_accuracy: 0.5238 - 17s/epoch - 540ms/step
Epoch 7/1000
31/31 - 17s - loss: 0.8669 - accuracy: 0.4409 - val_loss: 0.7525 - val_accuracy: 0.5556 - 17s/epoch - 533ms/step
Epoch 8/1000
31/31 - 16s - loss: 0.8513 - accuracy: 0.4589 - val_loss: 0.7728 - val_accuracy: 0.5603 - 16s/epoch - 532ms/step
Epoch 9/1000
31/31 - 16s - loss: 0.8354 - accuracy: 0.4656 - val_loss: 0.7946 - val_accuracy: 0.5511 - 16s/epoch - 532ms/step
Epoch 10/1000
31/31 - 16s - loss: 0.8165 - accuracy: 0.4855 - val_loss: 0.8220 - val_accuracy: 0.5483 - 16s/epoch - 528ms/step
Epoch 11/1000
31/31 - 16s - loss: 0.7994 - accuracy: 0.4948 - val_loss: 0.8425 - val_accuracy: 0.5235 - 16s/epoch - 526ms/step
Epoch 12/1000
31/31 - 17s - loss: 0.7872 - accuracy: 0.5027 - val_loss: 0.9292 - val_accuracy: 0.5162 - 17s/epoch - 542ms/step
Epoch 13/1000
31/31 - 17s - loss: 0.7751 - accuracy: 0.5189 - val_loss: 0.8054 - val_accuracy: 0.5524 - 17s/epoch - 549ms/step
Epoch 14/1000
31/31 - 17s - loss: 0.7562 - accuracy: 0.5363 - val_loss: 0.8877 - val_accuracy: 0.5213 - 17s/epoch - 535ms/step
Epoch 15/1000
31/31 - 17s - loss: 0.7397 - accuracy: 0.5490 - val_loss: 0.8683 - val_accuracy: 0.5308 - 17s/epoch - 547ms/step
Epoch 16/1000
31/31 - 17s - loss: 0.7276 - accuracy: 0.5582 - val_loss: 0.9000 - val_accuracy: 0.5222 - 17s/epoch - 545ms/step
Epoch 17/1000
31/31 - 17s - loss: 0.7222 - accuracy: 0.5641 - val_loss: 0.7874 - val_accuracy: 0.5613 - 17s/epoch - 545ms/step
Epoch 18/1000
31/31 - 16s - loss: 0.7077 - accuracy: 0.5776 - val_loss: 0.9561 - val_accuracy: 0.5210 - 16s/epoch - 530ms/step
Epoch 19/1000
31/31 - 17s - loss: 0.6925 - accuracy: 0.5919 - val_loss: 0.9834 - val_accuracy: 0.5143 - 17s/epoch - 544ms/step
Epoch 20/1000
31/31 - 17s - loss: 0.6788 - accuracy: 0.6033 - val_loss: 0.8759 - val_accuracy: 0.5359 - 17s/epoch - 539ms/step
Epoch 21/1000
31/31 - 17s - loss: 0.6679 - accuracy: 0.6125 - val_loss: 0.9347 - val_accuracy: 0.5327 - 17s/epoch - 544ms/step
Epoch 22/1000
31/31 - 17s - loss: 0.6592 - accuracy: 0.6227 - val_loss: 0.7887 - val_accuracy: 0.5622 - 17s/epoch - 539ms/step
Epoch 23/1000
31/31 - 17s - loss: 0.6546 - accuracy: 0.6263 - val_loss: 0.8744 - val_accuracy: 0.5394 - 17s/epoch - 535ms/step
Epoch 24/1000
31/31 - 17s - loss: 0.6343 - accuracy: 0.6399 - val_loss: 0.9827 - val_accuracy: 0.5235 - 17s/epoch - 558ms/step
Epoch 25/1000
31/31 - 17s - loss: 0.6293 - accuracy: 0.6502 - val_loss: 0.8633 - val_accuracy: 0.5429 - 17s/epoch - 535ms/step
Epoch 26/1000
31/31 - 17s - loss: 0.6168 - accuracy: 0.6636 - val_loss: 0.8529 - val_accuracy: 0.5498 - 17s/epoch - 542ms/step
Epoch 27/1000
31/31 - 16s - loss: 0.6002 - accuracy: 0.6740 - val_loss: 0.9338 - val_accuracy: 0.5400 - 16s/epoch - 527ms/step
Epoch 28/1000
31/31 - 17s - loss: 0.5948 - accuracy: 0.6808 - val_loss: 1.0028 - val_accuracy: 0.5238 - 17s/epoch - 548ms/step
Epoch 29/1000
31/31 - 18s - loss: 0.5828 - accuracy: 0.6916 - val_loss: 0.8035 - val_accuracy: 0.5581 - 18s/epoch - 571ms/step
Epoch 30/1000
31/31 - 17s - loss: 0.5692 - accuracy: 0.7049 - val_loss: 0.8421 - val_accuracy: 0.5489 - 17s/epoch - 552ms/step
Epoch 31/1000
31/31 - 17s - loss: 0.5650 - accuracy: 0.7070 - val_loss: 0.9764 - val_accuracy: 0.5359 - 17s/epoch - 558ms/step
Epoch 32/1000
31/31 - 17s - loss: 0.5518 - accuracy: 0.7194 - val_loss: 1.0725 - val_accuracy: 0.5175 - 17s/epoch - 552ms/step
Epoch 33/1000
31/31 - 17s - loss: 0.5444 - accuracy: 0.7264 - val_loss: 0.8811 - val_accuracy: 0.5514 - 17s/epoch - 553ms/step
Epoch 34/1000
31/31 - 17s - loss: 0.5298 - accuracy: 0.7404 - val_loss: 1.0590 - val_accuracy: 0.5254 - 17s/epoch - 553ms/step
Epoch 35/1000
31/31 - 18s - loss: 0.5252 - accuracy: 0.7441 - val_loss: 1.1377 - val_accuracy: 0.5117 - 18s/epoch - 565ms/step
Epoch 36/1000
31/31 - 17s - loss: 0.5214 - accuracy: 0.7466 - val_loss: 1.0434 - val_accuracy: 0.5200 - 17s/epoch - 554ms/step
Epoch 37/1000
31/31 - 18s - loss: 0.5045 - accuracy: 0.7617 - val_loss: 0.9327 - val_accuracy: 0.5381 - 18s/epoch - 579ms/step
Epoch 38/1000
31/31 - 17s - loss: 0.5007 - accuracy: 0.7652 - val_loss: 0.8967 - val_accuracy: 0.5343 - 17s/epoch - 562ms/step
Epoch 39/1000
31/31 - 17s - loss: 0.4892 - accuracy: 0.7743 - val_loss: 0.9093 - val_accuracy: 0.5562 - 17s/epoch - 558ms/step
Epoch 40/1000
31/31 - 17s - loss: 0.4814 - accuracy: 0.7815 - val_loss: 0.8087 - val_accuracy: 0.5829 - 17s/epoch - 558ms/step
Epoch 41/1000
31/31 - 17s - loss: 0.4721 - accuracy: 0.7905 - val_loss: 0.8731 - val_accuracy: 0.5489 - 17s/epoch - 558ms/step
Epoch 42/1000
31/31 - 17s - loss: 0.4634 - accuracy: 0.7961 - val_loss: 0.8677 - val_accuracy: 0.5333 - 17s/epoch - 549ms/step
Epoch 43/1000
31/31 - 18s - loss: 0.4580 - accuracy: 0.8000 - val_loss: 0.7746 - val_accuracy: 0.5844 - 18s/epoch - 569ms/step
Epoch 44/1000
31/31 - 18s - loss: 0.4519 - accuracy: 0.8086 - val_loss: 1.0092 - val_accuracy: 0.5305 - 18s/epoch - 577ms/step
Epoch 45/1000
31/31 - 17s - loss: 0.4371 - accuracy: 0.8181 - val_loss: 1.0357 - val_accuracy: 0.5371 - 17s/epoch - 547ms/step
Epoch 46/1000
31/31 - 17s - loss: 0.4307 - accuracy: 0.8223 - val_loss: 0.8382 - val_accuracy: 0.5673 - 17s/epoch - 535ms/step
Epoch 47/1000
31/31 - 17s - loss: 0.4216 - accuracy: 0.8306 - val_loss: 0.9934 - val_accuracy: 0.5333 - 17s/epoch - 551ms/step
Epoch 48/1000
31/31 - 16s - loss: 0.4135 - accuracy: 0.8340 - val_loss: 0.8885 - val_accuracy: 0.5559 - 16s/epoch - 532ms/step
Epoch 49/1000
31/31 - 17s - loss: 0.4080 - accuracy: 0.8407 - val_loss: 0.7973 - val_accuracy: 0.5749 - 17s/epoch - 536ms/step
Epoch 50/1000
31/31 - 17s - loss: 0.4030 - accuracy: 0.8414 - val_loss: 0.8892 - val_accuracy: 0.5556 - 17s/epoch - 564ms/step
Epoch 51/1000
31/31 - 17s - loss: 0.3912 - accuracy: 0.8518 - val_loss: 0.7385 - val_accuracy: 0.6048 - 17s/epoch - 549ms/step
Epoch 52/1000
31/31 - 17s - loss: 0.3884 - accuracy: 0.8554 - val_loss: 1.1966 - val_accuracy: 0.5216 - 17s/epoch - 541ms/step
Epoch 53/1000
31/31 - 17s - loss: 0.3782 - accuracy: 0.8607 - val_loss: 0.9825 - val_accuracy: 0.5368 - 17s/epoch - 533ms/step
Epoch 54/1000
31/31 - 17s - loss: 0.3707 - accuracy: 0.8652 - val_loss: 0.8566 - val_accuracy: 0.5629 - 17s/epoch - 532ms/step
Epoch 55/1000
31/31 - 16s - loss: 0.3650 - accuracy: 0.8690 - val_loss: 1.0170 - val_accuracy: 0.5387 - 16s/epoch - 524ms/step
Epoch 56/1000
31/31 - 17s - loss: 0.3567 - accuracy: 0.8778 - val_loss: 0.9176 - val_accuracy: 0.5524 - 17s/epoch - 536ms/step
Epoch 57/1000
31/31 - 17s - loss: 0.3529 - accuracy: 0.8765 - val_loss: 0.8346 - val_accuracy: 0.5740 - 17s/epoch - 546ms/step
Epoch 58/1000
31/31 - 16s - loss: 0.3446 - accuracy: 0.8830 - val_loss: 0.8048 - val_accuracy: 0.5660 - 16s/epoch - 521ms/step
Epoch 59/1000
31/31 - 17s - loss: 0.3413 - accuracy: 0.8827 - val_loss: 0.7588 - val_accuracy: 0.5959 - 17s/epoch - 545ms/step
Epoch 60/1000
31/31 - 17s - loss: 0.3349 - accuracy: 0.8864 - val_loss: 0.8993 - val_accuracy: 0.5571 - 17s/epoch - 539ms/step
Epoch 61/1000
31/31 - 17s - loss: 0.3242 - accuracy: 0.8953 - val_loss: 1.0875 - val_accuracy: 0.5254 - 17s/epoch - 535ms/step
Epoch 62/1000
31/31 - 17s - loss: 0.3179 - accuracy: 0.8996 - val_loss: 0.8913 - val_accuracy: 0.5737 - 17s/epoch - 536ms/step
Epoch 63/1000
31/31 - 17s - loss: 0.3139 - accuracy: 0.9005 - val_loss: 0.8374 - val_accuracy: 0.5759 - 17s/epoch - 538ms/step
Epoch 64/1000
31/31 - 16s - loss: 0.3133 - accuracy: 0.8990 - val_loss: 1.0317 - val_accuracy: 0.5441 - 16s/epoch - 517ms/step
Epoch 65/1000
31/31 - 16s - loss: 0.3038 - accuracy: 0.9061 - val_loss: 0.9155 - val_accuracy: 0.5641 - 16s/epoch - 530ms/step
Epoch 66/1000
31/31 - 16s - loss: 0.2973 - accuracy: 0.9088 - val_loss: 0.8122 - val_accuracy: 0.5873 - 16s/epoch - 526ms/step
Epoch 67/1000
31/31 - 17s - loss: 0.2945 - accuracy: 0.9096 - val_loss: 0.9153 - val_accuracy: 0.5622 - 17s/epoch - 534ms/step
Epoch 68/1000
31/31 - 16s - loss: 0.2883 - accuracy: 0.9123 - val_loss: 0.9625 - val_accuracy: 0.5508 - 16s/epoch - 523ms/step
Epoch 69/1000
31/31 - 16s - loss: 0.2843 - accuracy: 0.9168 - val_loss: 1.0374 - val_accuracy: 0.5413 - 16s/epoch - 531ms/step
Epoch 70/1000
31/31 - 16s - loss: 0.2745 - accuracy: 0.9204 - val_loss: 0.8084 - val_accuracy: 0.5886 - 16s/epoch - 524ms/step
Epoch 71/1000
31/31 - 16s - loss: 0.2725 - accuracy: 0.9206 - val_loss: 1.1165 - val_accuracy: 0.5333 - 16s/epoch - 528ms/step
2021-11-19 16:56:26.268046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 16:56:26.268124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 17:00:10.773923: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 323 of 1024
2021-11-19 17:00:20.753019: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 660 of 1024
2021-11-19 17:00:30.775180: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 992 of 1024
2021-11-19 17:00:31.820051: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 17:21:12.609825: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 383 of 1024
2021-11-19 17:21:22.601786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 846 of 1024
2021-11-19 17:21:27.124513: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'VGG19_Notredame_band_aug_gender_base_F50M50', 'model': 'VGG19', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_6"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 vgg19 (Functional)          (None, 5, 7, 512)         20024384  
                                                                 
 global_average_pooling2d_6   (None, 512)              0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_12 (Dense)            (None, 1024)              525312    
                                                                 
 batch_normalization_303 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_6 (Dropout)         (None, 1024)              0         
                                                                 
 activation_303 (Activation)  (None, 1024)             0         
                                                                 
 dense_13 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 20,555,842
Trainable params: 529,410
Non-trainable params: 20,026,432
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 1352s - loss: 1.3418 - accuracy: 0.3337 - val_loss: 1.5197 - val_accuracy: 0.5003 - 1352s/epoch - 44s/step
Epoch 2/1000
31/31 - 27s - loss: 0.8878 - accuracy: 0.4221 - val_loss: 1.0685 - val_accuracy: 0.5000 - 27s/epoch - 872ms/step
Epoch 3/1000
31/31 - 27s - loss: 0.9892 - accuracy: 0.3379 - val_loss: 0.8277 - val_accuracy: 0.5114 - 27s/epoch - 879ms/step
Epoch 4/1000
31/31 - 28s - loss: 0.9315 - accuracy: 0.3759 - val_loss: 0.7149 - val_accuracy: 0.5492 - 28s/epoch - 889ms/step
Epoch 5/1000
31/31 - 27s - loss: 0.9282 - accuracy: 0.3807 - val_loss: 0.8525 - val_accuracy: 0.5146 - 27s/epoch - 880ms/step
Epoch 6/1000
31/31 - 27s - loss: 0.9019 - accuracy: 0.3944 - val_loss: 0.7231 - val_accuracy: 0.5530 - 27s/epoch - 884ms/step
Epoch 7/1000
31/31 - 27s - loss: 0.8915 - accuracy: 0.4038 - val_loss: 0.7035 - val_accuracy: 0.5692 - 27s/epoch - 885ms/step
Epoch 8/1000
31/31 - 27s - loss: 0.8750 - accuracy: 0.4155 - val_loss: 0.6713 - val_accuracy: 0.5968 - 27s/epoch - 887ms/step
Epoch 9/1000
31/31 - 27s - loss: 0.8641 - accuracy: 0.4214 - val_loss: 0.6604 - val_accuracy: 0.6083 - 27s/epoch - 885ms/step
Epoch 10/1000
31/31 - 27s - loss: 0.8507 - accuracy: 0.4370 - val_loss: 0.6797 - val_accuracy: 0.5790 - 27s/epoch - 869ms/step
Epoch 11/1000
31/31 - 27s - loss: 0.8381 - accuracy: 0.4484 - val_loss: 0.6034 - val_accuracy: 0.6756 - 27s/epoch - 885ms/step
Epoch 12/1000
31/31 - 27s - loss: 0.8212 - accuracy: 0.4579 - val_loss: 0.6292 - val_accuracy: 0.6457 - 27s/epoch - 883ms/step
Epoch 13/1000
31/31 - 27s - loss: 0.8150 - accuracy: 0.4705 - val_loss: 0.6073 - val_accuracy: 0.6692 - 27s/epoch - 879ms/step
Epoch 14/1000
31/31 - 28s - loss: 0.8012 - accuracy: 0.4799 - val_loss: 0.5822 - val_accuracy: 0.7048 - 28s/epoch - 891ms/step
Epoch 15/1000
31/31 - 27s - loss: 0.7960 - accuracy: 0.4841 - val_loss: 0.6353 - val_accuracy: 0.6213 - 27s/epoch - 875ms/step
Epoch 16/1000
31/31 - 27s - loss: 0.7829 - accuracy: 0.4948 - val_loss: 0.6214 - val_accuracy: 0.6378 - 27s/epoch - 882ms/step
Epoch 17/1000
31/31 - 27s - loss: 0.7711 - accuracy: 0.5060 - val_loss: 0.6354 - val_accuracy: 0.6238 - 27s/epoch - 879ms/step
Epoch 18/1000
31/31 - 27s - loss: 0.7580 - accuracy: 0.5199 - val_loss: 0.6162 - val_accuracy: 0.6451 - 27s/epoch - 878ms/step
Epoch 19/1000
31/31 - 27s - loss: 0.7535 - accuracy: 0.5226 - val_loss: 0.6469 - val_accuracy: 0.6108 - 27s/epoch - 874ms/step
Epoch 20/1000
31/31 - 27s - loss: 0.7478 - accuracy: 0.5303 - val_loss: 0.6116 - val_accuracy: 0.6565 - 27s/epoch - 872ms/step
Epoch 21/1000
31/31 - 27s - loss: 0.7350 - accuracy: 0.5384 - val_loss: 0.6100 - val_accuracy: 0.6587 - 27s/epoch - 876ms/step
Epoch 22/1000
31/31 - 27s - loss: 0.7279 - accuracy: 0.5481 - val_loss: 0.6235 - val_accuracy: 0.6505 - 27s/epoch - 879ms/step
Epoch 23/1000
31/31 - 27s - loss: 0.7206 - accuracy: 0.5551 - val_loss: 0.6223 - val_accuracy: 0.6492 - 27s/epoch - 881ms/step
Epoch 24/1000
31/31 - 27s - loss: 0.7111 - accuracy: 0.5695 - val_loss: 0.5660 - val_accuracy: 0.7327 - 27s/epoch - 880ms/step
Epoch 25/1000
31/31 - 27s - loss: 0.7071 - accuracy: 0.5718 - val_loss: 0.6041 - val_accuracy: 0.6635 - 27s/epoch - 880ms/step
Epoch 26/1000
31/31 - 27s - loss: 0.6911 - accuracy: 0.5859 - val_loss: 0.5762 - val_accuracy: 0.7140 - 27s/epoch - 868ms/step
Epoch 27/1000
31/31 - 27s - loss: 0.6878 - accuracy: 0.5907 - val_loss: 0.6160 - val_accuracy: 0.6444 - 27s/epoch - 878ms/step
Epoch 28/1000
31/31 - 27s - loss: 0.6765 - accuracy: 0.5991 - val_loss: 0.6076 - val_accuracy: 0.6756 - 27s/epoch - 877ms/step
Epoch 29/1000
31/31 - 28s - loss: 0.6703 - accuracy: 0.6104 - val_loss: 0.5604 - val_accuracy: 0.7330 - 28s/epoch - 889ms/step
Epoch 30/1000
31/31 - 27s - loss: 0.6580 - accuracy: 0.6223 - val_loss: 0.6614 - val_accuracy: 0.6079 - 27s/epoch - 879ms/step
Epoch 31/1000
31/31 - 27s - loss: 0.6523 - accuracy: 0.6247 - val_loss: 0.6018 - val_accuracy: 0.6676 - 27s/epoch - 883ms/step
Epoch 32/1000
31/31 - 27s - loss: 0.6477 - accuracy: 0.6327 - val_loss: 0.5896 - val_accuracy: 0.6946 - 27s/epoch - 882ms/step
Epoch 33/1000
31/31 - 27s - loss: 0.6422 - accuracy: 0.6373 - val_loss: 0.6249 - val_accuracy: 0.6317 - 27s/epoch - 877ms/step
Epoch 34/1000
31/31 - 27s - loss: 0.6298 - accuracy: 0.6477 - val_loss: 0.5993 - val_accuracy: 0.6698 - 27s/epoch - 881ms/step
Epoch 35/1000
31/31 - 27s - loss: 0.6279 - accuracy: 0.6507 - val_loss: 0.5791 - val_accuracy: 0.6987 - 27s/epoch - 877ms/step
Epoch 36/1000
31/31 - 27s - loss: 0.6146 - accuracy: 0.6644 - val_loss: 0.5910 - val_accuracy: 0.6787 - 27s/epoch - 874ms/step
Epoch 37/1000
31/31 - 27s - loss: 0.6094 - accuracy: 0.6704 - val_loss: 0.6188 - val_accuracy: 0.6432 - 27s/epoch - 877ms/step
Epoch 38/1000
31/31 - 27s - loss: 0.6029 - accuracy: 0.6761 - val_loss: 0.6110 - val_accuracy: 0.6581 - 27s/epoch - 876ms/step
Epoch 39/1000
31/31 - 27s - loss: 0.5951 - accuracy: 0.6827 - val_loss: 0.6369 - val_accuracy: 0.6368 - 27s/epoch - 879ms/step
Epoch 40/1000
31/31 - 27s - loss: 0.5895 - accuracy: 0.6892 - val_loss: 0.6142 - val_accuracy: 0.6568 - 27s/epoch - 876ms/step
Epoch 41/1000
31/31 - 27s - loss: 0.5788 - accuracy: 0.7011 - val_loss: 0.5772 - val_accuracy: 0.7003 - 27s/epoch - 878ms/step
Epoch 42/1000
31/31 - 27s - loss: 0.5748 - accuracy: 0.7034 - val_loss: 0.6205 - val_accuracy: 0.6470 - 27s/epoch - 870ms/step
Epoch 43/1000
31/31 - 27s - loss: 0.5665 - accuracy: 0.7096 - val_loss: 0.5885 - val_accuracy: 0.6848 - 27s/epoch - 886ms/step
Epoch 44/1000
31/31 - 27s - loss: 0.5594 - accuracy: 0.7173 - val_loss: 0.6358 - val_accuracy: 0.6333 - 27s/epoch - 883ms/step
Epoch 45/1000
31/31 - 27s - loss: 0.5557 - accuracy: 0.7200 - val_loss: 0.5794 - val_accuracy: 0.6990 - 27s/epoch - 865ms/step
Epoch 46/1000
31/31 - 27s - loss: 0.5491 - accuracy: 0.7267 - val_loss: 0.5749 - val_accuracy: 0.6987 - 27s/epoch - 876ms/step
Epoch 47/1000
31/31 - 27s - loss: 0.5408 - accuracy: 0.7371 - val_loss: 0.6271 - val_accuracy: 0.6410 - 27s/epoch - 879ms/step
Epoch 48/1000
31/31 - 27s - loss: 0.5387 - accuracy: 0.7378 - val_loss: 0.6611 - val_accuracy: 0.6086 - 27s/epoch - 877ms/step
Epoch 49/1000
31/31 - 27s - loss: 0.5298 - accuracy: 0.7452 - val_loss: 0.5729 - val_accuracy: 0.7111 - 27s/epoch - 880ms/step
2021-11-19 17:44:45.236808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 17:44:45.236936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 17:47:04.312843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 873 of 1024
2021-11-19 17:47:05.682451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 17:54:11.380109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 892 of 1024
2021-11-19 17:54:12.665942: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'Xception_Notredame_band_aug_gender_base_F50M50', 'model': 'Xception', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 xception (Functional)       (None, 6, 7, 2048)        20861480  
                                                                 
 global_average_pooling2d_7   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_14 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_308 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_7 (Dropout)         (None, 1024)              0         
                                                                 
 activation_304 (Activation)  (None, 1024)             0         
                                                                 
 dense_15 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 22,965,802
Trainable params: 2,102,274
Non-trainable params: 20,863,528
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 474s - loss: 1.3471 - accuracy: 0.4607 - val_loss: 0.7452 - val_accuracy: 0.5102 - 474s/epoch - 15s/step
Epoch 2/1000
31/31 - 14s - loss: 0.9520 - accuracy: 0.4096 - val_loss: 0.7487 - val_accuracy: 0.5283 - 14s/epoch - 460ms/step
Epoch 3/1000
31/31 - 15s - loss: 1.0020 - accuracy: 0.3652 - val_loss: 0.7201 - val_accuracy: 0.5387 - 15s/epoch - 484ms/step
Epoch 4/1000
31/31 - 15s - loss: 0.9377 - accuracy: 0.3986 - val_loss: 0.6743 - val_accuracy: 0.5978 - 15s/epoch - 471ms/step
Epoch 5/1000
31/31 - 14s - loss: 0.9121 - accuracy: 0.4172 - val_loss: 0.6905 - val_accuracy: 0.5644 - 14s/epoch - 466ms/step
Epoch 6/1000
31/31 - 14s - loss: 0.8881 - accuracy: 0.4350 - val_loss: 0.6847 - val_accuracy: 0.5730 - 14s/epoch - 455ms/step
Epoch 7/1000
31/31 - 15s - loss: 0.8614 - accuracy: 0.4512 - val_loss: 0.6508 - val_accuracy: 0.6352 - 15s/epoch - 480ms/step
Epoch 8/1000
31/31 - 14s - loss: 0.8481 - accuracy: 0.4641 - val_loss: 0.6893 - val_accuracy: 0.5778 - 14s/epoch - 452ms/step
Epoch 9/1000
31/31 - 14s - loss: 0.8193 - accuracy: 0.4822 - val_loss: 0.7421 - val_accuracy: 0.5451 - 14s/epoch - 463ms/step
Epoch 10/1000
31/31 - 14s - loss: 0.8066 - accuracy: 0.4925 - val_loss: 0.7251 - val_accuracy: 0.5559 - 14s/epoch - 464ms/step
Epoch 11/1000
31/31 - 14s - loss: 0.7923 - accuracy: 0.5076 - val_loss: 0.7100 - val_accuracy: 0.5787 - 14s/epoch - 443ms/step
Epoch 12/1000
31/31 - 15s - loss: 0.7703 - accuracy: 0.5211 - val_loss: 0.7971 - val_accuracy: 0.5368 - 15s/epoch - 468ms/step
Epoch 13/1000
31/31 - 15s - loss: 0.7558 - accuracy: 0.5377 - val_loss: 0.7791 - val_accuracy: 0.5330 - 15s/epoch - 473ms/step
Epoch 14/1000
31/31 - 14s - loss: 0.7429 - accuracy: 0.5487 - val_loss: 0.7585 - val_accuracy: 0.5498 - 14s/epoch - 465ms/step
Epoch 15/1000
31/31 - 15s - loss: 0.7280 - accuracy: 0.5595 - val_loss: 0.7742 - val_accuracy: 0.5454 - 15s/epoch - 477ms/step
Epoch 16/1000
31/31 - 15s - loss: 0.7129 - accuracy: 0.5716 - val_loss: 0.6887 - val_accuracy: 0.5902 - 15s/epoch - 472ms/step
Epoch 17/1000
31/31 - 15s - loss: 0.6981 - accuracy: 0.5893 - val_loss: 0.7452 - val_accuracy: 0.5679 - 15s/epoch - 487ms/step
Epoch 18/1000
31/31 - 15s - loss: 0.6853 - accuracy: 0.6029 - val_loss: 0.7780 - val_accuracy: 0.5419 - 15s/epoch - 474ms/step
Epoch 19/1000
31/31 - 15s - loss: 0.6730 - accuracy: 0.6109 - val_loss: 0.7621 - val_accuracy: 0.5476 - 15s/epoch - 468ms/step
Epoch 20/1000
31/31 - 14s - loss: 0.6555 - accuracy: 0.6270 - val_loss: 0.6975 - val_accuracy: 0.5930 - 14s/epoch - 455ms/step
Epoch 21/1000
31/31 - 14s - loss: 0.6492 - accuracy: 0.6331 - val_loss: 0.7853 - val_accuracy: 0.5473 - 14s/epoch - 467ms/step
Epoch 22/1000
31/31 - 14s - loss: 0.6383 - accuracy: 0.6453 - val_loss: 0.7757 - val_accuracy: 0.5432 - 14s/epoch - 456ms/step
Epoch 23/1000
31/31 - 15s - loss: 0.6255 - accuracy: 0.6532 - val_loss: 0.8339 - val_accuracy: 0.5314 - 15s/epoch - 479ms/step
Epoch 24/1000
31/31 - 14s - loss: 0.6180 - accuracy: 0.6609 - val_loss: 0.7748 - val_accuracy: 0.5562 - 14s/epoch - 438ms/step
Epoch 25/1000
31/31 - 15s - loss: 0.6068 - accuracy: 0.6713 - val_loss: 0.8038 - val_accuracy: 0.5463 - 15s/epoch - 471ms/step
Epoch 26/1000
31/31 - 14s - loss: 0.5927 - accuracy: 0.6810 - val_loss: 0.7176 - val_accuracy: 0.5813 - 14s/epoch - 460ms/step
Epoch 27/1000
31/31 - 14s - loss: 0.5884 - accuracy: 0.6881 - val_loss: 0.7078 - val_accuracy: 0.5949 - 14s/epoch - 456ms/step
2021-11-19 18:01:09.321728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 18:01:09.321858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 18:13:20.670789: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 809 of 1024
2021-11-19 18:13:22.797057: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'EfficientNetB0_Notredame_band_aug_gender_base_F50M50', 'model': 'EfficientNetB0', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb0 (Functional)  (None, 6, 7, 1280)       4049571   
                                                                 
 global_average_pooling2d_8   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_16 (Dense)            (None, 1024)              1311744   
                                                                 
 batch_normalization_309 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_8 (Dropout)         (None, 1024)              0         
                                                                 
 activation_305 (Activation)  (None, 1024)             0         
                                                                 
 dense_17 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 5,367,461
Trainable params: 1,315,842
Non-trainable params: 4,051,619
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
31/31 - 537s - loss: 1.3862 - accuracy: 0.4867 - val_loss: 0.6742 - val_accuracy: 0.5644 - 537s/epoch - 17s/step
Epoch 2/1000
31/31 - 13s - loss: 0.8924 - accuracy: 0.4354 - val_loss: 0.7868 - val_accuracy: 0.5010 - 13s/epoch - 409ms/step
Epoch 3/1000
31/31 - 13s - loss: 1.0198 - accuracy: 0.3339 - val_loss: 0.7428 - val_accuracy: 0.5149 - 13s/epoch - 407ms/step
Epoch 4/1000
31/31 - 13s - loss: 0.9481 - accuracy: 0.3696 - val_loss: 0.7184 - val_accuracy: 0.5200 - 13s/epoch - 409ms/step
Epoch 5/1000
31/31 - 13s - loss: 0.9395 - accuracy: 0.3757 - val_loss: 0.7543 - val_accuracy: 0.5156 - 13s/epoch - 412ms/step
Epoch 6/1000
31/31 - 13s - loss: 0.9183 - accuracy: 0.3907 - val_loss: 0.7271 - val_accuracy: 0.5244 - 13s/epoch - 415ms/step
Epoch 7/1000
31/31 - 13s - loss: 0.9071 - accuracy: 0.3961 - val_loss: 0.7366 - val_accuracy: 0.5305 - 13s/epoch - 415ms/step
Epoch 8/1000
31/31 - 13s - loss: 0.8943 - accuracy: 0.4021 - val_loss: 0.7567 - val_accuracy: 0.5251 - 13s/epoch - 409ms/step
Epoch 9/1000
31/31 - 13s - loss: 0.8832 - accuracy: 0.4133 - val_loss: 0.8395 - val_accuracy: 0.5086 - 13s/epoch - 407ms/step
Epoch 10/1000
31/31 - 13s - loss: 0.8672 - accuracy: 0.4241 - val_loss: 0.7312 - val_accuracy: 0.5403 - 13s/epoch - 426ms/step
Epoch 11/1000
31/31 - 13s - loss: 0.8519 - accuracy: 0.4397 - val_loss: 0.7712 - val_accuracy: 0.5190 - 13s/epoch - 420ms/step
Epoch 12/1000
31/31 - 13s - loss: 0.8398 - accuracy: 0.4505 - val_loss: 0.8244 - val_accuracy: 0.5156 - 13s/epoch - 423ms/step
Epoch 13/1000
31/31 - 13s - loss: 0.8307 - accuracy: 0.4575 - val_loss: 0.7337 - val_accuracy: 0.5432 - 13s/epoch - 415ms/step
Epoch 14/1000
31/31 - 13s - loss: 0.8197 - accuracy: 0.4652 - val_loss: 0.7548 - val_accuracy: 0.5410 - 13s/epoch - 415ms/step
Epoch 15/1000
31/31 - 13s - loss: 0.8083 - accuracy: 0.4764 - val_loss: 0.7500 - val_accuracy: 0.5432 - 13s/epoch - 408ms/step
Epoch 16/1000
31/31 - 12s - loss: 0.7968 - accuracy: 0.4873 - val_loss: 0.8534 - val_accuracy: 0.5095 - 12s/epoch - 401ms/step
Epoch 17/1000
31/31 - 13s - loss: 0.7896 - accuracy: 0.4938 - val_loss: 0.7438 - val_accuracy: 0.5349 - 13s/epoch - 411ms/step
Epoch 18/1000
31/31 - 13s - loss: 0.7726 - accuracy: 0.5070 - val_loss: 0.8350 - val_accuracy: 0.5140 - 13s/epoch - 407ms/step
Epoch 19/1000
31/31 - 13s - loss: 0.7671 - accuracy: 0.5167 - val_loss: 0.7893 - val_accuracy: 0.5308 - 13s/epoch - 413ms/step
Epoch 20/1000
31/31 - 13s - loss: 0.7509 - accuracy: 0.5283 - val_loss: 0.8359 - val_accuracy: 0.5200 - 13s/epoch - 408ms/step
Epoch 21/1000
31/31 - 13s - loss: 0.7392 - accuracy: 0.5380 - val_loss: 0.7125 - val_accuracy: 0.5540 - 13s/epoch - 417ms/step
2021-11-19 18:18:24.618784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 18:18:24.618851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 18:21:20.017558: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 782 of 1024
2021-11-19 18:21:22.823390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 18:29:16.569346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 796 of 1024
2021-11-19 18:29:19.632313: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'EfficientNetB4_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'EfficientNetB4', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\EfficientNetB4_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb4 (Functional)  (None, 6, 7, 1792)       17673823  
                                                                 
 global_average_pooling2d_9   (None, 1792)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_18 (Dense)            (None, 1024)              1836032   
                                                                 
 batch_normalization_310 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_9 (Dropout)         (None, 1024)              0         
                                                                 
 activation_306 (Activation)  (None, 1024)             0         
                                                                 
 dense_19 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 19,516,001
Trainable params: 1,840,130
Non-trainable params: 17,675,871
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\EfficientNetB4_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb4 (Functional)  (None, 6, 7, 1792)       17673823  
                                                                 
 global_average_pooling2d_9   (None, 1792)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_18 (Dense)            (None, 1024)              1836032   
                                                                 
 batch_normalization_310 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_9 (Dropout)         (None, 1024)              0         
                                                                 
 activation_306 (Activation)  (None, 1024)             0         
                                                                 
 dense_19 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 19,516,001
Trainable params: 19,388,746
Non-trainable params: 127,255
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 598s - loss: 0.4579 - accuracy: 0.8684 - val_loss: 2.1560 - val_accuracy: 0.5000 - 598s/epoch - 5s/step
Epoch 2/1000
124/124 - 83s - loss: 0.6225 - accuracy: 0.8441 - val_loss: 1.9413 - val_accuracy: 0.5133 - 83s/epoch - 672ms/step
Epoch 3/1000
124/124 - 87s - loss: 0.7975 - accuracy: 0.7269 - val_loss: 1.2839 - val_accuracy: 0.4984 - 87s/epoch - 701ms/step
Epoch 4/1000
124/124 - 82s - loss: 0.4450 - accuracy: 0.8471 - val_loss: 0.8253 - val_accuracy: 0.4400 - 82s/epoch - 660ms/step
Epoch 5/1000
124/124 - 82s - loss: 0.6218 - accuracy: 0.8245 - val_loss: 1.3108 - val_accuracy: 0.4937 - 82s/epoch - 658ms/step
Epoch 6/1000
124/124 - 84s - loss: 0.8991 - accuracy: 0.5365 - val_loss: 0.7308 - val_accuracy: 0.5000 - 84s/epoch - 674ms/step
Epoch 7/1000
124/124 - 87s - loss: 0.7903 - accuracy: 0.4142 - val_loss: 0.7151 - val_accuracy: 0.5010 - 87s/epoch - 703ms/step
Epoch 8/1000
124/124 - 82s - loss: 0.7745 - accuracy: 0.4089 - val_loss: 0.7881 - val_accuracy: 0.4956 - 82s/epoch - 660ms/step
Epoch 9/1000
124/124 - 82s - loss: 0.7890 - accuracy: 0.4038 - val_loss: 0.7080 - val_accuracy: 0.5000 - 82s/epoch - 662ms/step
Epoch 10/1000
124/124 - 83s - loss: 0.7827 - accuracy: 0.4038 - val_loss: 0.7048 - val_accuracy: 0.5000 - 83s/epoch - 669ms/step
Epoch 11/1000
124/124 - 86s - loss: 0.7108 - accuracy: 0.5389 - val_loss: 0.8308 - val_accuracy: 0.5006 - 86s/epoch - 697ms/step
Epoch 12/1000
124/124 - 84s - loss: 0.9019 - accuracy: 0.3606 - val_loss: 0.7034 - val_accuracy: 0.5000 - 84s/epoch - 675ms/step
Epoch 13/1000
124/124 - 83s - loss: 0.5540 - accuracy: 0.7419 - val_loss: 0.6854 - val_accuracy: 0.4930 - 83s/epoch - 670ms/step
Epoch 14/1000
124/124 - 82s - loss: 0.8317 - accuracy: 0.5162 - val_loss: 0.7422 - val_accuracy: 0.5000 - 82s/epoch - 660ms/step
Epoch 15/1000
124/124 - 86s - loss: 0.7848 - accuracy: 0.4704 - val_loss: 0.7238 - val_accuracy: 0.5000 - 86s/epoch - 692ms/step
Epoch 16/1000
124/124 - 81s - loss: 0.7779 - accuracy: 0.3826 - val_loss: 0.7081 - val_accuracy: 0.5000 - 81s/epoch - 655ms/step
Epoch 17/1000
124/124 - 82s - loss: 0.7372 - accuracy: 0.6081 - val_loss: 0.7601 - val_accuracy: 0.5000 - 82s/epoch - 659ms/step
Epoch 18/1000
124/124 - 82s - loss: 0.8413 - accuracy: 0.4030 - val_loss: 0.6969 - val_accuracy: 0.5000 - 82s/epoch - 661ms/step
Epoch 19/1000
124/124 - 86s - loss: 0.7722 - accuracy: 0.3830 - val_loss: 0.6983 - val_accuracy: 0.5000 - 86s/epoch - 691ms/step
Epoch 20/1000
124/124 - 83s - loss: 0.7553 - accuracy: 0.3875 - val_loss: 0.6973 - val_accuracy: 0.5000 - 83s/epoch - 672ms/step
Epoch 21/1000
124/124 - 82s - loss: 0.7503 - accuracy: 0.3841 - val_loss: 12.8264 - val_accuracy: 0.5000 - 82s/epoch - 659ms/step
Epoch 22/1000
124/124 - 82s - loss: 0.7471 - accuracy: 0.3807 - val_loss: 0.7029 - val_accuracy: 0.5000 - 82s/epoch - 665ms/step
2021-11-19 18:59:20.693981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 18:59:20.694032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 19:17:12.017548: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 460 of 1024
2021-11-19 19:17:22.029214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 874 of 1024
2021-11-19 19:17:25.614049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'DenseNet121_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'DenseNet121', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\DenseNet121_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_10"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 densenet121 (Functional)    (None, 5, 7, 1024)        7037504   
                                                                 
 global_average_pooling2d_10  (None, 1024)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_20 (Dense)            (None, 1024)              1049600   
                                                                 
 batch_normalization_311 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_10 (Dropout)        (None, 1024)              0         
                                                                 
 activation_307 (Activation)  (None, 1024)             0         
                                                                 
 dense_21 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 8,093,250
Trainable params: 1,053,698
Non-trainable params: 7,039,552
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\DenseNet121_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_10"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 densenet121 (Functional)    (None, 5, 7, 1024)        7037504   
                                                                 
 global_average_pooling2d_10  (None, 1024)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_20 (Dense)            (None, 1024)              1049600   
                                                                 
 batch_normalization_311 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_10 (Dropout)        (None, 1024)              0         
                                                                 
 activation_307 (Activation)  (None, 1024)             0         
                                                                 
 dense_21 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 8,093,250
Trainable params: 8,007,554
Non-trainable params: 85,696
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 886s - loss: 0.2676 - accuracy: 0.9180 - val_loss: 2.3388 - val_accuracy: 0.5032 - 886s/epoch - 7s/step
Epoch 2/1000
124/124 - 62s - loss: 0.4495 - accuracy: 0.9064 - val_loss: 636.9359 - val_accuracy: 0.5000 - 62s/epoch - 502ms/step
Epoch 3/1000
124/124 - 64s - loss: 0.5058 - accuracy: 0.8394 - val_loss: 17.6207 - val_accuracy: 0.5070 - 64s/epoch - 518ms/step
Epoch 4/1000
124/124 - 67s - loss: 0.6846 - accuracy: 0.7394 - val_loss: 6.3241 - val_accuracy: 0.5346 - 67s/epoch - 541ms/step
Epoch 5/1000
124/124 - 66s - loss: 0.6252 - accuracy: 0.6823 - val_loss: 0.8904 - val_accuracy: 0.4121 - 66s/epoch - 535ms/step
Epoch 6/1000
124/124 - 65s - loss: 0.6530 - accuracy: 0.6903 - val_loss: 0.8482 - val_accuracy: 0.4508 - 65s/epoch - 525ms/step
Epoch 7/1000
124/124 - 62s - loss: 0.6812 - accuracy: 0.7287 - val_loss: 0.9496 - val_accuracy: 0.4990 - 62s/epoch - 499ms/step
Epoch 8/1000
124/124 - 63s - loss: 0.7525 - accuracy: 0.5276 - val_loss: 15.9533 - val_accuracy: 0.4917 - 63s/epoch - 506ms/step
Epoch 9/1000
124/124 - 68s - loss: 0.7199 - accuracy: 0.5720 - val_loss: 0.7995 - val_accuracy: 0.4819 - 68s/epoch - 547ms/step
Epoch 10/1000
124/124 - 65s - loss: 0.6871 - accuracy: 0.5642 - val_loss: 1.0325 - val_accuracy: 0.4927 - 65s/epoch - 528ms/step
Epoch 11/1000
124/124 - 63s - loss: 0.7777 - accuracy: 0.5620 - val_loss: 53.0748 - val_accuracy: 0.5000 - 63s/epoch - 509ms/step
Epoch 12/1000
124/124 - 63s - loss: 0.7919 - accuracy: 0.4652 - val_loss: 0.7479 - val_accuracy: 0.5000 - 63s/epoch - 509ms/step
Epoch 13/1000
124/124 - 63s - loss: 0.6901 - accuracy: 0.5646 - val_loss: 0.8868 - val_accuracy: 0.5000 - 63s/epoch - 506ms/step
Epoch 14/1000
124/124 - 65s - loss: 0.5690 - accuracy: 0.7142 - val_loss: 0.9251 - val_accuracy: 0.4956 - 65s/epoch - 524ms/step
Epoch 15/1000
124/124 - 67s - loss: 0.6231 - accuracy: 0.7395 - val_loss: 1.2196 - val_accuracy: 0.4997 - 67s/epoch - 538ms/step
Epoch 16/1000
124/124 - 63s - loss: 0.8361 - accuracy: 0.6053 - val_loss: 0.8102 - val_accuracy: 0.5000 - 63s/epoch - 507ms/step
Epoch 17/1000
124/124 - 64s - loss: 0.7797 - accuracy: 0.4536 - val_loss: 0.7333 - val_accuracy: 0.5000 - 64s/epoch - 516ms/step
Epoch 18/1000
124/124 - 63s - loss: 0.5965 - accuracy: 0.5911 - val_loss: 1.0951 - val_accuracy: 0.5000 - 63s/epoch - 507ms/step
Epoch 19/1000
124/124 - 66s - loss: 0.6616 - accuracy: 0.7226 - val_loss: 0.7259 - val_accuracy: 0.5000 - 66s/epoch - 535ms/step
Epoch 20/1000
124/124 - 67s - loss: 0.5777 - accuracy: 0.6877 - val_loss: 0.7952 - val_accuracy: 0.5000 - 67s/epoch - 543ms/step
Epoch 21/1000
124/124 - 65s - loss: 0.7375 - accuracy: 0.5457 - val_loss: 0.7027 - val_accuracy: 0.5000 - 65s/epoch - 521ms/step
Epoch 22/1000
124/124 - 63s - loss: 0.7734 - accuracy: 0.3966 - val_loss: 0.7042 - val_accuracy: 0.5000 - 63s/epoch - 512ms/step
Epoch 23/1000
124/124 - 63s - loss: 0.5714 - accuracy: 0.6699 - val_loss: 148.8082 - val_accuracy: 0.5000 - 63s/epoch - 508ms/step
Epoch 24/1000
124/124 - 64s - loss: 0.5964 - accuracy: 0.6801 - val_loss: 3.6054 - val_accuracy: 0.5425 - 64s/epoch - 515ms/step
Epoch 25/1000
124/124 - 66s - loss: 0.7581 - accuracy: 0.6707 - val_loss: 0.7252 - val_accuracy: 0.5000 - 66s/epoch - 536ms/step
Epoch 26/1000
124/124 - 63s - loss: 0.6511 - accuracy: 0.6674 - val_loss: 0.7108 - val_accuracy: 0.5000 - 63s/epoch - 511ms/step
Epoch 27/1000
124/124 - 63s - loss: 0.7321 - accuracy: 0.4946 - val_loss: 0.7130 - val_accuracy: 0.5000 - 63s/epoch - 505ms/step
Epoch 28/1000
124/124 - 63s - loss: 0.5253 - accuracy: 0.6567 - val_loss: 0.8610 - val_accuracy: 0.5000 - 63s/epoch - 504ms/step
Epoch 29/1000
124/124 - 63s - loss: 0.6373 - accuracy: 0.7853 - val_loss: 0.8962 - val_accuracy: 0.5000 - 63s/epoch - 507ms/step
Epoch 30/1000
124/124 - 66s - loss: 0.5082 - accuracy: 0.8332 - val_loss: 0.8350 - val_accuracy: 0.5000 - 66s/epoch - 533ms/step
Epoch 31/1000
124/124 - 64s - loss: 0.7026 - accuracy: 0.6968 - val_loss: 0.7532 - val_accuracy: 0.5000 - 64s/epoch - 513ms/step
Epoch 32/1000
124/124 - 62s - loss: 0.7348 - accuracy: 0.5107 - val_loss: 0.7630 - val_accuracy: 0.5000 - 62s/epoch - 500ms/step
Epoch 33/1000
124/124 - 64s - loss: 0.7098 - accuracy: 0.3717 - val_loss: 0.6973 - val_accuracy: 0.5000 - 64s/epoch - 512ms/step
Epoch 34/1000
124/124 - 62s - loss: 0.7160 - accuracy: 0.5865 - val_loss: 8.2487 - val_accuracy: 0.5000 - 62s/epoch - 498ms/step
Epoch 35/1000
124/124 - 65s - loss: 0.6952 - accuracy: 0.5488 - val_loss: 0.7714 - val_accuracy: 0.5000 - 65s/epoch - 524ms/step
Epoch 36/1000
124/124 - 66s - loss: 0.4865 - accuracy: 0.7855 - val_loss: 0.9385 - val_accuracy: 0.5000 - 66s/epoch - 535ms/step
Epoch 37/1000
124/124 - 63s - loss: 0.5564 - accuracy: 0.7994 - val_loss: 10.8632 - val_accuracy: 0.5000 - 63s/epoch - 506ms/step
Epoch 38/1000
124/124 - 63s - loss: 0.7860 - accuracy: 0.5247 - val_loss: 0.8638 - val_accuracy: 0.5000 - 63s/epoch - 508ms/step
Epoch 39/1000
124/124 - 63s - loss: 0.7360 - accuracy: 0.3787 - val_loss: 0.6977 - val_accuracy: 0.5000 - 63s/epoch - 505ms/step
Epoch 40/1000
124/124 - 65s - loss: 0.7215 - accuracy: 0.3715 - val_loss: 0.6939 - val_accuracy: 0.5000 - 65s/epoch - 526ms/step
Epoch 41/1000
124/124 - 68s - loss: 0.7234 - accuracy: 0.3595 - val_loss: 0.6936 - val_accuracy: 0.5000 - 68s/epoch - 551ms/step
Epoch 42/1000
124/124 - 65s - loss: 0.7225 - accuracy: 0.3652 - val_loss: 0.6935 - val_accuracy: 0.5000 - 65s/epoch - 523ms/step
Epoch 43/1000
124/124 - 63s - loss: 0.7183 - accuracy: 0.3695 - val_loss: 0.6945 - val_accuracy: 0.5000 - 63s/epoch - 510ms/step
Epoch 44/1000
124/124 - 65s - loss: 0.7235 - accuracy: 0.3635 - val_loss: 0.6932 - val_accuracy: 0.5000 - 65s/epoch - 521ms/step
2021-11-19 20:04:43.472131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 20:04:43.472188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [96, 128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
2021-11-19 20:10:07.420947: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 714 of 1024
2021-11-19 20:10:11.626424: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 20:24:39.042782: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 536 of 1024
2021-11-19 20:24:47.167142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'MobileNetV2_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'MobileNetV2', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\MobileNetV2_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_11"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 mobilenetv2_1.00_224 (Funct  (None, 6, 7, 1280)       2257984   
 ional)                                                          
                                                                 
 global_average_pooling2d_11  (None, 1280)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_22 (Dense)            (None, 1024)              1311744   
                                                                 
 batch_normalization_312 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_11 (Dropout)        (None, 1024)              0         
                                                                 
 activation_308 (Activation)  (None, 1024)             0         
                                                                 
 dense_23 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 3,575,874
Trainable params: 1,315,842
Non-trainable params: 2,260,032
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\MobileNetV2_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_11"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 mobilenetv2_1.00_224 (Funct  (None, 6, 7, 1280)       2257984   
 ional)                                                          
                                                                 
 global_average_pooling2d_11  (None, 1280)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_22 (Dense)            (None, 1024)              1311744   
                                                                 
 batch_normalization_312 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_11 (Dropout)        (None, 1024)              0         
                                                                 
 activation_308 (Activation)  (None, 1024)             0         
                                                                 
 dense_23 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 3,575,874
Trainable params: 3,539,714
Non-trainable params: 36,160
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 981s - loss: 0.4802 - accuracy: 0.8598 - val_loss: 3.8938 - val_accuracy: 0.5000 - 981s/epoch - 8s/step
Epoch 2/1000
124/124 - 30s - loss: 0.7277 - accuracy: 0.7724 - val_loss: 7.6221 - val_accuracy: 0.5000 - 30s/epoch - 245ms/step
Epoch 3/1000
124/124 - 30s - loss: 0.6801 - accuracy: 0.7942 - val_loss: 8.3176 - val_accuracy: 0.5000 - 30s/epoch - 246ms/step
Epoch 4/1000
124/124 - 32s - loss: 0.7715 - accuracy: 0.7213 - val_loss: 11.9018 - val_accuracy: 0.5000 - 32s/epoch - 262ms/step
Epoch 5/1000
124/124 - 32s - loss: 0.6226 - accuracy: 0.7170 - val_loss: 8.6339 - val_accuracy: 0.5000 - 32s/epoch - 262ms/step
Epoch 6/1000
124/124 - 33s - loss: 0.7002 - accuracy: 0.8107 - val_loss: 16.9384 - val_accuracy: 0.5000 - 33s/epoch - 265ms/step
Epoch 7/1000
124/124 - 30s - loss: 0.7215 - accuracy: 0.6912 - val_loss: 6.6855 - val_accuracy: 0.4994 - 30s/epoch - 245ms/step
Epoch 8/1000
124/124 - 31s - loss: 0.7289 - accuracy: 0.6928 - val_loss: 5.8432 - val_accuracy: 0.5000 - 31s/epoch - 246ms/step
Epoch 9/1000
124/124 - 31s - loss: 0.7385 - accuracy: 0.6061 - val_loss: 16.9808 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 10/1000
124/124 - 31s - loss: 0.9460 - accuracy: 0.5794 - val_loss: 15.1678 - val_accuracy: 0.5000 - 31s/epoch - 248ms/step
Epoch 11/1000
124/124 - 30s - loss: 0.7199 - accuracy: 0.5953 - val_loss: 22.7311 - val_accuracy: 0.5000 - 30s/epoch - 244ms/step
Epoch 12/1000
124/124 - 30s - loss: 0.6223 - accuracy: 0.7269 - val_loss: 8.4451 - val_accuracy: 0.5010 - 30s/epoch - 244ms/step
Epoch 13/1000
124/124 - 31s - loss: 0.6121 - accuracy: 0.7054 - val_loss: 2.1458 - val_accuracy: 0.4879 - 31s/epoch - 249ms/step
Epoch 14/1000
124/124 - 31s - loss: 0.7173 - accuracy: 0.6580 - val_loss: 12.2510 - val_accuracy: 0.5000 - 31s/epoch - 250ms/step
Epoch 15/1000
124/124 - 32s - loss: 0.8093 - accuracy: 0.6625 - val_loss: 23.9325 - val_accuracy: 0.5000 - 32s/epoch - 261ms/step
Epoch 16/1000
124/124 - 32s - loss: 0.6200 - accuracy: 0.7052 - val_loss: 5.7861 - val_accuracy: 0.5000 - 32s/epoch - 261ms/step
Epoch 17/1000
124/124 - 31s - loss: 0.6900 - accuracy: 0.6600 - val_loss: 25.9932 - val_accuracy: 0.5000 - 31s/epoch - 250ms/step
Epoch 18/1000
124/124 - 30s - loss: 0.8700 - accuracy: 0.6981 - val_loss: 19.0127 - val_accuracy: 0.5000 - 30s/epoch - 243ms/step
Epoch 19/1000
124/124 - 31s - loss: 0.9725 - accuracy: 0.5855 - val_loss: 19.4351 - val_accuracy: 0.5000 - 31s/epoch - 246ms/step
Epoch 20/1000
124/124 - 31s - loss: 0.7072 - accuracy: 0.6555 - val_loss: 21.2322 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 21/1000
124/124 - 31s - loss: 0.4845 - accuracy: 0.8585 - val_loss: 0.8352 - val_accuracy: 0.4873 - 31s/epoch - 247ms/step
Epoch 22/1000
124/124 - 31s - loss: 0.6174 - accuracy: 0.7906 - val_loss: 7.6386 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 23/1000
124/124 - 30s - loss: 0.6139 - accuracy: 0.7977 - val_loss: 7.4447 - val_accuracy: 0.5000 - 30s/epoch - 244ms/step
Epoch 24/1000
124/124 - 31s - loss: 0.4522 - accuracy: 0.8404 - val_loss: 133.4132 - val_accuracy: 0.5000 - 31s/epoch - 246ms/step
Epoch 25/1000
124/124 - 33s - loss: 0.2946 - accuracy: 0.9050 - val_loss: 74.7403 - val_accuracy: 0.5000 - 33s/epoch - 262ms/step
Epoch 26/1000
124/124 - 32s - loss: 0.3268 - accuracy: 0.8831 - val_loss: 21.5473 - val_accuracy: 0.5000 - 32s/epoch - 262ms/step
Epoch 27/1000
124/124 - 32s - loss: 0.7247 - accuracy: 0.7686 - val_loss: 2.9300 - val_accuracy: 0.4400 - 32s/epoch - 259ms/step
Epoch 28/1000
124/124 - 31s - loss: 0.4431 - accuracy: 0.8013 - val_loss: 21.0107 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 29/1000
124/124 - 30s - loss: 0.4448 - accuracy: 0.7842 - val_loss: 0.8375 - val_accuracy: 0.5000 - 30s/epoch - 242ms/step
Epoch 30/1000
124/124 - 31s - loss: 0.6386 - accuracy: 0.5011 - val_loss: 0.8274 - val_accuracy: 0.5054 - 31s/epoch - 254ms/step
Epoch 31/1000
124/124 - 30s - loss: 0.4303 - accuracy: 0.8671 - val_loss: 1.9231 - val_accuracy: 0.5000 - 30s/epoch - 243ms/step
Epoch 32/1000
124/124 - 31s - loss: 0.5041 - accuracy: 0.7911 - val_loss: 0.7415 - val_accuracy: 0.5003 - 31s/epoch - 251ms/step
Epoch 33/1000
124/124 - 31s - loss: 0.6424 - accuracy: 0.7402 - val_loss: 23.0870 - val_accuracy: 0.5000 - 31s/epoch - 246ms/step
Epoch 34/1000
124/124 - 31s - loss: 0.4365 - accuracy: 0.8499 - val_loss: 17.5246 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 35/1000
124/124 - 32s - loss: 0.3974 - accuracy: 0.7823 - val_loss: 32.5585 - val_accuracy: 0.5000 - 32s/epoch - 260ms/step
Epoch 36/1000
124/124 - 33s - loss: 0.6024 - accuracy: 0.4998 - val_loss: 54.2479 - val_accuracy: 0.5000 - 33s/epoch - 266ms/step
Epoch 37/1000
124/124 - 33s - loss: 0.5012 - accuracy: 0.8201 - val_loss: 23.7087 - val_accuracy: 0.5000 - 33s/epoch - 268ms/step
Epoch 38/1000
124/124 - 31s - loss: 0.4968 - accuracy: 0.8170 - val_loss: 16.8939 - val_accuracy: 0.5000 - 31s/epoch - 248ms/step
Epoch 39/1000
124/124 - 31s - loss: 0.5813 - accuracy: 0.7624 - val_loss: 36.5698 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 40/1000
124/124 - 31s - loss: 0.7228 - accuracy: 0.6434 - val_loss: 10.2136 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 41/1000
124/124 - 31s - loss: 0.5948 - accuracy: 0.7910 - val_loss: 63.1174 - val_accuracy: 0.5000 - 31s/epoch - 246ms/step
Epoch 42/1000
124/124 - 31s - loss: 0.6114 - accuracy: 0.7465 - val_loss: 54.2043 - val_accuracy: 0.5000 - 31s/epoch - 246ms/step
Epoch 43/1000
124/124 - 31s - loss: 0.7957 - accuracy: 0.4615 - val_loss: 3.7677 - val_accuracy: 0.5000 - 31s/epoch - 248ms/step
Epoch 44/1000
124/124 - 31s - loss: 0.6426 - accuracy: 0.4704 - val_loss: 2.2320 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 45/1000
124/124 - 31s - loss: 0.5872 - accuracy: 0.7723 - val_loss: 1.5237 - val_accuracy: 0.5000 - 31s/epoch - 249ms/step
Epoch 46/1000
124/124 - 32s - loss: 0.4437 - accuracy: 0.8612 - val_loss: 11.6333 - val_accuracy: 0.5000 - 32s/epoch - 257ms/step
Epoch 47/1000
124/124 - 33s - loss: 0.4892 - accuracy: 0.5778 - val_loss: 1.5316 - val_accuracy: 0.5000 - 33s/epoch - 262ms/step
Epoch 48/1000
124/124 - 31s - loss: 0.4914 - accuracy: 0.8450 - val_loss: 8.1529 - val_accuracy: 0.5000 - 31s/epoch - 251ms/step
Epoch 49/1000
124/124 - 31s - loss: 0.3570 - accuracy: 0.8263 - val_loss: 6.5870 - val_accuracy: 0.5000 - 31s/epoch - 247ms/step
Epoch 50/1000
124/124 - 30s - loss: 0.5744 - accuracy: 0.8029 - val_loss: 24.2673 - val_accuracy: 0.5000 - 30s/epoch - 244ms/step
2021-11-19 20:51:15.911418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 20:51:15.911467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 20:54:11.286561: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 942 of 1024
2021-11-19 20:54:12.067833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 21:07:42.616025: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 590 of 1024
2021-11-19 21:07:49.503994: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'InceptionV3_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'InceptionV3', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\InceptionV3_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_12"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inception_v3 (Functional)   (None, 3, 5, 2048)        21802784  
                                                                 
 global_average_pooling2d_12  (None, 2048)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_24 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_407 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_12 (Dropout)        (None, 1024)              0         
                                                                 
 activation_403 (Activation)  (None, 1024)             0         
                                                                 
 dense_25 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 23,907,106
Trainable params: 2,102,274
Non-trainable params: 21,804,832
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\InceptionV3_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_12"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inception_v3 (Functional)   (None, 3, 5, 2048)        21802784  
                                                                 
 global_average_pooling2d_12  (None, 2048)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_24 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_407 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_12 (Dropout)        (None, 1024)              0         
                                                                 
 activation_403 (Activation)  (None, 1024)             0         
                                                                 
 dense_25 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 23,907,106
Trainable params: 23,870,626
Non-trainable params: 36,480
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 908s - loss: 0.2958 - accuracy: 0.8904 - val_loss: 1.1722 - val_accuracy: 0.4698 - 908s/epoch - 7s/step
Epoch 2/1000
124/124 - 46s - loss: 0.3730 - accuracy: 0.9034 - val_loss: 1.0745 - val_accuracy: 0.5000 - 46s/epoch - 370ms/step
Epoch 3/1000
124/124 - 48s - loss: 0.3870 - accuracy: 0.8795 - val_loss: 0.8383 - val_accuracy: 0.5000 - 48s/epoch - 386ms/step
Epoch 4/1000
124/124 - 46s - loss: 0.6533 - accuracy: 0.5898 - val_loss: 0.9339 - val_accuracy: 0.4590 - 46s/epoch - 368ms/step
Epoch 5/1000
124/124 - 44s - loss: 0.5163 - accuracy: 0.7540 - val_loss: 1.5287 - val_accuracy: 0.5000 - 44s/epoch - 356ms/step
Epoch 6/1000
124/124 - 45s - loss: 0.5448 - accuracy: 0.8690 - val_loss: 0.8247 - val_accuracy: 0.5000 - 45s/epoch - 364ms/step
Epoch 7/1000
124/124 - 44s - loss: 0.6614 - accuracy: 0.5348 - val_loss: 0.7105 - val_accuracy: 0.5000 - 44s/epoch - 355ms/step
Epoch 8/1000
124/124 - 45s - loss: 0.6737 - accuracy: 0.6144 - val_loss: 0.7013 - val_accuracy: 0.5000 - 45s/epoch - 365ms/step
Epoch 9/1000
124/124 - 44s - loss: 0.5258 - accuracy: 0.7568 - val_loss: 0.9521 - val_accuracy: 0.4778 - 44s/epoch - 356ms/step
Epoch 10/1000
124/124 - 47s - loss: 0.6806 - accuracy: 0.6159 - val_loss: 0.7478 - val_accuracy: 0.5000 - 47s/epoch - 379ms/step
Epoch 11/1000
124/124 - 46s - loss: 0.4757 - accuracy: 0.7913 - val_loss: 0.8820 - val_accuracy: 0.5000 - 46s/epoch - 373ms/step
Epoch 12/1000
124/124 - 44s - loss: 0.4462 - accuracy: 0.8661 - val_loss: 1.6735 - val_accuracy: 0.4863 - 44s/epoch - 356ms/step
Epoch 13/1000
124/124 - 44s - loss: 0.5863 - accuracy: 0.8092 - val_loss: 16.2654 - val_accuracy: 0.5000 - 44s/epoch - 359ms/step
Epoch 14/1000
124/124 - 45s - loss: 0.5602 - accuracy: 0.7603 - val_loss: 0.7445 - val_accuracy: 0.5000 - 45s/epoch - 360ms/step
Epoch 15/1000
124/124 - 46s - loss: 0.7242 - accuracy: 0.7651 - val_loss: 0.7005 - val_accuracy: 0.4651 - 46s/epoch - 368ms/step
Epoch 16/1000
124/124 - 44s - loss: 0.7264 - accuracy: 0.5319 - val_loss: 0.9810 - val_accuracy: 0.4619 - 44s/epoch - 358ms/step
Epoch 17/1000
124/124 - 46s - loss: 0.4905 - accuracy: 0.7609 - val_loss: 0.6944 - val_accuracy: 0.4540 - 46s/epoch - 370ms/step
Epoch 18/1000
124/124 - 47s - loss: 0.7376 - accuracy: 0.6416 - val_loss: 1.1003 - val_accuracy: 0.4987 - 47s/epoch - 377ms/step
Epoch 19/1000
124/124 - 45s - loss: 0.7715 - accuracy: 0.3830 - val_loss: 0.6925 - val_accuracy: 0.5000 - 45s/epoch - 365ms/step
Epoch 20/1000
124/124 - 44s - loss: 0.4385 - accuracy: 0.8240 - val_loss: 0.9507 - val_accuracy: 0.5000 - 44s/epoch - 355ms/step
Epoch 21/1000
124/124 - 44s - loss: 0.7963 - accuracy: 0.6105 - val_loss: 0.7620 - val_accuracy: 0.5000 - 44s/epoch - 358ms/step
Epoch 22/1000
124/124 - 44s - loss: 0.7148 - accuracy: 0.4298 - val_loss: 0.6933 - val_accuracy: 0.5000 - 44s/epoch - 356ms/step
2021-11-19 21:24:28.329635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 21:24:28.329691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 21:31:44.862291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 638 of 1024
2021-11-19 21:31:50.027693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 21:47:59.889978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 450 of 1024
2021-11-19 21:48:09.878909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 886 of 1024
2021-11-19 21:48:13.093510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'InceptionResNetV2_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'InceptionResNetV2', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\InceptionResNetV2_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_13"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inception_resnet_v2 (Functi  (None, 3, 5, 1536)       54336736  
 onal)                                                           
                                                                 
 global_average_pooling2d_13  (None, 1536)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_26 (Dense)            (None, 1024)              1573888   
                                                                 
 batch_normalization_611 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_13 (Dropout)        (None, 1024)              0         
                                                                 
 activation_607 (Activation)  (None, 1024)             0         
                                                                 
 dense_27 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 55,916,770
Trainable params: 1,577,986
Non-trainable params: 54,338,784
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\InceptionResNetV2_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_13"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inception_resnet_v2 (Functi  (None, 3, 5, 1536)       54336736  
 onal)                                                           
                                                                 
 global_average_pooling2d_13  (None, 1536)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_26 (Dense)            (None, 1024)              1573888   
                                                                 
 batch_normalization_611 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_13 (Dropout)        (None, 1024)              0         
                                                                 
 activation_607 (Activation)  (None, 1024)             0         
                                                                 
 dense_27 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 55,916,770
Trainable params: 55,854,178
Non-trainable params: 62,592
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 1175s - loss: 0.2813 - accuracy: 0.8734 - val_loss: 0.7348 - val_accuracy: 0.5102 - 1175s/epoch - 9s/step
Epoch 2/1000
124/124 - 106s - loss: 0.6073 - accuracy: 0.8573 - val_loss: 1.1352 - val_accuracy: 0.5000 - 106s/epoch - 853ms/step
Epoch 3/1000
124/124 - 106s - loss: 0.6083 - accuracy: 0.8046 - val_loss: 1.3957 - val_accuracy: 0.5000 - 106s/epoch - 852ms/step
Epoch 4/1000
124/124 - 106s - loss: 0.6926 - accuracy: 0.6227 - val_loss: 1.0794 - val_accuracy: 0.5000 - 106s/epoch - 858ms/step
Epoch 5/1000
124/124 - 106s - loss: 0.6300 - accuracy: 0.7836 - val_loss: 1.2047 - val_accuracy: 0.4924 - 106s/epoch - 856ms/step
Epoch 6/1000
124/124 - 107s - loss: 0.6823 - accuracy: 0.7432 - val_loss: 0.8147 - val_accuracy: 0.4997 - 107s/epoch - 862ms/step
Epoch 7/1000
124/124 - 107s - loss: 0.8818 - accuracy: 0.3706 - val_loss: 0.7286 - val_accuracy: 0.5000 - 107s/epoch - 867ms/step
Epoch 8/1000
124/124 - 106s - loss: 0.7937 - accuracy: 0.3941 - val_loss: 1.3893 - val_accuracy: 0.5003 - 106s/epoch - 854ms/step
Epoch 9/1000
124/124 - 110s - loss: 0.7459 - accuracy: 0.4619 - val_loss: 0.6975 - val_accuracy: 0.5000 - 110s/epoch - 883ms/step
Epoch 10/1000
124/124 - 107s - loss: 0.2641 - accuracy: 0.9303 - val_loss: 0.9577 - val_accuracy: 0.5000 - 107s/epoch - 862ms/step
Epoch 11/1000
124/124 - 106s - loss: 0.8961 - accuracy: 0.4654 - val_loss: 0.8946 - val_accuracy: 0.5000 - 106s/epoch - 857ms/step
Epoch 12/1000
124/124 - 105s - loss: 0.7996 - accuracy: 0.4101 - val_loss: 0.7079 - val_accuracy: 0.5000 - 105s/epoch - 848ms/step
Epoch 13/1000
124/124 - 106s - loss: 0.7862 - accuracy: 0.4040 - val_loss: 0.7091 - val_accuracy: 0.5000 - 106s/epoch - 858ms/step
Epoch 14/1000
124/124 - 106s - loss: 0.7824 - accuracy: 0.3895 - val_loss: 0.7036 - val_accuracy: 0.5000 - 106s/epoch - 858ms/step
Epoch 15/1000
124/124 - 109s - loss: 0.7766 - accuracy: 0.3885 - val_loss: 12.3029 - val_accuracy: 0.5000 - 109s/epoch - 877ms/step
Epoch 16/1000
124/124 - 107s - loss: 0.6905 - accuracy: 0.5630 - val_loss: 0.8012 - val_accuracy: 0.4390 - 107s/epoch - 865ms/step
Epoch 17/1000
124/124 - 106s - loss: 0.4944 - accuracy: 0.7554 - val_loss: 0.8058 - val_accuracy: 0.5000 - 106s/epoch - 858ms/step
Epoch 18/1000
124/124 - 107s - loss: 0.8274 - accuracy: 0.4582 - val_loss: 0.7088 - val_accuracy: 0.5000 - 107s/epoch - 861ms/step
Epoch 19/1000
124/124 - 106s - loss: 0.7800 - accuracy: 0.4014 - val_loss: 0.6989 - val_accuracy: 0.5000 - 106s/epoch - 851ms/step
Epoch 20/1000
124/124 - 107s - loss: 0.7871 - accuracy: 0.3899 - val_loss: 0.6971 - val_accuracy: 0.5000 - 107s/epoch - 866ms/step
Epoch 21/1000
124/124 - 109s - loss: 0.7638 - accuracy: 0.3948 - val_loss: 0.6963 - val_accuracy: 0.5000 - 109s/epoch - 878ms/step
2021-11-19 22:24:54.124891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 22:24:54.125010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 22:31:59.320063: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 621 of 1024
2021-11-19 22:32:05.282031: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 22:50:05.271391: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 402 of 1024
2021-11-19 22:50:15.272795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 795 of 1024
2021-11-19 22:50:21.293145: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'ResNet50_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'ResNet50', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\ResNet50_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_14"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 6, 7, 2048)        23587712  
                                                                 
 global_average_pooling2d_14  (None, 2048)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_28 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_612 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_14 (Dropout)        (None, 1024)              0         
                                                                 
 activation_608 (Activation)  (None, 1024)             0         
                                                                 
 dense_29 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 25,692,034
Trainable params: 2,102,274
Non-trainable params: 23,589,760
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\ResNet50_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_14"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 6, 7, 2048)        23587712  
                                                                 
 global_average_pooling2d_14  (None, 2048)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_28 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_612 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_14 (Dropout)        (None, 1024)              0         
                                                                 
 activation_608 (Activation)  (None, 1024)             0         
                                                                 
 dense_29 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 25,692,034
Trainable params: 25,636,866
Non-trainable params: 55,168
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 1249s - loss: 0.2583 - accuracy: 0.9294 - val_loss: 1.0611 - val_accuracy: 0.5254 - 1249s/epoch - 10s/step
Epoch 2/1000
124/124 - 48s - loss: 0.3545 - accuracy: 0.9041 - val_loss: nan - val_accuracy: 0.4994 - 48s/epoch - 385ms/step
Epoch 3/1000
124/124 - 48s - loss: 0.5282 - accuracy: 0.8960 - val_loss: 3.6887 - val_accuracy: 0.5302 - 48s/epoch - 390ms/step
Epoch 4/1000
124/124 - 48s - loss: 0.5770 - accuracy: 0.8160 - val_loss: 0.9819 - val_accuracy: 0.4873 - 48s/epoch - 390ms/step
Epoch 5/1000
124/124 - 48s - loss: 0.7297 - accuracy: 0.7174 - val_loss: 1.3920 - val_accuracy: 0.4987 - 48s/epoch - 387ms/step
Epoch 6/1000
124/124 - 48s - loss: 0.6678 - accuracy: 0.6902 - val_loss: 0.8028 - val_accuracy: 0.5000 - 48s/epoch - 390ms/step
Epoch 7/1000
124/124 - 49s - loss: 0.5080 - accuracy: 0.7912 - val_loss: 0.6941 - val_accuracy: 0.5000 - 49s/epoch - 392ms/step
Epoch 8/1000
124/124 - 48s - loss: 0.4511 - accuracy: 0.8686 - val_loss: 0.6967 - val_accuracy: 0.4949 - 48s/epoch - 387ms/step
Epoch 9/1000
124/124 - 48s - loss: 0.5557 - accuracy: 0.7804 - val_loss: 0.7762 - val_accuracy: 0.5000 - 48s/epoch - 385ms/step
Epoch 10/1000
124/124 - 48s - loss: 0.8865 - accuracy: 0.4018 - val_loss: 112.2160 - val_accuracy: 0.5000 - 48s/epoch - 389ms/step
Epoch 11/1000
124/124 - 48s - loss: 0.6608 - accuracy: 0.5777 - val_loss: 3.1357 - val_accuracy: 0.5127 - 48s/epoch - 390ms/step
Epoch 12/1000
124/124 - 48s - loss: 0.5879 - accuracy: 0.7158 - val_loss: 0.6925 - val_accuracy: 0.5213 - 48s/epoch - 389ms/step
Epoch 13/1000
124/124 - 48s - loss: 0.6025 - accuracy: 0.6339 - val_loss: 0.8124 - val_accuracy: 0.5000 - 48s/epoch - 386ms/step
Epoch 14/1000
124/124 - 48s - loss: 0.8151 - accuracy: 0.5294 - val_loss: 1.8097 - val_accuracy: 0.5000 - 48s/epoch - 387ms/step
Epoch 15/1000
124/124 - 48s - loss: 0.7120 - accuracy: 0.5609 - val_loss: 4.4405 - val_accuracy: 0.5000 - 48s/epoch - 387ms/step
Epoch 16/1000
124/124 - 48s - loss: 0.8231 - accuracy: 0.3672 - val_loss: 0.8912 - val_accuracy: 0.5000 - 48s/epoch - 390ms/step
Epoch 17/1000
124/124 - 48s - loss: 0.7679 - accuracy: 0.3815 - val_loss: 0.6949 - val_accuracy: 0.5000 - 48s/epoch - 387ms/step
Epoch 18/1000
124/124 - 48s - loss: 0.7006 - accuracy: 0.4291 - val_loss: 0.7953 - val_accuracy: 0.5000 - 48s/epoch - 384ms/step
Epoch 19/1000
124/124 - 48s - loss: 0.7300 - accuracy: 0.6369 - val_loss: 2.9961 - val_accuracy: 0.5003 - 48s/epoch - 385ms/step
Epoch 20/1000
124/124 - 48s - loss: 0.8072 - accuracy: 0.5632 - val_loss: 9.1737 - val_accuracy: 0.5000 - 48s/epoch - 388ms/step
Epoch 21/1000
124/124 - 48s - loss: 0.6580 - accuracy: 0.5649 - val_loss: 0.6989 - val_accuracy: 0.5000 - 48s/epoch - 385ms/step
Epoch 22/1000
124/124 - 48s - loss: 0.7186 - accuracy: 0.4761 - val_loss: 0.7361 - val_accuracy: 0.5000 - 48s/epoch - 391ms/step
Epoch 23/1000
124/124 - 48s - loss: 0.8463 - accuracy: 0.4513 - val_loss: 0.7298 - val_accuracy: 0.4994 - 48s/epoch - 387ms/step
2021-11-19 23:09:08.021111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-19 23:09:08.021179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-19 23:14:13.471001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 169 of 1024
2021-11-19 23:14:23.531343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 374 of 1024
2021-11-19 23:14:33.512595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 569 of 1024
2021-11-19 23:14:43.595192: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 765 of 1024
2021-11-19 23:14:53.578203: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 956 of 1024
2021-11-19 23:14:57.352353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-19 23:47:37.205846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 262 of 1024
2021-11-19 23:47:47.213939: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 526 of 1024
2021-11-19 23:47:57.224072: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 772 of 1024
2021-11-19 23:48:07.186361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'VGG19_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'VGG19', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\VGG19_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_15"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 vgg19 (Functional)          (None, 5, 7, 512)         20024384  
                                                                 
 global_average_pooling2d_15  (None, 512)              0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_30 (Dense)            (None, 1024)              525312    
                                                                 
 batch_normalization_613 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_15 (Dropout)        (None, 1024)              0         
                                                                 
 activation_609 (Activation)  (None, 1024)             0         
                                                                 
 dense_31 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 20,555,842
Trainable params: 529,410
Non-trainable params: 20,026,432
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\VGG19_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_15"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 vgg19 (Functional)          (None, 5, 7, 512)         20024384  
                                                                 
 global_average_pooling2d_15  (None, 512)              0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_30 (Dense)            (None, 1024)              525312    
                                                                 
 batch_normalization_613 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_15 (Dropout)        (None, 1024)              0         
                                                                 
 activation_609 (Activation)  (None, 1024)             0         
                                                                 
 dense_31 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 20,555,842
Trainable params: 20,553,794
Non-trainable params: 2,048
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 2140s - loss: nan - accuracy: 0.5234 - val_loss: nan - val_accuracy: 0.5000 - 2140s/epoch - 17s/step
Epoch 2/1000
124/124 - 55s - loss: nan - accuracy: 0.4980 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 441ms/step
Epoch 3/1000
124/124 - 55s - loss: nan - accuracy: 0.5009 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 442ms/step
Epoch 4/1000
124/124 - 55s - loss: nan - accuracy: 0.4979 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 5/1000
124/124 - 55s - loss: nan - accuracy: 0.4980 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 445ms/step
Epoch 6/1000
124/124 - 55s - loss: nan - accuracy: 0.4978 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 441ms/step
Epoch 7/1000
124/124 - 55s - loss: nan - accuracy: 0.4978 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 445ms/step
Epoch 8/1000
124/124 - 55s - loss: nan - accuracy: 0.5007 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 446ms/step
Epoch 9/1000
124/124 - 55s - loss: nan - accuracy: 0.4977 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 445ms/step
Epoch 10/1000
124/124 - 55s - loss: nan - accuracy: 0.4978 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 447ms/step
Epoch 11/1000
124/124 - 55s - loss: nan - accuracy: 0.5007 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 12/1000
124/124 - 55s - loss: nan - accuracy: 0.4965 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 13/1000
124/124 - 55s - loss: nan - accuracy: 0.5010 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 14/1000
124/124 - 55s - loss: nan - accuracy: 0.5000 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 446ms/step
Epoch 15/1000
124/124 - 55s - loss: nan - accuracy: 0.5032 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 444ms/step
Epoch 16/1000
124/124 - 55s - loss: nan - accuracy: 0.4979 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 17/1000
124/124 - 55s - loss: nan - accuracy: 0.4976 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 18/1000
124/124 - 55s - loss: nan - accuracy: 0.5013 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 444ms/step
Epoch 19/1000
124/124 - 55s - loss: nan - accuracy: 0.4977 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 20/1000
124/124 - 55s - loss: nan - accuracy: 0.4979 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
Epoch 21/1000
124/124 - 55s - loss: nan - accuracy: 0.4978 - val_loss: nan - val_accuracy: 0.5000 - 55s/epoch - 443ms/step
2021-11-20 00:08:08.104659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-20 00:08:08.104784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-20 00:16:46.342801: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 513 of 1024
2021-11-20 00:16:54.909984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-20 00:33:45.659315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 568 of 1024
2021-11-20 00:33:53.462627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'Xception_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'Xception', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\Xception_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_16"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 xception (Functional)       (None, 6, 7, 2048)        20861480  
                                                                 
 global_average_pooling2d_16  (None, 2048)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_32 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_618 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_16 (Dropout)        (None, 1024)              0         
                                                                 
 activation_610 (Activation)  (None, 1024)             0         
                                                                 
 dense_33 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 22,965,802
Trainable params: 2,102,274
Non-trainable params: 20,863,528
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\Xception_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_16"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 xception (Functional)       (None, 6, 7, 2048)        20861480  
                                                                 
 global_average_pooling2d_16  (None, 2048)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_32 (Dense)            (None, 1024)              2098176   
                                                                 
 batch_normalization_618 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_16 (Dropout)        (None, 1024)              0         
                                                                 
 activation_610 (Activation)  (None, 1024)             0         
                                                                 
 dense_33 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 22,965,802
Trainable params: 22,909,226
Non-trainable params: 56,576
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 1164s - loss: 0.2946 - accuracy: 0.9025 - val_loss: 1.1636 - val_accuracy: 0.4927 - 1164s/epoch - 9s/step
Epoch 2/1000
124/124 - 47s - loss: 0.5980 - accuracy: 0.7578 - val_loss: 0.7950 - val_accuracy: 0.4978 - 47s/epoch - 379ms/step
Epoch 3/1000
124/124 - 46s - loss: 0.7387 - accuracy: 0.6632 - val_loss: 0.7048 - val_accuracy: 0.5000 - 46s/epoch - 374ms/step
Epoch 4/1000
124/124 - 47s - loss: 0.3025 - accuracy: 0.8719 - val_loss: 0.8549 - val_accuracy: 0.4994 - 47s/epoch - 377ms/step
Epoch 5/1000
124/124 - 47s - loss: 0.7238 - accuracy: 0.6785 - val_loss: 0.7251 - val_accuracy: 0.4978 - 47s/epoch - 379ms/step
Epoch 6/1000
124/124 - 47s - loss: 0.5105 - accuracy: 0.7689 - val_loss: 0.6830 - val_accuracy: 0.5419 - 47s/epoch - 381ms/step
Epoch 7/1000
124/124 - 47s - loss: 0.7469 - accuracy: 0.4566 - val_loss: 0.6933 - val_accuracy: 0.5000 - 47s/epoch - 376ms/step
Epoch 8/1000
124/124 - 47s - loss: 0.6967 - accuracy: 0.5156 - val_loss: 0.6932 - val_accuracy: 0.5000 - 47s/epoch - 379ms/step
Epoch 9/1000
124/124 - 47s - loss: 0.7735 - accuracy: 0.4259 - val_loss: 0.6949 - val_accuracy: 0.5000 - 47s/epoch - 376ms/step
Epoch 10/1000
124/124 - 47s - loss: 0.7974 - accuracy: 0.4777 - val_loss: 0.6944 - val_accuracy: 0.5000 - 47s/epoch - 376ms/step
Epoch 11/1000
124/124 - 47s - loss: 0.7757 - accuracy: 0.4448 - val_loss: 0.6942 - val_accuracy: 0.5000 - 47s/epoch - 376ms/step
Epoch 12/1000
124/124 - 46s - loss: 0.7897 - accuracy: 0.3967 - val_loss: 0.7017 - val_accuracy: 0.5000 - 46s/epoch - 374ms/step
Epoch 13/1000
124/124 - 46s - loss: 0.4830 - accuracy: 0.7371 - val_loss: 0.7409 - val_accuracy: 0.4997 - 46s/epoch - 375ms/step
Epoch 14/1000
124/124 - 47s - loss: 0.5706 - accuracy: 0.7036 - val_loss: 0.7051 - val_accuracy: 0.5000 - 47s/epoch - 376ms/step
Epoch 15/1000
124/124 - 46s - loss: 0.5951 - accuracy: 0.7060 - val_loss: 0.7269 - val_accuracy: 0.5000 - 46s/epoch - 368ms/step
Epoch 16/1000
124/124 - 46s - loss: 0.4901 - accuracy: 0.6998 - val_loss: 0.7466 - val_accuracy: 0.5000 - 46s/epoch - 374ms/step
Epoch 17/1000
124/124 - 46s - loss: 0.7661 - accuracy: 0.5648 - val_loss: 1.5135 - val_accuracy: 0.4940 - 46s/epoch - 369ms/step
Epoch 18/1000
124/124 - 46s - loss: 0.5459 - accuracy: 0.7640 - val_loss: 50.6630 - val_accuracy: 0.4825 - 46s/epoch - 370ms/step
Epoch 19/1000
124/124 - 45s - loss: 0.6893 - accuracy: 0.5052 - val_loss: 0.7314 - val_accuracy: 0.4975 - 45s/epoch - 367ms/step
Epoch 20/1000
124/124 - 46s - loss: 0.5980 - accuracy: 0.7017 - val_loss: 1.4966 - val_accuracy: 0.4997 - 46s/epoch - 369ms/step
Epoch 21/1000
124/124 - 45s - loss: 0.7693 - accuracy: 0.5786 - val_loss: 0.7003 - val_accuracy: 0.5003 - 45s/epoch - 364ms/step
Epoch 22/1000
124/124 - 45s - loss: 0.7603 - accuracy: 0.6166 - val_loss: 24.3599 - val_accuracy: 0.5013 - 45s/epoch - 365ms/step
Epoch 23/1000
124/124 - 46s - loss: 0.7794 - accuracy: 0.4678 - val_loss: 0.7205 - val_accuracy: 0.5000 - 46s/epoch - 371ms/step
Epoch 24/1000
124/124 - 45s - loss: 0.7700 - accuracy: 0.5028 - val_loss: 0.7366 - val_accuracy: 0.5000 - 45s/epoch - 365ms/step
Epoch 25/1000
124/124 - 46s - loss: 0.8262 - accuracy: 0.4817 - val_loss: 0.7049 - val_accuracy: 0.5000 - 46s/epoch - 368ms/step
Epoch 26/1000
124/124 - 46s - loss: 0.6280 - accuracy: 0.5986 - val_loss: 0.7587 - val_accuracy: 0.4987 - 46s/epoch - 369ms/step
2021-11-20 00:53:58.915856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22057 MB memory:  -> device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5
2021-11-20 00:53:58.915907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22057 MB memory:  -> device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5
2021-11-20 00:56:52.311864: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 761 of 1024
2021-11-20 00:56:55.179436: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
2021-11-20 01:12:28.574560: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:380] Filling up shuffle buffer (this may take a while): 539 of 1024
2021-11-20 01:12:36.960551: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:405] Shuffle buffer filled.
Running... {'run_id': 'EfficientNetB0_Notredame_band_aug_gender_finetuned_F50M50', 'model': 'EfficientNetB0', 'mixed_precision': True, 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'viz_method': 'gen_data', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F50M50', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 1024, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-ndiris\\checkpoints\\EfficientNetB0_Notredame_band_aug_gender_base_F50M50.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'band', 'image_height': 168, 'image_width': 224, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\nd-iris\\train.tfrecord', 'eval_dir': 'F:\\Lab\\datasets\\nd-iris\\test.tfrecord', 'labels': 'F:\\Lab\\nfs\\base-notredame\\nir_labels_', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_17"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb0 (Functional)  (None, 6, 7, 1280)       4049571   
                                                                 
 global_average_pooling2d_17  (None, 1280)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_34 (Dense)            (None, 1024)              1311744   
                                                                 
 batch_normalization_619 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_17 (Dropout)        (None, 1024)              0         
                                                                 
 activation_611 (Activation)  (None, 1024)             0         
                                                                 
 dense_35 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 5,367,461
Trainable params: 1,315,842
Non-trainable params: 4,051,619
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-ndiris\checkpoints\EfficientNetB0_Notredame_band_aug_gender_base_F50M50.hdf5
Model: "sequential_17"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb0 (Functional)  (None, 6, 7, 1280)       4049571   
                                                                 
 global_average_pooling2d_17  (None, 1280)             0         
  (GlobalAveragePooling2D)                                       
                                                                 
 dense_34 (Dense)            (None, 1024)              1311744   
                                                                 
 batch_normalization_619 (Ba  (None, 1024)             4096      
 tchNormalization)                                               
                                                                 
 dropout_17 (Dropout)        (None, 1024)              0         
                                                                 
 activation_611 (Activation)  (None, 1024)             0         
                                                                 
 dense_35 (Dense)            (None, 2)                 2050      
                                                                 
=================================================================
Total params: 5,367,461
Trainable params: 5,323,390
Non-trainable params: 44,071
_________________________________________________________________
Image shape:  (168, 224, 3)
Label:  1
Image shape:  (168, 224, 3)
Label:  1
Epoch 1/1000
124/124 - 1032s - loss: 0.5229 - accuracy: 0.8666 - val_loss: 1.9475 - val_accuracy: 0.5000 - 1032s/epoch - 8s/step
Epoch 2/1000
124/124 - 47s - loss: 0.8867 - accuracy: 0.6663 - val_loss: 1.4107 - val_accuracy: 0.4990 - 47s/epoch - 381ms/step
Epoch 3/1000
124/124 - 49s - loss: 0.7345 - accuracy: 0.5521 - val_loss: 0.9603 - val_accuracy: 0.4994 - 49s/epoch - 391ms/step
Epoch 4/1000
124/124 - 48s - loss: 0.8800 - accuracy: 0.4378 - val_loss: 0.6941 - val_accuracy: 0.5000 - 48s/epoch - 386ms/step
Epoch 5/1000
124/124 - 47s - loss: 0.7271 - accuracy: 0.4795 - val_loss: 0.6994 - val_accuracy: 0.5000 - 47s/epoch - 381ms/step
Epoch 6/1000
124/124 - 47s - loss: 0.5331 - accuracy: 0.6556 - val_loss: 0.7208 - val_accuracy: 0.5000 - 47s/epoch - 382ms/step
Epoch 7/1000
124/124 - 48s - loss: 0.6377 - accuracy: 0.7091 - val_loss: 0.7706 - val_accuracy: 0.4997 - 48s/epoch - 385ms/step
Epoch 8/1000
124/124 - 48s - loss: 0.6433 - accuracy: 0.7415 - val_loss: 0.6870 - val_accuracy: 0.5083 - 48s/epoch - 390ms/step
Epoch 9/1000
124/124 - 48s - loss: 0.7002 - accuracy: 0.7500 - val_loss: 0.8822 - val_accuracy: 0.4987 - 48s/epoch - 387ms/step
Epoch 10/1000
124/124 - 47s - loss: 0.9132 - accuracy: 0.5641 - val_loss: 0.6939 - val_accuracy: 0.4733 - 47s/epoch - 378ms/step
Epoch 11/1000
124/124 - 47s - loss: 0.6901 - accuracy: 0.5813 - val_loss: 0.6993 - val_accuracy: 0.5000 - 47s/epoch - 381ms/step
Epoch 12/1000
124/124 - 48s - loss: 0.7785 - accuracy: 0.4031 - val_loss: 0.6851 - val_accuracy: 0.5000 - 48s/epoch - 389ms/step
Epoch 13/1000
124/124 - 48s - loss: 0.7985 - accuracy: 0.4291 - val_loss: 0.7142 - val_accuracy: 0.5000 - 48s/epoch - 387ms/step
Epoch 14/1000
124/124 - 47s - loss: 0.7848 - accuracy: 0.4050 - val_loss: 0.7014 - val_accuracy: 0.5000 - 47s/epoch - 381ms/step
Epoch 15/1000
124/124 - 48s - loss: 0.5800 - accuracy: 0.6517 - val_loss: 0.7113 - val_accuracy: 0.5000 - 48s/epoch - 384ms/step
Epoch 16/1000
124/124 - 47s - loss: 0.7097 - accuracy: 0.5902 - val_loss: 0.8514 - val_accuracy: 0.5000 - 47s/epoch - 379ms/step
Epoch 17/1000
124/124 - 47s - loss: 0.6374 - accuracy: 0.6519 - val_loss: 1.8165 - val_accuracy: 0.4997 - 47s/epoch - 382ms/step
Epoch 18/1000
124/124 - 47s - loss: 0.6343 - accuracy: 0.6291 - val_loss: 0.7161 - val_accuracy: 0.5006 - 47s/epoch - 382ms/step
Epoch 19/1000
124/124 - 48s - loss: 0.8469 - accuracy: 0.4572 - val_loss: 0.6983 - val_accuracy: 0.5000 - 48s/epoch - 385ms/step
Epoch 20/1000
124/124 - 48s - loss: 0.7720 - accuracy: 0.3759 - val_loss: 0.6961 - val_accuracy: 0.5000 - 48s/epoch - 385ms/step
Epoch 21/1000
124/124 - 47s - loss: 0.6306 - accuracy: 0.5270 - val_loss: 0.7663 - val_accuracy: 0.5032 - 47s/epoch - 382ms/step
Epoch 22/1000
124/124 - 48s - loss: 0.7669 - accuracy: 0.6174 - val_loss: 0.7183 - val_accuracy: 0.5016 - 48s/epoch - 383ms/step
Epoch 23/1000
124/124 - 48s - loss: 0.7073 - accuracy: 0.6311 - val_loss: 1.3811 - val_accuracy: 0.5000 - 48s/epoch - 384ms/step
Epoch 24/1000
124/124 - 47s - loss: 0.7511 - accuracy: 0.5344 - val_loss: 1.1329 - val_accuracy: 0.5000 - 47s/epoch - 382ms/step
Epoch 25/1000
124/124 - 47s - loss: 0.7687 - accuracy: 0.3774 - val_loss: 0.7053 - val_accuracy: 0.5000 - 47s/epoch - 381ms/step
Epoch 26/1000
124/124 - 47s - loss: 0.7615 - accuracy: 0.3783 - val_loss: 0.6967 - val_accuracy: 0.5000 - 47s/epoch - 383ms/step
Epoch 27/1000
124/124 - 48s - loss: 0.7342 - accuracy: 0.4636 - val_loss: 0.7393 - val_accuracy: 0.5000 - 48s/epoch - 383ms/step
Epoch 28/1000
124/124 - 48s - loss: 0.6149 - accuracy: 0.7469 - val_loss: 0.9096 - val_accuracy: 0.5000 - 48s/epoch - 385ms/step
