
(env) F:\Lab\nfs\base-visob>python runner.py 
2021-10-25 10:34:53.572560: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cudart64_110.dll
2021-10-25 10:35:07.350922: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-10-25 10:35:07.361878: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library nvcuda.dll
2021-10-25 10:35:07.911477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:35:07.911527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:35:07.911543: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cudart64_110.dll
2021-10-25 10:35:08.089351: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cublas64_11.dll
2021-10-25 10:35:08.089420: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cublasLt64_11.dll
2021-10-25 10:35:08.774365: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cufft64_10.dll
2021-10-25 10:35:08.824371: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library curand64_10.dll
2021-10-25 10:35:08.929890: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cusolver64_11.dll
2021-10-25 10:35:09.009942: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cusparse64_11.dll
2021-10-25 10:35:09.030058: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cudnn64_8.dll
2021-10-25 10:35:09.030279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 10:35:09.767367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 10:35:09.767404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 10:35:09.767410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 10:35:09.767415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 10:35:09.767602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 10:35:09.769080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:From F:\Lab\nfs\base-visob\main.py:15: The name tf.keras.backend.set_session is deprecated. Please use tf.compat.v1.keras.backend.set_session instead.

2021-10-25 10:35:10.154819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:35:10.154908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:35:10.155125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 10:35:10.156016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:35:10.156095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:35:10.156204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 10:35:10.156408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 10:35:10.156430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 10:35:10.156448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 10:35:10.156464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 10:35:10.156721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 10:35:10.156819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'EfficientNetB4_VISOB_left_aug_gender_base_F75M25', 'model': 'EfficientNetB4', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb4 (Functional)  (None, 5, 8, 1792)        17673823  
_________________________________________________________________
global_average_pooling2d (Gl (None, 1792)              0         
_________________________________________________________________
dense (Dense)                (None, 1024)              1836032   
_________________________________________________________________
batch_normalization (BatchNo (None, 1024)              4096      
_________________________________________________________________
dropout (Dropout)            (None, 1024)              0         
_________________________________________________________________
activation (Activation)      (None, 1024)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 1025      
=================================================================
Total params: 19,514,976
Trainable params: 1,839,105
Non-trainable params: 17,675,871
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0WARNING:tensorflow:From F:\Lab\env\lib\site-packages\tensorflow\python\ops\array_ops.py:5043: calling gather (from tensorflow.python.ops.array_ops) with validate_indices is deprecated and will be removed in a future version.
Instructions for updating:
The `validate_indices` argument has no effect. Indices are always validated on CPU and never validated on GPU.
2021-10-25 10:35:27.089280: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-10-25 10:35:58.240356: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cudnn64_8.dll
2021-10-25 10:35:58.691900: I tensorflow/stream_executor/cuda/cuda_dnn.cc:359] Loaded cuDNN version 8202
2021-10-25 10:35:59.271850: I tensorflow/stream_executor/cuda/cuda_dnn.cc:359] Loaded cuDNN version 8202
2021-10-25 10:35:59.935633: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cublas64_11.dll
2021-10-25 10:36:00.644749: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cublasLt64_11.dll

Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\samsung_day_light_short\\samsung_day_light_short\\enrollments_rgb\\2928_1004_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3413_1008_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\verifications_rgb\\3457_1003_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\3313_1001_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\2916_1005_l_c.png' 1
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 71s - loss: 0.4821 - accuracy: 0.7668 - val_loss: 0.4534 - val_accuracy: 0.7934
Epoch 2/1000
74/74 - 25s - loss: 0.3899 - accuracy: 0.8210 - val_loss: 0.4279 - val_accuracy: 0.8256
Epoch 3/1000
74/74 - 25s - loss: 0.3643 - accuracy: 0.8328 - val_loss: 0.4005 - val_accuracy: 0.8004
Epoch 4/1000
74/74 - 25s - loss: 0.3448 - accuracy: 0.8451 - val_loss: 0.4656 - val_accuracy: 0.7844
Epoch 5/1000
74/74 - 26s - loss: 0.3295 - accuracy: 0.8525 - val_loss: 0.3942 - val_accuracy: 0.8154
Epoch 6/1000
74/74 - 25s - loss: 0.3173 - accuracy: 0.8603 - val_loss: 0.3593 - val_accuracy: 0.8389
Epoch 7/1000
74/74 - 25s - loss: 0.3056 - accuracy: 0.8638 - val_loss: 0.4011 - val_accuracy: 0.8176
Epoch 8/1000
74/74 - 25s - loss: 0.2913 - accuracy: 0.8724 - val_loss: 0.3310 - val_accuracy: 0.8576
Epoch 9/1000
74/74 - 25s - loss: 0.2819 - accuracy: 0.8779 - val_loss: 0.4008 - val_accuracy: 0.8229
Epoch 10/1000
74/74 - 25s - loss: 0.2759 - accuracy: 0.8820 - val_loss: 0.3287 - val_accuracy: 0.8525
Epoch 11/1000
74/74 - 25s - loss: 0.2636 - accuracy: 0.8870 - val_loss: 0.3413 - val_accuracy: 0.8452
Epoch 12/1000
74/74 - 26s - loss: 0.2621 - accuracy: 0.8872 - val_loss: 0.3444 - val_accuracy: 0.8435
Epoch 13/1000
74/74 - 25s - loss: 0.2566 - accuracy: 0.8903 - val_loss: 0.3311 - val_accuracy: 0.8520
Epoch 14/1000
74/74 - 25s - loss: 0.2505 - accuracy: 0.8924 - val_loss: 0.3257 - val_accuracy: 0.8563
Epoch 15/1000
74/74 - 25s - loss: 0.2450 - accuracy: 0.8956 - val_loss: 0.3367 - val_accuracy: 0.8530
Epoch 16/1000
74/74 - 25s - loss: 0.2438 - accuracy: 0.8954 - val_loss: 0.3899 - val_accuracy: 0.8321
Epoch 17/1000
74/74 - 25s - loss: 0.2313 - accuracy: 0.9006 - val_loss: 0.3312 - val_accuracy: 0.8578
Epoch 18/1000
74/74 - 25s - loss: 0.2324 - accuracy: 0.9036 - val_loss: 0.3188 - val_accuracy: 0.8597
Epoch 19/1000
74/74 - 25s - loss: 0.2230 - accuracy: 0.9060 - val_loss: 0.3120 - val_accuracy: 0.8643
Epoch 20/1000
74/74 - 25s - loss: 0.2173 - accuracy: 0.9111 - val_loss: 0.3250 - val_accuracy: 0.8609
Epoch 21/1000
74/74 - 25s - loss: 0.2119 - accuracy: 0.9120 - val_loss: 0.3461 - val_accuracy: 0.8505
Epoch 22/1000
74/74 - 25s - loss: 0.2138 - accuracy: 0.9121 - val_loss: 0.4094 - val_accuracy: 0.8326
Epoch 23/1000
74/74 - 26s - loss: 0.2092 - accuracy: 0.9115 - val_loss: 0.3156 - val_accuracy: 0.8653
Epoch 24/1000
74/74 - 26s - loss: 0.2006 - accuracy: 0.9154 - val_loss: 0.3097 - val_accuracy: 0.8665
Epoch 25/1000
74/74 - 25s - loss: 0.1926 - accuracy: 0.9215 - val_loss: 0.3414 - val_accuracy: 0.8530
Epoch 26/1000
74/74 - 25s - loss: 0.1930 - accuracy: 0.9208 - val_loss: 0.3225 - val_accuracy: 0.8656
Epoch 27/1000
74/74 - 25s - loss: 0.2025 - accuracy: 0.9175 - val_loss: 0.7166 - val_accuracy: 0.7074
Epoch 28/1000
74/74 - 25s - loss: 0.1989 - accuracy: 0.9187 - val_loss: 0.4137 - val_accuracy: 0.8299
Epoch 29/1000
74/74 - 25s - loss: 0.1829 - accuracy: 0.9278 - val_loss: 0.3510 - val_accuracy: 0.8563
Epoch 30/1000
74/74 - 25s - loss: 0.1834 - accuracy: 0.9273 - val_loss: 0.3737 - val_accuracy: 0.8442
Epoch 31/1000
74/74 - 25s - loss: 0.1761 - accuracy: 0.9306 - val_loss: 0.3457 - val_accuracy: 0.8544
Epoch 32/1000
74/74 - 25s - loss: 0.1809 - accuracy: 0.9284 - val_loss: 0.3543 - val_accuracy: 0.8537
Epoch 33/1000
74/74 - 25s - loss: 0.1723 - accuracy: 0.9323 - val_loss: 0.3950 - val_accuracy: 0.8435
Epoch 34/1000
74/74 - 25s - loss: 0.1685 - accuracy: 0.9346 - val_loss: 0.3180 - val_accuracy: 0.8670
Epoch 35/1000
74/74 - 25s - loss: 0.1715 - accuracy: 0.9325 - val_loss: 0.3464 - val_accuracy: 0.8580
Epoch 36/1000
74/74 - 25s - loss: 0.1678 - accuracy: 0.9341 - val_loss: 0.3996 - val_accuracy: 0.8413
Epoch 37/1000
74/74 - 26s - loss: 0.1623 - accuracy: 0.9363 - val_loss: 0.3480 - val_accuracy: 0.8583
Epoch 38/1000
74/74 - 25s - loss: 0.1576 - accuracy: 0.9392 - val_loss: 0.3398 - val_accuracy: 0.8631
Epoch 39/1000
74/74 - 25s - loss: 0.1608 - accuracy: 0.9369 - val_loss: 0.3154 - val_accuracy: 0.8709
Epoch 40/1000
74/74 - 25s - loss: 0.1584 - accuracy: 0.9392 - val_loss: 0.3166 - val_accuracy: 0.8738
Epoch 41/1000
74/74 - 25s - loss: 0.1544 - accuracy: 0.9417 - val_loss: 0.3299 - val_accuracy: 0.8704
Epoch 42/1000
74/74 - 25s - loss: 0.1529 - accuracy: 0.9389 - val_loss: 0.4086 - val_accuracy: 0.8418
Epoch 43/1000
74/74 - 25s - loss: 0.1476 - accuracy: 0.9420 - val_loss: 0.3297 - val_accuracy: 0.8641
Epoch 44/1000
74/74 - 25s - loss: 0.1461 - accuracy: 0.9445 - val_loss: 0.3292 - val_accuracy: 0.8694
2021-10-25 10:55:37.204462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:55:37.204539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 10:55:37.204624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 10:55:37.204765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 10:55:37.204779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 10:55:37.204791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 10:55:37.204803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 10:55:37.205359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 10:55:37.205425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'DenseNet121_VISOB_left_aug_gender_base_F75M25', 'model': 'DenseNet121', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
densenet121 (Functional)     (None, 5, 7, 1024)        7037504   
_________________________________________________________________
global_average_pooling2d_1 ( (None, 1024)              0         
_________________________________________________________________
dense_2 (Dense)              (None, 1024)              1049600   
_________________________________________________________________
batch_normalization_1 (Batch (None, 1024)              4096      
_________________________________________________________________
dropout_1 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_1 (Activation)    (None, 1024)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 1025      
=================================================================
Total params: 8,092,225
Trainable params: 1,052,673
Non-trainable params: 7,039,552
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\3361_1002_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\3412_1002_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_dim_light_short\\samsung_dim_light_short\\enrollments_rgb\\3257_1003_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\verifications_rgb\\3275_1011_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\2957_1007_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 79s - loss: 0.4541 - accuracy: 0.7700 - val_loss: 0.3976 - val_accuracy: 0.8120
Epoch 2/1000
74/74 - 17s - loss: 0.3423 - accuracy: 0.8417 - val_loss: 0.4970 - val_accuracy: 0.7636
Epoch 3/1000
74/74 - 17s - loss: 0.3063 - accuracy: 0.8607 - val_loss: 0.4614 - val_accuracy: 0.7849
Epoch 4/1000
74/74 - 17s - loss: 0.2766 - accuracy: 0.8803 - val_loss: 0.4261 - val_accuracy: 0.8001
Epoch 5/1000
74/74 - 17s - loss: 0.2574 - accuracy: 0.8901 - val_loss: 0.4281 - val_accuracy: 0.8009
Epoch 6/1000
74/74 - 18s - loss: 0.2353 - accuracy: 0.9008 - val_loss: 0.3507 - val_accuracy: 0.8404
Epoch 7/1000
74/74 - 17s - loss: 0.2200 - accuracy: 0.9101 - val_loss: 0.4182 - val_accuracy: 0.8118
Epoch 8/1000
74/74 - 17s - loss: 0.2012 - accuracy: 0.9207 - val_loss: 0.3537 - val_accuracy: 0.8389
Epoch 9/1000
74/74 - 17s - loss: 0.1890 - accuracy: 0.9280 - val_loss: 0.4263 - val_accuracy: 0.8074
Epoch 10/1000
74/74 - 17s - loss: 0.1728 - accuracy: 0.9371 - val_loss: 0.4250 - val_accuracy: 0.8115
Epoch 11/1000
74/74 - 17s - loss: 0.1607 - accuracy: 0.9429 - val_loss: 0.3789 - val_accuracy: 0.8314
Epoch 12/1000
74/74 - 17s - loss: 0.1452 - accuracy: 0.9517 - val_loss: 0.4107 - val_accuracy: 0.8178
Epoch 13/1000
74/74 - 17s - loss: 0.1334 - accuracy: 0.9570 - val_loss: 0.3878 - val_accuracy: 0.8297
Epoch 14/1000
74/74 - 17s - loss: 0.1190 - accuracy: 0.9649 - val_loss: 0.4592 - val_accuracy: 0.8045
Epoch 15/1000
74/74 - 17s - loss: 0.1116 - accuracy: 0.9683 - val_loss: 0.4014 - val_accuracy: 0.8229
Epoch 16/1000
74/74 - 18s - loss: 0.1032 - accuracy: 0.9692 - val_loss: 0.3810 - val_accuracy: 0.8367
Epoch 17/1000
74/74 - 17s - loss: 0.0905 - accuracy: 0.9767 - val_loss: 0.4816 - val_accuracy: 0.8023
Epoch 18/1000
74/74 - 18s - loss: 0.0824 - accuracy: 0.9807 - val_loss: 0.4097 - val_accuracy: 0.8304
Epoch 19/1000
74/74 - 17s - loss: 0.0750 - accuracy: 0.9829 - val_loss: 0.3570 - val_accuracy: 0.8585
Epoch 20/1000
74/74 - 18s - loss: 0.0682 - accuracy: 0.9862 - val_loss: 0.4086 - val_accuracy: 0.8299
Epoch 21/1000
74/74 - 17s - loss: 0.0649 - accuracy: 0.9864 - val_loss: 0.4450 - val_accuracy: 0.8222
Epoch 22/1000
74/74 - 17s - loss: 0.0568 - accuracy: 0.9901 - val_loss: 0.3896 - val_accuracy: 0.8438
Epoch 23/1000
74/74 - 18s - loss: 0.0528 - accuracy: 0.9912 - val_loss: 0.4059 - val_accuracy: 0.8433
Epoch 24/1000
74/74 - 17s - loss: 0.0476 - accuracy: 0.9920 - val_loss: 0.4188 - val_accuracy: 0.8394
Epoch 25/1000
74/74 - 17s - loss: 0.0447 - accuracy: 0.9925 - val_loss: 0.6496 - val_accuracy: 0.7822
Epoch 26/1000
74/74 - 17s - loss: 0.0445 - accuracy: 0.9921 - val_loss: 0.4383 - val_accuracy: 0.8360
2021-10-25 11:04:58.043608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:04:58.043716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:04:58.043846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 11:04:58.044056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 11:04:58.044077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 11:04:58.044095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 11:04:58.044112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 11:04:58.044872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 11:04:58.044970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [96, 128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
Running... {'run_id': 'MobileNetV2_VISOB_left_aug_gender_base_F75M25', 'model': 'MobileNetV2', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
mobilenetv2_1.00_224 (Functi (None, 5, 8, 1280)        2257984   
_________________________________________________________________
global_average_pooling2d_2 ( (None, 1280)              0         
_________________________________________________________________
dense_4 (Dense)              (None, 1024)              1311744   
_________________________________________________________________
batch_normalization_2 (Batch (None, 1024)              4096      
_________________________________________________________________
dropout_2 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_2 (Activation)    (None, 1024)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 1)                 1025      
=================================================================
Total params: 3,574,849
Trainable params: 1,314,817
Non-trainable params: 2,260,032
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\1163_1004_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3283_1005_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\2713_1006_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3200_1002_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\2720_1003_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 71s - loss: 0.5219 - accuracy: 0.7426 - val_loss: 0.3961 - val_accuracy: 0.8081
Epoch 2/1000
74/74 - 10s - loss: 0.3319 - accuracy: 0.8507 - val_loss: 0.4039 - val_accuracy: 0.8115
Epoch 3/1000
74/74 - 10s - loss: 0.2904 - accuracy: 0.8729 - val_loss: 0.3857 - val_accuracy: 0.8120
Epoch 4/1000
74/74 - 10s - loss: 0.2528 - accuracy: 0.8945 - val_loss: 0.3846 - val_accuracy: 0.8205
Epoch 5/1000
74/74 - 10s - loss: 0.2284 - accuracy: 0.9059 - val_loss: 0.3728 - val_accuracy: 0.8229
Epoch 6/1000
74/74 - 10s - loss: 0.2013 - accuracy: 0.9244 - val_loss: 0.3857 - val_accuracy: 0.8215
Epoch 7/1000
74/74 - 10s - loss: 0.1817 - accuracy: 0.9353 - val_loss: 0.3734 - val_accuracy: 0.8287
Epoch 8/1000
74/74 - 10s - loss: 0.1586 - accuracy: 0.9470 - val_loss: 0.3908 - val_accuracy: 0.8270
Epoch 9/1000
74/74 - 10s - loss: 0.1404 - accuracy: 0.9575 - val_loss: 0.3997 - val_accuracy: 0.8215
Epoch 10/1000
74/74 - 10s - loss: 0.1264 - accuracy: 0.9632 - val_loss: 0.4097 - val_accuracy: 0.8241
Epoch 11/1000
74/74 - 10s - loss: 0.1085 - accuracy: 0.9749 - val_loss: 0.4042 - val_accuracy: 0.8304
Epoch 12/1000
74/74 - 10s - loss: 0.0972 - accuracy: 0.9779 - val_loss: 0.4086 - val_accuracy: 0.8229
Epoch 13/1000
74/74 - 10s - loss: 0.0845 - accuracy: 0.9826 - val_loss: 0.4022 - val_accuracy: 0.8312
Epoch 14/1000
74/74 - 10s - loss: 0.0725 - accuracy: 0.9884 - val_loss: 0.4156 - val_accuracy: 0.8302
Epoch 15/1000
74/74 - 10s - loss: 0.0631 - accuracy: 0.9915 - val_loss: 0.4311 - val_accuracy: 0.8273
Epoch 16/1000
74/74 - 10s - loss: 0.0579 - accuracy: 0.9909 - val_loss: 0.4187 - val_accuracy: 0.8324
Epoch 17/1000
74/74 - 10s - loss: 0.0511 - accuracy: 0.9933 - val_loss: 0.5474 - val_accuracy: 0.7960
Epoch 18/1000
74/74 - 10s - loss: 0.0427 - accuracy: 0.9951 - val_loss: 0.4670 - val_accuracy: 0.8241
Epoch 19/1000
74/74 - 10s - loss: 0.0415 - accuracy: 0.9948 - val_loss: 0.5021 - val_accuracy: 0.8171
Epoch 20/1000
74/74 - 10s - loss: 0.0362 - accuracy: 0.9962 - val_loss: 0.4798 - val_accuracy: 0.8268
Epoch 21/1000
74/74 - 10s - loss: 0.0317 - accuracy: 0.9969 - val_loss: 0.4675 - val_accuracy: 0.8297
Epoch 22/1000
74/74 - 10s - loss: 0.0312 - accuracy: 0.9962 - val_loss: 0.4713 - val_accuracy: 0.8295
Epoch 23/1000
74/74 - 10s - loss: 0.0286 - accuracy: 0.9967 - val_loss: 0.4697 - val_accuracy: 0.8345
Epoch 24/1000
74/74 - 10s - loss: 0.0253 - accuracy: 0.9973 - val_loss: 0.4699 - val_accuracy: 0.8307
Epoch 25/1000
74/74 - 11s - loss: 0.0238 - accuracy: 0.9969 - val_loss: 0.4906 - val_accuracy: 0.8316
2021-10-25 11:10:59.907102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:10:59.907144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:10:59.907184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 11:10:59.907249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 11:10:59.907255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 11:10:59.907260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 11:10:59.907265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 11:10:59.907551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 11:10:59.907582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'InceptionV3_VISOB_left_aug_gender_base_F75M25', 'model': 'InceptionV3', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
inception_v3 (Functional)    (None, 3, 6, 2048)        21802784  
_________________________________________________________________
global_average_pooling2d_3 ( (None, 2048)              0         
_________________________________________________________________
dense_6 (Dense)              (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_97 (Batc (None, 1024)              4096      
_________________________________________________________________
dropout_3 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_97 (Activation)   (None, 1024)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 1)                 1025      
=================================================================
Total params: 23,906,081
Trainable params: 2,101,249
Non-trainable params: 21,804,832
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\enrollments_rgb\\3386_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\enrollments_rgb\\3325_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\verifications_rgb\\3278_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\verifications_rgb\\3454_1003_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3215_1003_l_c.png' 1
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 94s - loss: 0.5490 - accuracy: 0.7259 - val_loss: 0.5275 - val_accuracy: 0.7403
Epoch 2/1000
74/74 - 15s - loss: 0.3936 - accuracy: 0.8176 - val_loss: 0.4445 - val_accuracy: 0.7905
Epoch 3/1000
74/74 - 15s - loss: 0.3447 - accuracy: 0.8471 - val_loss: 0.4782 - val_accuracy: 0.7718
Epoch 4/1000
74/74 - 15s - loss: 0.3099 - accuracy: 0.8662 - val_loss: 0.5926 - val_accuracy: 0.7197
Epoch 5/1000
74/74 - 15s - loss: 0.2799 - accuracy: 0.8818 - val_loss: 0.4422 - val_accuracy: 0.8060
Epoch 6/1000
74/74 - 15s - loss: 0.2470 - accuracy: 0.9025 - val_loss: 0.4588 - val_accuracy: 0.7880
Epoch 7/1000
74/74 - 15s - loss: 0.2231 - accuracy: 0.9133 - val_loss: 0.4986 - val_accuracy: 0.7793
Epoch 8/1000
74/74 - 15s - loss: 0.1992 - accuracy: 0.9260 - val_loss: 0.4674 - val_accuracy: 0.7987
Epoch 9/1000
74/74 - 15s - loss: 0.1817 - accuracy: 0.9350 - val_loss: 0.4555 - val_accuracy: 0.7994
Epoch 10/1000
74/74 - 15s - loss: 0.1590 - accuracy: 0.9473 - val_loss: 0.4796 - val_accuracy: 0.8018
Epoch 11/1000
74/74 - 15s - loss: 0.1423 - accuracy: 0.9550 - val_loss: 0.6647 - val_accuracy: 0.7185
Epoch 12/1000
74/74 - 15s - loss: 0.1293 - accuracy: 0.9613 - val_loss: 0.5654 - val_accuracy: 0.7655
Epoch 13/1000
74/74 - 15s - loss: 0.1155 - accuracy: 0.9661 - val_loss: 0.5011 - val_accuracy: 0.8096
Epoch 14/1000
74/74 - 15s - loss: 0.1077 - accuracy: 0.9677 - val_loss: 0.5703 - val_accuracy: 0.8031
Epoch 15/1000
74/74 - 15s - loss: 0.0949 - accuracy: 0.9752 - val_loss: 0.5263 - val_accuracy: 0.8028
Epoch 16/1000
74/74 - 15s - loss: 0.0797 - accuracy: 0.9819 - val_loss: 0.5585 - val_accuracy: 0.8055
Epoch 17/1000
74/74 - 15s - loss: 0.0769 - accuracy: 0.9814 - val_loss: 1.6028 - val_accuracy: 0.5136
Epoch 18/1000
74/74 - 15s - loss: 0.0708 - accuracy: 0.9839 - val_loss: 0.5713 - val_accuracy: 0.8014
Epoch 19/1000
74/74 - 15s - loss: 0.0647 - accuracy: 0.9847 - val_loss: 0.5915 - val_accuracy: 0.7740
Epoch 20/1000
74/74 - 16s - loss: 0.0585 - accuracy: 0.9881 - val_loss: 0.5709 - val_accuracy: 0.7970
Epoch 21/1000
74/74 - 15s - loss: 0.0516 - accuracy: 0.9898 - val_loss: 0.6016 - val_accuracy: 0.8018
Epoch 22/1000
74/74 - 15s - loss: 0.0512 - accuracy: 0.9890 - val_loss: 0.9742 - val_accuracy: 0.6747
Epoch 23/1000
74/74 - 15s - loss: 0.0558 - accuracy: 0.9863 - val_loss: 0.6115 - val_accuracy: 0.8001
Epoch 24/1000
74/74 - 16s - loss: 0.0514 - accuracy: 0.9882 - val_loss: 0.6373 - val_accuracy: 0.7922
Epoch 25/1000
74/74 - 15s - loss: 0.0464 - accuracy: 0.9890 - val_loss: 0.7181 - val_accuracy: 0.7602
2021-10-25 11:19:23.740890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:19:23.740956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:19:23.741024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 11:19:23.741144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 11:19:23.741156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 11:19:23.741166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 11:19:23.741175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 11:19:23.741685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 11:19:23.741740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'InceptionResNetV2_VISOB_left_aug_gender_base_F75M25', 'model': 'InceptionResNetV2', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
inception_resnet_v2 (Functio (None, 3, 6, 1536)        54336736  
_________________________________________________________________
global_average_pooling2d_4 ( (None, 1536)              0         
_________________________________________________________________
dense_8 (Dense)              (None, 1024)              1573888   
_________________________________________________________________
batch_normalization_301 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_4 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_301 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 1)                 1025      
=================================================================
Total params: 55,915,745
Trainable params: 1,576,961
Non-trainable params: 54,338,784
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\3442_1014_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\enrollments_rgb\\3395_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\2715_1006_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\3469_1004_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\2484_1002_l_c.png' 1
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 124s - loss: 0.4892 - accuracy: 0.7688 - val_loss: 0.6798 - val_accuracy: 0.7517
Epoch 2/1000
74/74 - 30s - loss: 0.3971 - accuracy: 0.8143 - val_loss: 0.5773 - val_accuracy: 0.7696
Epoch 3/1000
74/74 - 30s - loss: 0.3638 - accuracy: 0.8332 - val_loss: 0.4139 - val_accuracy: 0.8060
Epoch 4/1000
74/74 - 32s - loss: 0.3328 - accuracy: 0.8504 - val_loss: 0.5059 - val_accuracy: 0.7883
Epoch 5/1000
74/74 - 30s - loss: 0.3152 - accuracy: 0.8580 - val_loss: 0.4271 - val_accuracy: 0.7994
Epoch 6/1000
74/74 - 30s - loss: 0.2998 - accuracy: 0.8678 - val_loss: 0.4508 - val_accuracy: 0.8077
Epoch 7/1000
74/74 - 32s - loss: 0.2746 - accuracy: 0.8818 - val_loss: 0.4193 - val_accuracy: 0.8064
Epoch 8/1000
74/74 - 31s - loss: 0.2614 - accuracy: 0.8878 - val_loss: 0.5181 - val_accuracy: 0.8001
Epoch 9/1000
74/74 - 32s - loss: 0.2474 - accuracy: 0.8948 - val_loss: 0.4419 - val_accuracy: 0.8127
Epoch 10/1000
74/74 - 30s - loss: 0.2335 - accuracy: 0.9031 - val_loss: 0.6428 - val_accuracy: 0.7917
Epoch 11/1000
74/74 - 31s - loss: 0.2251 - accuracy: 0.9044 - val_loss: 0.4845 - val_accuracy: 0.8057
Epoch 12/1000
74/74 - 30s - loss: 0.2113 - accuracy: 0.9140 - val_loss: 0.4273 - val_accuracy: 0.8207
Epoch 13/1000
74/74 - 30s - loss: 0.1973 - accuracy: 0.9221 - val_loss: 0.6627 - val_accuracy: 0.7888
Epoch 14/1000
74/74 - 31s - loss: 0.1819 - accuracy: 0.9311 - val_loss: 0.4461 - val_accuracy: 0.8219
Epoch 15/1000
74/74 - 30s - loss: 0.1710 - accuracy: 0.9357 - val_loss: 0.4587 - val_accuracy: 0.8183
Epoch 16/1000
74/74 - 30s - loss: 0.1634 - accuracy: 0.9400 - val_loss: 0.6023 - val_accuracy: 0.8006
Epoch 17/1000
74/74 - 31s - loss: 0.1633 - accuracy: 0.9383 - val_loss: 0.8774 - val_accuracy: 0.7735
Epoch 18/1000
74/74 - 31s - loss: 0.1432 - accuracy: 0.9487 - val_loss: 0.4716 - val_accuracy: 0.8079
Epoch 19/1000
74/74 - 31s - loss: 0.1364 - accuracy: 0.9525 - val_loss: 0.5976 - val_accuracy: 0.8103
Epoch 20/1000
74/74 - 30s - loss: 0.1267 - accuracy: 0.9577 - val_loss: 0.5066 - val_accuracy: 0.8212
Epoch 21/1000
74/74 - 31s - loss: 0.1296 - accuracy: 0.9556 - val_loss: 0.5365 - val_accuracy: 0.8147
Epoch 22/1000
74/74 - 30s - loss: 0.1142 - accuracy: 0.9608 - val_loss: 0.5003 - val_accuracy: 0.8190
Epoch 23/1000
74/74 - 31s - loss: 0.1083 - accuracy: 0.9654 - val_loss: 0.4701 - val_accuracy: 0.8098
2021-10-25 11:33:35.104647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:33:35.104720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:33:35.104796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 11:33:35.104916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 11:33:35.104928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 11:33:35.104939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 11:33:35.104948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 11:33:35.105348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 11:33:35.105406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'ResNet50_VISOB_left_aug_gender_base_F75M25', 'model': 'ResNet50', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
resnet50 (Functional)        (None, 5, 8, 2048)        23587712  
_________________________________________________________________
global_average_pooling2d_5 ( (None, 2048)              0         
_________________________________________________________________
dense_10 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_302 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_5 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_302 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_11 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 25,691,009
Trainable params: 2,101,249
Non-trainable params: 23,589,760
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  02021-10-25 11:34:11.827437: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 353 of 1024
2021-10-25 11:34:13.140760: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\enrollments_rgb\\2960_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\3371_1006_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_dim_light_short\\samsung_dim_light_short\\enrollments_rgb\\3350_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\verifications_rgb\\3145_1013_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_dim_light_short\\samsung_dim_light_short\\enrollments_rgb\\3209_1003_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 154s - loss: 0.4091 - accuracy: 0.8031 - val_loss: 0.3674 - val_accuracy: 0.8275
Epoch 2/1000
74/74 - 17s - loss: 0.2975 - accuracy: 0.8654 - val_loss: 0.3461 - val_accuracy: 0.8394
Epoch 3/1000
74/74 - 18s - loss: 0.2510 - accuracy: 0.8892 - val_loss: 0.4211 - val_accuracy: 0.8081
Epoch 4/1000
74/74 - 18s - loss: 0.2156 - accuracy: 0.9095 - val_loss: 0.3640 - val_accuracy: 0.8377
Epoch 5/1000
74/74 - 17s - loss: 0.1903 - accuracy: 0.9233 - val_loss: 0.3357 - val_accuracy: 0.8515
Epoch 6/1000
74/74 - 18s - loss: 0.1688 - accuracy: 0.9347 - val_loss: 0.3615 - val_accuracy: 0.8428
Epoch 7/1000
74/74 - 18s - loss: 0.1445 - accuracy: 0.9488 - val_loss: 0.3339 - val_accuracy: 0.8520
Epoch 8/1000
74/74 - 17s - loss: 0.1262 - accuracy: 0.9569 - val_loss: 0.3494 - val_accuracy: 0.8469
Epoch 9/1000
74/74 - 18s - loss: 0.1106 - accuracy: 0.9638 - val_loss: 0.3564 - val_accuracy: 0.8513
Epoch 10/1000
74/74 - 18s - loss: 0.0960 - accuracy: 0.9707 - val_loss: 0.3559 - val_accuracy: 0.8496
Epoch 11/1000
74/74 - 18s - loss: 0.0795 - accuracy: 0.9799 - val_loss: 0.5398 - val_accuracy: 0.8016
Epoch 12/1000
74/74 - 18s - loss: 0.0711 - accuracy: 0.9835 - val_loss: 0.3449 - val_accuracy: 0.8622
Epoch 13/1000
74/74 - 18s - loss: 0.0626 - accuracy: 0.9852 - val_loss: 0.3778 - val_accuracy: 0.8481
Epoch 14/1000
74/74 - 18s - loss: 0.0555 - accuracy: 0.9876 - val_loss: 0.3588 - val_accuracy: 0.8566
Epoch 15/1000
74/74 - 18s - loss: 0.0498 - accuracy: 0.9888 - val_loss: 0.4025 - val_accuracy: 0.8469
Epoch 16/1000
74/74 - 18s - loss: 0.0423 - accuracy: 0.9923 - val_loss: 0.3955 - val_accuracy: 0.8503
Epoch 17/1000
74/74 - 18s - loss: 0.0371 - accuracy: 0.9935 - val_loss: 0.4067 - val_accuracy: 0.8510
Epoch 18/1000
74/74 - 18s - loss: 0.0324 - accuracy: 0.9942 - val_loss: 0.3988 - val_accuracy: 0.8547
Epoch 19/1000
74/74 - 18s - loss: 0.0306 - accuracy: 0.9952 - val_loss: 0.3990 - val_accuracy: 0.8561
Epoch 20/1000
74/74 - 18s - loss: 0.0269 - accuracy: 0.9953 - val_loss: 0.4534 - val_accuracy: 0.8430
Epoch 21/1000
74/74 - 17s - loss: 0.0250 - accuracy: 0.9960 - val_loss: 0.4182 - val_accuracy: 0.8580
Epoch 22/1000
74/74 - 18s - loss: 0.0234 - accuracy: 0.9959 - val_loss: 0.4192 - val_accuracy: 0.8626
Epoch 23/1000
74/74 - 17s - loss: 0.0220 - accuracy: 0.9966 - val_loss: 0.4284 - val_accuracy: 0.8547
Epoch 24/1000
74/74 - 18s - loss: 0.0213 - accuracy: 0.9961 - val_loss: 0.4041 - val_accuracy: 0.8692
Epoch 25/1000
74/74 - 18s - loss: 0.0200 - accuracy: 0.9964 - val_loss: 0.6626 - val_accuracy: 0.8052
Epoch 26/1000
74/74 - 18s - loss: 0.0179 - accuracy: 0.9973 - val_loss: 0.4463 - val_accuracy: 0.8547
Epoch 27/1000
74/74 - 18s - loss: 0.0172 - accuracy: 0.9972 - val_loss: 0.6214 - val_accuracy: 0.8166
2021-10-25 11:44:34.802062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:44:34.802102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:44:34.802146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 11:44:34.802220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 11:44:34.802227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 11:44:34.802232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 11:44:34.802237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 11:44:34.802516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 11:44:34.802547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'VGG19_VISOB_left_aug_gender_base_F75M25', 'model': 'VGG19', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
vgg19 (Functional)           (None, 5, 7, 512)         20024384  
_________________________________________________________________
global_average_pooling2d_6 ( (None, 512)               0         
_________________________________________________________________
dense_12 (Dense)             (None, 1024)              525312    
_________________________________________________________________
batch_normalization_303 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_6 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_303 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_13 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 20,554,817
Trainable params: 528,385
Non-trainable params: 20,026,432
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  02021-10-25 11:45:02.879895: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 742 of 1024
2021-10-25 11:45:03.372749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\1158_1010_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_dim_light_short\\samsung_dim_light_short\\verifications_rgb\\3404_1006_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\1163_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\2911_1006_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\3113_1001_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 152s - loss: 0.4611 - accuracy: 0.7706 - val_loss: 0.3940 - val_accuracy: 0.8166
Epoch 2/1000
74/74 - 19s - loss: 0.3623 - accuracy: 0.8339 - val_loss: 0.3636 - val_accuracy: 0.8319
Epoch 3/1000
74/74 - 20s - loss: 0.3273 - accuracy: 0.8475 - val_loss: 0.3588 - val_accuracy: 0.8290
Epoch 4/1000
74/74 - 19s - loss: 0.3018 - accuracy: 0.8665 - val_loss: 0.3525 - val_accuracy: 0.8331
Epoch 5/1000
74/74 - 20s - loss: 0.2819 - accuracy: 0.8763 - val_loss: 0.3484 - val_accuracy: 0.8377
Epoch 6/1000
74/74 - 20s - loss: 0.2604 - accuracy: 0.8893 - val_loss: 0.3386 - val_accuracy: 0.8399
Epoch 7/1000
74/74 - 19s - loss: 0.2477 - accuracy: 0.8940 - val_loss: 0.3364 - val_accuracy: 0.8459
Epoch 8/1000
74/74 - 20s - loss: 0.2274 - accuracy: 0.9094 - val_loss: 0.3330 - val_accuracy: 0.8479
Epoch 9/1000
74/74 - 20s - loss: 0.2130 - accuracy: 0.9158 - val_loss: 0.3430 - val_accuracy: 0.8457
Epoch 10/1000
74/74 - 20s - loss: 0.2009 - accuracy: 0.9228 - val_loss: 0.3378 - val_accuracy: 0.8447
Epoch 11/1000
74/74 - 20s - loss: 0.1880 - accuracy: 0.9280 - val_loss: 0.3390 - val_accuracy: 0.8520
Epoch 12/1000
74/74 - 20s - loss: 0.1751 - accuracy: 0.9347 - val_loss: 0.3713 - val_accuracy: 0.8454
Epoch 13/1000
74/74 - 20s - loss: 0.1626 - accuracy: 0.9434 - val_loss: 0.3316 - val_accuracy: 0.8539
Epoch 14/1000
74/74 - 20s - loss: 0.1468 - accuracy: 0.9496 - val_loss: 0.3408 - val_accuracy: 0.8578
Epoch 15/1000
74/74 - 20s - loss: 0.1343 - accuracy: 0.9564 - val_loss: 0.3294 - val_accuracy: 0.8505
Epoch 16/1000
74/74 - 20s - loss: 0.1309 - accuracy: 0.9590 - val_loss: 0.3575 - val_accuracy: 0.8554
Epoch 17/1000
74/74 - 20s - loss: 0.1169 - accuracy: 0.9649 - val_loss: 0.3389 - val_accuracy: 0.8578
Epoch 18/1000
74/74 - 20s - loss: 0.1059 - accuracy: 0.9719 - val_loss: 0.3779 - val_accuracy: 0.8542
Epoch 19/1000
74/74 - 20s - loss: 0.0990 - accuracy: 0.9730 - val_loss: 0.3405 - val_accuracy: 0.8508
Epoch 20/1000
74/74 - 20s - loss: 0.0900 - accuracy: 0.9778 - val_loss: 0.3844 - val_accuracy: 0.8559
Epoch 21/1000
74/74 - 20s - loss: 0.0832 - accuracy: 0.9807 - val_loss: 0.3473 - val_accuracy: 0.8583
Epoch 22/1000
74/74 - 20s - loss: 0.0764 - accuracy: 0.9838 - val_loss: 0.3466 - val_accuracy: 0.8503
Epoch 23/1000
74/74 - 20s - loss: 0.0720 - accuracy: 0.9835 - val_loss: 0.3484 - val_accuracy: 0.8639
Epoch 24/1000
74/74 - 20s - loss: 0.0647 - accuracy: 0.9878 - val_loss: 0.3967 - val_accuracy: 0.8585
Epoch 25/1000
74/74 - 20s - loss: 0.0618 - accuracy: 0.9867 - val_loss: 0.3619 - val_accuracy: 0.8585
Epoch 26/1000
74/74 - 20s - loss: 0.0565 - accuracy: 0.9891 - val_loss: 0.3620 - val_accuracy: 0.8605
Epoch 27/1000
74/74 - 20s - loss: 0.0531 - accuracy: 0.9893 - val_loss: 0.3552 - val_accuracy: 0.8595
Epoch 28/1000
74/74 - 20s - loss: 0.0504 - accuracy: 0.9910 - val_loss: 0.3541 - val_accuracy: 0.8578
Epoch 29/1000
74/74 - 20s - loss: 0.0463 - accuracy: 0.9919 - val_loss: 0.3651 - val_accuracy: 0.8609
Epoch 30/1000
74/74 - 20s - loss: 0.0468 - accuracy: 0.9920 - val_loss: 0.3931 - val_accuracy: 0.8639
Epoch 31/1000
74/74 - 20s - loss: 0.0398 - accuracy: 0.9940 - val_loss: 0.3735 - val_accuracy: 0.8619
Epoch 32/1000
74/74 - 20s - loss: 0.0384 - accuracy: 0.9934 - val_loss: 0.3673 - val_accuracy: 0.8622
Epoch 33/1000
74/74 - 19s - loss: 0.0371 - accuracy: 0.9937 - val_loss: 0.4200 - val_accuracy: 0.8624
Epoch 34/1000
74/74 - 20s - loss: 0.0343 - accuracy: 0.9942 - val_loss: 0.3895 - val_accuracy: 0.8595
Epoch 35/1000
74/74 - 19s - loss: 0.0315 - accuracy: 0.9953 - val_loss: 0.4040 - val_accuracy: 0.8648
2021-10-25 11:59:15.043608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:59:15.043683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 11:59:15.043764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 11:59:15.043899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 11:59:15.043913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 11:59:15.043924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 11:59:15.043935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 11:59:15.044417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 11:59:15.044480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'Xception_VISOB_left_aug_gender_base_F75M25', 'model': 'Xception', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
xception (Functional)        (None, 5, 8, 2048)        20861480  
_________________________________________________________________
global_average_pooling2d_7 ( (None, 2048)              0         
_________________________________________________________________
dense_14 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_308 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_7 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_304 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_15 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 22,964,777
Trainable params: 2,101,249
Non-trainable params: 20,863,528
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3218_1007_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3122_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\enrollments_rgb\\1178_1002_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_day_light_short\\samsung_day_light_short\\verifications_rgb\\3240_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3298_1004_l_c.png' 1
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 167s - loss: 0.5242 - accuracy: 0.7423 - val_loss: 0.5101 - val_accuracy: 0.7701
Epoch 2/1000
74/74 - 18s - loss: 0.3897 - accuracy: 0.8193 - val_loss: 0.4791 - val_accuracy: 0.7737
Epoch 3/1000
74/74 - 19s - loss: 0.3456 - accuracy: 0.8454 - val_loss: 0.4423 - val_accuracy: 0.7929
Epoch 4/1000
74/74 - 19s - loss: 0.3070 - accuracy: 0.8656 - val_loss: 0.4571 - val_accuracy: 0.7873
Epoch 5/1000
74/74 - 19s - loss: 0.2785 - accuracy: 0.8782 - val_loss: 0.4705 - val_accuracy: 0.7783
Epoch 6/1000
74/74 - 18s - loss: 0.2567 - accuracy: 0.8922 - val_loss: 0.4203 - val_accuracy: 0.8079
Epoch 7/1000
74/74 - 19s - loss: 0.2304 - accuracy: 0.9085 - val_loss: 0.4516 - val_accuracy: 0.7970
Epoch 8/1000
74/74 - 19s - loss: 0.2027 - accuracy: 0.9243 - val_loss: 0.4481 - val_accuracy: 0.8067
Epoch 9/1000
74/74 - 19s - loss: 0.1836 - accuracy: 0.9335 - val_loss: 0.4723 - val_accuracy: 0.8035
Epoch 10/1000
74/74 - 19s - loss: 0.1696 - accuracy: 0.9376 - val_loss: 0.4624 - val_accuracy: 0.8067
Epoch 11/1000
74/74 - 19s - loss: 0.1472 - accuracy: 0.9516 - val_loss: 0.4771 - val_accuracy: 0.8084
Epoch 12/1000
74/74 - 19s - loss: 0.1320 - accuracy: 0.9596 - val_loss: 0.4995 - val_accuracy: 0.8052
Epoch 13/1000
74/74 - 19s - loss: 0.1270 - accuracy: 0.9584 - val_loss: 0.5145 - val_accuracy: 0.8089
Epoch 14/1000
74/74 - 19s - loss: 0.1078 - accuracy: 0.9691 - val_loss: 0.5018 - val_accuracy: 0.8142
Epoch 15/1000
74/74 - 19s - loss: 0.0937 - accuracy: 0.9753 - val_loss: 0.5150 - val_accuracy: 0.8050
Epoch 16/1000
74/74 - 19s - loss: 0.0881 - accuracy: 0.9765 - val_loss: 0.5413 - val_accuracy: 0.8057
Epoch 17/1000
74/74 - 19s - loss: 0.0794 - accuracy: 0.9804 - val_loss: 0.5873 - val_accuracy: 0.8108
Epoch 18/1000
74/74 - 18s - loss: 0.0810 - accuracy: 0.9770 - val_loss: 0.5487 - val_accuracy: 0.8028
Epoch 19/1000
74/74 - 19s - loss: 0.0670 - accuracy: 0.9845 - val_loss: 0.5939 - val_accuracy: 0.8152
Epoch 20/1000
74/74 - 19s - loss: 0.0600 - accuracy: 0.9859 - val_loss: 0.5580 - val_accuracy: 0.8064
Epoch 21/1000
74/74 - 19s - loss: 0.0547 - accuracy: 0.9873 - val_loss: 0.5697 - val_accuracy: 0.8091
Epoch 22/1000
74/74 - 18s - loss: 0.0526 - accuracy: 0.9884 - val_loss: 0.5974 - val_accuracy: 0.7960
Epoch 23/1000
74/74 - 19s - loss: 0.0506 - accuracy: 0.9875 - val_loss: 0.5823 - val_accuracy: 0.8127
Epoch 24/1000
74/74 - 19s - loss: 0.0426 - accuracy: 0.9919 - val_loss: 0.7224 - val_accuracy: 0.8055
Epoch 25/1000
74/74 - 19s - loss: 0.0384 - accuracy: 0.9928 - val_loss: 0.6202 - val_accuracy: 0.8161
Epoch 26/1000
74/74 - 19s - loss: 0.0381 - accuracy: 0.9927 - val_loss: 0.6596 - val_accuracy: 0.8079
2021-10-25 12:10:34.809970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 12:10:34.810168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 12:10:34.810296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 12:10:34.810507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 12:10:34.810528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 12:10:34.810546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 12:10:34.810563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 12:10:34.811243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 12:10:34.811338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'EfficientNetB0_VISOB_left_aug_gender_base_F75M25', 'model': 'EfficientNetB0', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': False, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_UFPR-aligned-cropped_aug_gender.07-0.4004.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb0 (Functional)  (None, 5, 8, 1280)        4049571   
_________________________________________________________________
global_average_pooling2d_8 ( (None, 1280)              0         
_________________________________________________________________
dense_16 (Dense)             (None, 1024)              1311744   
_________________________________________________________________
batch_normalization_309 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_8 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_305 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_17 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 5,366,436
Trainable params: 1,314,817
Non-trainable params: 4,051,619
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\2526_1001_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\verifications_rgb\\2531_1002_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\verifications_rgb\\3442_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\2382_1006_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\2944_1003_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  1
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
74/74 - 184s - loss: 0.4834 - accuracy: 0.7606 - val_loss: 0.4065 - val_accuracy: 0.8125
Epoch 2/1000
74/74 - 14s - loss: 0.3384 - accuracy: 0.8424 - val_loss: 0.3642 - val_accuracy: 0.8348
Epoch 3/1000
74/74 - 14s - loss: 0.3021 - accuracy: 0.8617 - val_loss: 0.3315 - val_accuracy: 0.8488
Epoch 4/1000
74/74 - 14s - loss: 0.2811 - accuracy: 0.8721 - val_loss: 0.3314 - val_accuracy: 0.8459
Epoch 5/1000
74/74 - 14s - loss: 0.2627 - accuracy: 0.8837 - val_loss: 0.3108 - val_accuracy: 0.8515
Epoch 6/1000
74/74 - 14s - loss: 0.2473 - accuracy: 0.8923 - val_loss: 0.3046 - val_accuracy: 0.8542
Epoch 7/1000
74/74 - 14s - loss: 0.2341 - accuracy: 0.9006 - val_loss: 0.2990 - val_accuracy: 0.8619
Epoch 8/1000
74/74 - 14s - loss: 0.2182 - accuracy: 0.9068 - val_loss: 0.3022 - val_accuracy: 0.8588
Epoch 9/1000
74/74 - 14s - loss: 0.2078 - accuracy: 0.9128 - val_loss: 0.3005 - val_accuracy: 0.8602
Epoch 10/1000
74/74 - 14s - loss: 0.2042 - accuracy: 0.9145 - val_loss: 0.2994 - val_accuracy: 0.8607
Epoch 11/1000
74/74 - 14s - loss: 0.1962 - accuracy: 0.9188 - val_loss: 0.3006 - val_accuracy: 0.8622
Epoch 12/1000
74/74 - 14s - loss: 0.1900 - accuracy: 0.9223 - val_loss: 0.2938 - val_accuracy: 0.8658
Epoch 13/1000
74/74 - 14s - loss: 0.1727 - accuracy: 0.9324 - val_loss: 0.2884 - val_accuracy: 0.8697
Epoch 14/1000
74/74 - 14s - loss: 0.1662 - accuracy: 0.9348 - val_loss: 0.2901 - val_accuracy: 0.8677
Epoch 15/1000
74/74 - 15s - loss: 0.1636 - accuracy: 0.9365 - val_loss: 0.2891 - val_accuracy: 0.8687
Epoch 16/1000
74/74 - 14s - loss: 0.1508 - accuracy: 0.9441 - val_loss: 0.3286 - val_accuracy: 0.8549
Epoch 17/1000
74/74 - 14s - loss: 0.1501 - accuracy: 0.9406 - val_loss: 0.2925 - val_accuracy: 0.8716
Epoch 18/1000
74/74 - 14s - loss: 0.1416 - accuracy: 0.9474 - val_loss: 0.2923 - val_accuracy: 0.8748
Epoch 19/1000
74/74 - 15s - loss: 0.1337 - accuracy: 0.9521 - val_loss: 0.2949 - val_accuracy: 0.8711
Epoch 20/1000
74/74 - 14s - loss: 0.1341 - accuracy: 0.9499 - val_loss: 0.3005 - val_accuracy: 0.8704
Epoch 21/1000
74/74 - 14s - loss: 0.1222 - accuracy: 0.9557 - val_loss: 0.2935 - val_accuracy: 0.8750
Epoch 22/1000
74/74 - 15s - loss: 0.1195 - accuracy: 0.9562 - val_loss: 0.3125 - val_accuracy: 0.8685
Epoch 23/1000
74/74 - 14s - loss: 0.1130 - accuracy: 0.9605 - val_loss: 0.3039 - val_accuracy: 0.8723
Epoch 24/1000
74/74 - 14s - loss: 0.1112 - accuracy: 0.9605 - val_loss: 0.2988 - val_accuracy: 0.8719
Epoch 25/1000
74/74 - 14s - loss: 0.1090 - accuracy: 0.9620 - val_loss: 0.2940 - val_accuracy: 0.8748
Epoch 26/1000
74/74 - 14s - loss: 0.1017 - accuracy: 0.9643 - val_loss: 0.3048 - val_accuracy: 0.8721
Epoch 27/1000
74/74 - 14s - loss: 0.0985 - accuracy: 0.9656 - val_loss: 0.3205 - val_accuracy: 0.8706
Epoch 28/1000
74/74 - 14s - loss: 0.0951 - accuracy: 0.9686 - val_loss: 0.3021 - val_accuracy: 0.8798
Epoch 29/1000
74/74 - 14s - loss: 0.0935 - accuracy: 0.9684 - val_loss: 0.3159 - val_accuracy: 0.8769
Epoch 30/1000
74/74 - 14s - loss: 0.0907 - accuracy: 0.9689 - val_loss: 0.3125 - val_accuracy: 0.8765
Epoch 31/1000
74/74 - 14s - loss: 0.0904 - accuracy: 0.9686 - val_loss: 0.3110 - val_accuracy: 0.8774
Epoch 32/1000
74/74 - 14s - loss: 0.0854 - accuracy: 0.9710 - val_loss: 0.3213 - val_accuracy: 0.8716
Epoch 33/1000
74/74 - 14s - loss: 0.0886 - accuracy: 0.9698 - val_loss: 0.3064 - val_accuracy: 0.8808
2021-10-25 12:22:04.645652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 12:22:04.645697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 12:22:04.645735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 12:22:04.645800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 12:22:04.645807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 12:22:04.645812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 12:22:04.645817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 12:22:04.646101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 12:22:04.646131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'EfficientNetB4_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'EfficientNetB4', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\EfficientNetB4_VISOB_left_aug_gender_base_F75M25.24-0.3097.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb4 (Functional)  (None, 5, 8, 1792)        17673823  
_________________________________________________________________
global_average_pooling2d_9 ( (None, 1792)              0         
_________________________________________________________________
dense_18 (Dense)             (None, 1024)              1836032   
_________________________________________________________________
batch_normalization_310 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_9 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_306 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_19 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 19,514,976
Trainable params: 1,839,105
Non-trainable params: 17,675,871
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\EfficientNetB4_VISOB_left_aug_gender_base_F75M25.24-0.3097.hdf5
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb4 (Functional)  (None, 5, 8, 1792)        17673823  
_________________________________________________________________
global_average_pooling2d_9 ( (None, 1792)              0         
_________________________________________________________________
dense_18 (Dense)             (None, 1024)              1836032   
_________________________________________________________________
batch_normalization_310 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_9 (Dropout)          (None, 1024)              0         
_________________________________________________________________
activation_306 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_19 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 19,514,976
Trainable params: 19,387,721
Non-trainable params: 127,255
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 12:23:58.390902: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 12:24:02.405629: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 939 of 1024
2021-10-25 12:24:03.157625: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\2720_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3334_1002_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3147_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\3443_1008_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\verifications_rgb\\2530_1005_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 312s - loss: 0.6568 - accuracy: 0.7684 - val_loss: 0.4816 - val_accuracy: 0.8159
Epoch 2/1000
295/295 - 153s - loss: 0.3644 - accuracy: 0.8501 - val_loss: 0.4008 - val_accuracy: 0.8430
Epoch 3/1000
295/295 - 155s - loss: 0.2562 - accuracy: 0.8929 - val_loss: 0.3437 - val_accuracy: 0.8605
Epoch 4/1000
295/295 - 154s - loss: 0.1891 - accuracy: 0.9220 - val_loss: 0.3189 - val_accuracy: 0.8699
Epoch 5/1000
295/295 - 154s - loss: 0.1491 - accuracy: 0.9386 - val_loss: 0.2968 - val_accuracy: 0.8789
Epoch 6/1000
295/295 - 154s - loss: 0.1190 - accuracy: 0.9538 - val_loss: 0.2849 - val_accuracy: 0.8861
Epoch 7/1000
295/295 - 154s - loss: 0.0923 - accuracy: 0.9638 - val_loss: 0.2767 - val_accuracy: 0.8886
Epoch 8/1000
295/295 - 153s - loss: 0.0755 - accuracy: 0.9716 - val_loss: 0.2684 - val_accuracy: 0.8958
Epoch 9/1000
295/295 - 154s - loss: 0.0614 - accuracy: 0.9768 - val_loss: 0.2634 - val_accuracy: 0.8995
Epoch 10/1000
295/295 - 154s - loss: 0.0525 - accuracy: 0.9809 - val_loss: 0.2531 - val_accuracy: 0.9031
Epoch 11/1000
295/295 - 155s - loss: 0.0491 - accuracy: 0.9815 - val_loss: 0.2505 - val_accuracy: 0.9060
Epoch 12/1000
295/295 - 154s - loss: 0.0400 - accuracy: 0.9854 - val_loss: 0.2566 - val_accuracy: 0.9116
Epoch 13/1000
295/295 - 155s - loss: 0.0356 - accuracy: 0.9875 - val_loss: 0.2400 - val_accuracy: 0.9181
Epoch 14/1000
295/295 - 154s - loss: 0.0340 - accuracy: 0.9879 - val_loss: 0.2295 - val_accuracy: 0.9155
Epoch 15/1000
295/295 - 155s - loss: 0.0267 - accuracy: 0.9907 - val_loss: 0.2291 - val_accuracy: 0.9203
Epoch 16/1000
295/295 - 154s - loss: 0.0266 - accuracy: 0.9905 - val_loss: 0.2233 - val_accuracy: 0.9251
Epoch 17/1000
295/295 - 154s - loss: 0.0221 - accuracy: 0.9924 - val_loss: 0.2349 - val_accuracy: 0.9198
Epoch 18/1000
295/295 - 155s - loss: 0.0243 - accuracy: 0.9920 - val_loss: 0.2299 - val_accuracy: 0.9254
Epoch 19/1000
295/295 - 155s - loss: 0.0203 - accuracy: 0.9927 - val_loss: 0.2341 - val_accuracy: 0.9237
Epoch 20/1000
295/295 - 155s - loss: 0.0161 - accuracy: 0.9944 - val_loss: 0.2184 - val_accuracy: 0.9283
Epoch 21/1000
295/295 - 157s - loss: 0.0176 - accuracy: 0.9939 - val_loss: 0.2454 - val_accuracy: 0.9237
Epoch 22/1000
295/295 - 156s - loss: 0.0181 - accuracy: 0.9936 - val_loss: 0.2209 - val_accuracy: 0.9307
Epoch 23/1000
295/295 - 155s - loss: 0.0144 - accuracy: 0.9947 - val_loss: 0.2085 - val_accuracy: 0.9310
Epoch 24/1000
295/295 - 155s - loss: 0.0165 - accuracy: 0.9940 - val_loss: 0.2269 - val_accuracy: 0.9324
Epoch 25/1000
295/295 - 155s - loss: 0.0160 - accuracy: 0.9937 - val_loss: 0.2260 - val_accuracy: 0.9285
Epoch 26/1000
295/295 - 155s - loss: 0.0141 - accuracy: 0.9950 - val_loss: 0.2177 - val_accuracy: 0.9346
Epoch 27/1000
295/295 - 154s - loss: 0.0140 - accuracy: 0.9945 - val_loss: 0.2196 - val_accuracy: 0.9390
Epoch 28/1000
295/295 - 154s - loss: 0.0132 - accuracy: 0.9952 - val_loss: 0.2114 - val_accuracy: 0.9356
Epoch 29/1000
295/295 - 155s - loss: 0.0110 - accuracy: 0.9960 - val_loss: 0.2148 - val_accuracy: 0.9336
Epoch 30/1000
295/295 - 155s - loss: 0.0120 - accuracy: 0.9953 - val_loss: 0.2065 - val_accuracy: 0.9380
Epoch 31/1000
295/295 - 156s - loss: 0.0120 - accuracy: 0.9960 - val_loss: 0.2162 - val_accuracy: 0.9356
Epoch 32/1000
295/295 - 156s - loss: 0.0108 - accuracy: 0.9961 - val_loss: 0.2160 - val_accuracy: 0.9341
Epoch 33/1000
295/295 - 155s - loss: 0.0107 - accuracy: 0.9961 - val_loss: 0.2083 - val_accuracy: 0.9387
Epoch 34/1000
295/295 - 155s - loss: 0.0098 - accuracy: 0.9961 - val_loss: 0.2102 - val_accuracy: 0.9368
Epoch 35/1000
295/295 - 154s - loss: 0.0086 - accuracy: 0.9968 - val_loss: 0.2014 - val_accuracy: 0.9390
Epoch 36/1000
295/295 - 153s - loss: 0.0082 - accuracy: 0.9970 - val_loss: 0.2035 - val_accuracy: 0.9390
Epoch 37/1000
295/295 - 155s - loss: 0.0076 - accuracy: 0.9969 - val_loss: 0.2010 - val_accuracy: 0.9394
Epoch 38/1000
295/295 - 155s - loss: 0.0090 - accuracy: 0.9969 - val_loss: 0.2150 - val_accuracy: 0.9385
Epoch 39/1000
295/295 - 156s - loss: 0.0086 - accuracy: 0.9965 - val_loss: 0.2070 - val_accuracy: 0.9394
Epoch 40/1000
295/295 - 154s - loss: 0.0083 - accuracy: 0.9967 - val_loss: 0.1925 - val_accuracy: 0.9431
Epoch 41/1000
295/295 - 154s - loss: 0.0081 - accuracy: 0.9966 - val_loss: 0.2057 - val_accuracy: 0.9404
Epoch 42/1000
295/295 - 154s - loss: 0.0076 - accuracy: 0.9972 - val_loss: 0.1929 - val_accuracy: 0.9431
Epoch 43/1000
295/295 - 155s - loss: 0.0101 - accuracy: 0.9964 - val_loss: 0.1935 - val_accuracy: 0.9436
Epoch 44/1000
295/295 - 154s - loss: 0.0081 - accuracy: 0.9971 - val_loss: 0.2011 - val_accuracy: 0.9438
Epoch 45/1000
295/295 - 154s - loss: 0.0090 - accuracy: 0.9967 - val_loss: 0.1955 - val_accuracy: 0.9423
Epoch 46/1000
295/295 - 154s - loss: 0.0083 - accuracy: 0.9966 - val_loss: 0.2015 - val_accuracy: 0.9390
Epoch 47/1000
295/295 - 154s - loss: 0.0075 - accuracy: 0.9973 - val_loss: 0.1839 - val_accuracy: 0.9438
Epoch 48/1000
295/295 - 154s - loss: 0.0081 - accuracy: 0.9973 - val_loss: 0.1959 - val_accuracy: 0.9431
Epoch 49/1000
295/295 - 155s - loss: 0.0066 - accuracy: 0.9976 - val_loss: 0.1806 - val_accuracy: 0.9482
Epoch 50/1000
295/295 - 155s - loss: 0.0065 - accuracy: 0.9976 - val_loss: 0.1917 - val_accuracy: 0.9426
Epoch 51/1000
295/295 - 155s - loss: 0.0076 - accuracy: 0.9972 - val_loss: 0.2008 - val_accuracy: 0.9414
Epoch 52/1000
295/295 - 156s - loss: 0.0059 - accuracy: 0.9979 - val_loss: 0.1880 - val_accuracy: 0.9472
Epoch 53/1000
295/295 - 155s - loss: 0.0066 - accuracy: 0.9978 - val_loss: 0.1942 - val_accuracy: 0.9479
Epoch 54/1000
295/295 - 155s - loss: 0.0066 - accuracy: 0.9975 - val_loss: 0.1839 - val_accuracy: 0.9491
Epoch 55/1000
295/295 - 154s - loss: 0.0067 - accuracy: 0.9975 - val_loss: 0.1851 - val_accuracy: 0.9474
Epoch 56/1000
295/295 - 153s - loss: 0.0068 - accuracy: 0.9973 - val_loss: 0.1873 - val_accuracy: 0.9479
Epoch 57/1000
295/295 - 155s - loss: 0.0063 - accuracy: 0.9973 - val_loss: 0.1798 - val_accuracy: 0.9501
Epoch 58/1000
295/295 - 154s - loss: 0.0064 - accuracy: 0.9976 - val_loss: 0.1752 - val_accuracy: 0.9496
Epoch 59/1000
295/295 - 154s - loss: 0.0051 - accuracy: 0.9981 - val_loss: 0.1824 - val_accuracy: 0.9513
Epoch 60/1000
295/295 - 154s - loss: 0.0063 - accuracy: 0.9980 - val_loss: 0.2011 - val_accuracy: 0.9506
Epoch 61/1000
295/295 - 154s - loss: 0.0054 - accuracy: 0.9979 - val_loss: 0.1721 - val_accuracy: 0.9508
Epoch 62/1000
295/295 - 157s - loss: 0.0063 - accuracy: 0.9978 - val_loss: 0.1756 - val_accuracy: 0.9520
Epoch 63/1000
295/295 - 155s - loss: 0.0043 - accuracy: 0.9985 - val_loss: 0.1906 - val_accuracy: 0.9472
Epoch 64/1000
295/295 - 151s - loss: 0.0059 - accuracy: 0.9978 - val_loss: 0.1959 - val_accuracy: 0.9465
Epoch 65/1000
295/295 - 145s - loss: 0.0049 - accuracy: 0.9983 - val_loss: 0.1849 - val_accuracy: 0.9479
Epoch 66/1000
295/295 - 148s - loss: 0.0053 - accuracy: 0.9981 - val_loss: 0.1907 - val_accuracy: 0.9482
Epoch 67/1000
295/295 - 153s - loss: 0.0058 - accuracy: 0.9977 - val_loss: 0.2019 - val_accuracy: 0.9465
Epoch 68/1000
295/295 - 154s - loss: 0.0048 - accuracy: 0.9984 - val_loss: 0.1828 - val_accuracy: 0.9506
Epoch 69/1000
295/295 - 154s - loss: 0.0051 - accuracy: 0.9981 - val_loss: 0.1826 - val_accuracy: 0.9496
Epoch 70/1000
295/295 - 155s - loss: 0.0040 - accuracy: 0.9985 - val_loss: 0.1691 - val_accuracy: 0.9518
Epoch 71/1000
295/295 - 154s - loss: 0.0062 - accuracy: 0.9978 - val_loss: 0.1895 - val_accuracy: 0.9508
Epoch 72/1000
295/295 - 154s - loss: 0.0069 - accuracy: 0.9975 - val_loss: 0.2275 - val_accuracy: 0.9436
Epoch 73/1000
295/295 - 153s - loss: 0.0056 - accuracy: 0.9981 - val_loss: 0.1804 - val_accuracy: 0.9482
Epoch 74/1000
295/295 - 157s - loss: 0.0050 - accuracy: 0.9979 - val_loss: 0.1863 - val_accuracy: 0.9491
Epoch 75/1000
295/295 - 154s - loss: 0.0041 - accuracy: 0.9985 - val_loss: 0.1740 - val_accuracy: 0.9523
Epoch 76/1000
295/295 - 153s - loss: 0.0046 - accuracy: 0.9981 - val_loss: 0.1796 - val_accuracy: 0.9479
Epoch 77/1000
295/295 - 154s - loss: 0.0063 - accuracy: 0.9976 - val_loss: 0.1844 - val_accuracy: 0.9472
Epoch 78/1000
295/295 - 154s - loss: 0.0053 - accuracy: 0.9981 - val_loss: 0.1796 - val_accuracy: 0.9491
Epoch 79/1000
295/295 - 152s - loss: 0.0044 - accuracy: 0.9984 - val_loss: 0.1835 - val_accuracy: 0.9491
Epoch 80/1000
295/295 - 153s - loss: 0.0044 - accuracy: 0.9983 - val_loss: 0.2074 - val_accuracy: 0.9479
Epoch 81/1000
295/295 - 153s - loss: 0.0053 - accuracy: 0.9980 - val_loss: 0.2084 - val_accuracy: 0.9494
Epoch 82/1000
295/295 - 153s - loss: 0.0039 - accuracy: 0.9985 - val_loss: 0.1909 - val_accuracy: 0.9513
Epoch 83/1000
295/295 - 155s - loss: 0.0048 - accuracy: 0.9983 - val_loss: 0.1758 - val_accuracy: 0.9513
Epoch 84/1000
295/295 - 154s - loss: 0.0047 - accuracy: 0.9982 - val_loss: 0.1632 - val_accuracy: 0.9513
Epoch 85/1000
295/295 - 154s - loss: 0.0048 - accuracy: 0.9983 - val_loss: 0.1786 - val_accuracy: 0.9528
Epoch 86/1000
295/295 - 154s - loss: 0.0048 - accuracy: 0.9980 - val_loss: 0.1730 - val_accuracy: 0.9501
Epoch 87/1000
295/295 - 155s - loss: 0.0047 - accuracy: 0.9983 - val_loss: 0.1711 - val_accuracy: 0.9528
Epoch 88/1000
295/295 - 154s - loss: 0.0044 - accuracy: 0.9983 - val_loss: 0.1807 - val_accuracy: 0.9549
Epoch 89/1000
295/295 - 153s - loss: 0.0042 - accuracy: 0.9982 - val_loss: 0.1615 - val_accuracy: 0.9574
Epoch 90/1000
295/295 - 153s - loss: 0.0034 - accuracy: 0.9988 - val_loss: 0.1683 - val_accuracy: 0.9574
Epoch 91/1000
295/295 - 153s - loss: 0.0031 - accuracy: 0.9989 - val_loss: 0.1762 - val_accuracy: 0.9547
Epoch 92/1000
295/295 - 154s - loss: 0.0032 - accuracy: 0.9986 - val_loss: 0.1756 - val_accuracy: 0.9552
Epoch 93/1000
295/295 - 153s - loss: 0.0043 - accuracy: 0.9983 - val_loss: 0.1806 - val_accuracy: 0.9535
Epoch 94/1000
295/295 - 153s - loss: 0.0043 - accuracy: 0.9983 - val_loss: 0.1883 - val_accuracy: 0.9545
Epoch 95/1000
295/295 - 154s - loss: 0.0046 - accuracy: 0.9982 - val_loss: 0.1814 - val_accuracy: 0.9557
Epoch 96/1000
295/295 - 152s - loss: 0.0037 - accuracy: 0.9986 - val_loss: 0.1850 - val_accuracy: 0.9576
Epoch 97/1000
295/295 - 154s - loss: 0.0049 - accuracy: 0.9980 - val_loss: 0.1989 - val_accuracy: 0.9528
Epoch 98/1000
295/295 - 152s - loss: 0.0037 - accuracy: 0.9985 - val_loss: 0.1863 - val_accuracy: 0.9537
Epoch 99/1000
295/295 - 154s - loss: 0.0042 - accuracy: 0.9985 - val_loss: 0.1775 - val_accuracy: 0.9545
Epoch 100/1000
295/295 - 153s - loss: 0.0049 - accuracy: 0.9978 - val_loss: 0.1747 - val_accuracy: 0.9530
Epoch 101/1000
295/295 - 154s - loss: 0.0034 - accuracy: 0.9986 - val_loss: 0.1834 - val_accuracy: 0.9545
Epoch 102/1000
295/295 - 153s - loss: 0.0042 - accuracy: 0.9982 - val_loss: 0.1770 - val_accuracy: 0.9540
Epoch 103/1000
295/295 - 152s - loss: 0.0037 - accuracy: 0.9987 - val_loss: 0.1757 - val_accuracy: 0.9532
Epoch 104/1000
295/295 - 154s - loss: 0.0032 - accuracy: 0.9986 - val_loss: 0.1802 - val_accuracy: 0.9530
Epoch 105/1000
295/295 - 153s - loss: 0.0031 - accuracy: 0.9988 - val_loss: 0.1750 - val_accuracy: 0.9586
Epoch 106/1000
295/295 - 154s - loss: 0.0046 - accuracy: 0.9984 - val_loss: 0.1883 - val_accuracy: 0.9532
Epoch 107/1000
295/295 - 153s - loss: 0.0037 - accuracy: 0.9986 - val_loss: 0.1802 - val_accuracy: 0.9540
Epoch 108/1000
295/295 - 153s - loss: 0.0035 - accuracy: 0.9985 - val_loss: 0.1580 - val_accuracy: 0.9566
Epoch 109/1000
295/295 - 153s - loss: 0.0037 - accuracy: 0.9986 - val_loss: 0.1828 - val_accuracy: 0.9508
Epoch 110/1000
295/295 - 153s - loss: 0.0036 - accuracy: 0.9986 - val_loss: 0.1757 - val_accuracy: 0.9516
Epoch 111/1000
295/295 - 154s - loss: 0.0042 - accuracy: 0.9984 - val_loss: 0.1605 - val_accuracy: 0.9564
Epoch 112/1000
295/295 - 154s - loss: 0.0034 - accuracy: 0.9986 - val_loss: 0.1791 - val_accuracy: 0.9574
Epoch 113/1000
295/295 - 155s - loss: 0.0033 - accuracy: 0.9986 - val_loss: 0.1683 - val_accuracy: 0.9586
Epoch 114/1000
295/295 - 154s - loss: 0.0043 - accuracy: 0.9983 - val_loss: 0.1756 - val_accuracy: 0.9535
Epoch 115/1000
295/295 - 158s - loss: 0.0031 - accuracy: 0.9988 - val_loss: 0.1682 - val_accuracy: 0.9578
Epoch 116/1000
295/295 - 153s - loss: 0.0032 - accuracy: 0.9988 - val_loss: 0.1745 - val_accuracy: 0.9583
Epoch 117/1000
295/295 - 155s - loss: 0.0029 - accuracy: 0.9988 - val_loss: 0.1776 - val_accuracy: 0.9581
Epoch 118/1000
295/295 - 154s - loss: 0.0036 - accuracy: 0.9985 - val_loss: 0.1933 - val_accuracy: 0.9535
Epoch 119/1000
295/295 - 155s - loss: 0.0034 - accuracy: 0.9985 - val_loss: 0.1777 - val_accuracy: 0.9545
Epoch 120/1000
295/295 - 154s - loss: 0.0034 - accuracy: 0.9985 - val_loss: 0.1728 - val_accuracy: 0.9578
Epoch 121/1000
295/295 - 155s - loss: 0.0032 - accuracy: 0.9988 - val_loss: 0.1767 - val_accuracy: 0.9581
Epoch 122/1000
295/295 - 154s - loss: 0.0033 - accuracy: 0.9986 - val_loss: 0.2091 - val_accuracy: 0.9540
Epoch 123/1000
295/295 - 153s - loss: 0.0042 - accuracy: 0.9985 - val_loss: 0.1711 - val_accuracy: 0.9588
Epoch 124/1000
295/295 - 155s - loss: 0.0029 - accuracy: 0.9988 - val_loss: 0.1892 - val_accuracy: 0.9588
Epoch 125/1000
295/295 - 154s - loss: 0.0028 - accuracy: 0.9987 - val_loss: 0.1927 - val_accuracy: 0.9564
Epoch 126/1000
295/295 - 155s - loss: 0.0033 - accuracy: 0.9986 - val_loss: 0.1806 - val_accuracy: 0.9591
Epoch 127/1000
295/295 - 156s - loss: 0.0029 - accuracy: 0.9987 - val_loss: 0.2042 - val_accuracy: 0.9523
Epoch 128/1000
295/295 - 153s - loss: 0.0040 - accuracy: 0.9984 - val_loss: 0.1991 - val_accuracy: 0.9554
2021-10-25 17:56:28.493487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 17:56:28.493593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 17:56:28.493714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 17:56:28.493916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 17:56:28.493938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 17:56:28.493955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 17:56:28.493972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 17:56:28.494750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 17:56:28.494848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'DenseNet121_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'DenseNet121', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\DenseNet121_VISOB_left_aug_gender_base_F75M25.06-0.3507.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
densenet121 (Functional)     (None, 5, 7, 1024)        7037504   
_________________________________________________________________
global_average_pooling2d_10  (None, 1024)              0         
_________________________________________________________________
dense_20 (Dense)             (None, 1024)              1049600   
_________________________________________________________________
batch_normalization_311 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_10 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_307 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_21 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 8,092,225
Trainable params: 1,052,673
Non-trainable params: 7,039,552
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\DenseNet121_VISOB_left_aug_gender_base_F75M25.06-0.3507.hdf5
Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
densenet121 (Functional)     (None, 5, 7, 1024)        7037504   
_________________________________________________________________
global_average_pooling2d_10  (None, 1024)              0         
_________________________________________________________________
dense_20 (Dense)             (None, 1024)              1049600   
_________________________________________________________________
batch_normalization_311 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_10 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_307 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_21 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 8,092,225
Trainable params: 8,006,529
Non-trainable params: 85,696
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 17:58:14.953601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 17:58:18.377861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\enrollments_rgb\\3137_1007_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\enrollments_rgb\\2512_1005_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\3417_1009_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\2384_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\verifications_rgb\\3365_1006_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 260s - loss: 0.3828 - accuracy: 0.8293 - val_loss: 0.3140 - val_accuracy: 0.8556
Epoch 2/1000
295/295 - 87s - loss: 0.1817 - accuracy: 0.9248 - val_loss: 0.3042 - val_accuracy: 0.8626
Epoch 3/1000
295/295 - 85s - loss: 0.1034 - accuracy: 0.9632 - val_loss: 0.2746 - val_accuracy: 0.8861
Epoch 4/1000
295/295 - 87s - loss: 0.0575 - accuracy: 0.9849 - val_loss: 0.2824 - val_accuracy: 0.8912
Epoch 5/1000
295/295 - 87s - loss: 0.0349 - accuracy: 0.9923 - val_loss: 0.2888 - val_accuracy: 0.8929
Epoch 6/1000
295/295 - 88s - loss: 0.0286 - accuracy: 0.9928 - val_loss: 0.2909 - val_accuracy: 0.8985
Epoch 7/1000
295/295 - 86s - loss: 0.0202 - accuracy: 0.9952 - val_loss: 0.3088 - val_accuracy: 0.8946
Epoch 8/1000
295/295 - 87s - loss: 0.0166 - accuracy: 0.9958 - val_loss: 0.3239 - val_accuracy: 0.8953
Epoch 9/1000
295/295 - 86s - loss: 0.0139 - accuracy: 0.9966 - val_loss: 0.3413 - val_accuracy: 0.8939
Epoch 10/1000
295/295 - 87s - loss: 0.0155 - accuracy: 0.9957 - val_loss: 0.3438 - val_accuracy: 0.8924
Epoch 11/1000
295/295 - 87s - loss: 0.0161 - accuracy: 0.9951 - val_loss: 0.3473 - val_accuracy: 0.8973
Epoch 12/1000
295/295 - 86s - loss: 0.0156 - accuracy: 0.9950 - val_loss: 0.3603 - val_accuracy: 0.8978
Epoch 13/1000
295/295 - 87s - loss: 0.0221 - accuracy: 0.9926 - val_loss: 0.3905 - val_accuracy: 0.8922
Epoch 14/1000
295/295 - 87s - loss: 0.0201 - accuracy: 0.9931 - val_loss: 0.3790 - val_accuracy: 0.8975
Epoch 15/1000
295/295 - 87s - loss: 0.0169 - accuracy: 0.9948 - val_loss: 0.3090 - val_accuracy: 0.9082
Epoch 16/1000
295/295 - 87s - loss: 0.0138 - accuracy: 0.9953 - val_loss: 0.3136 - val_accuracy: 0.9104
Epoch 17/1000
295/295 - 87s - loss: 0.0132 - accuracy: 0.9953 - val_loss: 0.3240 - val_accuracy: 0.9111
Epoch 18/1000
295/295 - 87s - loss: 0.0098 - accuracy: 0.9967 - val_loss: 0.3474 - val_accuracy: 0.9036
Epoch 19/1000
295/295 - 86s - loss: 0.0105 - accuracy: 0.9966 - val_loss: 0.3430 - val_accuracy: 0.9062
Epoch 20/1000
295/295 - 86s - loss: 0.0100 - accuracy: 0.9966 - val_loss: 0.3730 - val_accuracy: 0.9072
Epoch 21/1000
295/295 - 87s - loss: 0.0135 - accuracy: 0.9949 - val_loss: 0.4026 - val_accuracy: 0.8992
Epoch 22/1000
295/295 - 87s - loss: 0.0177 - accuracy: 0.9935 - val_loss: 0.3346 - val_accuracy: 0.9130
Epoch 23/1000
295/295 - 87s - loss: 0.0195 - accuracy: 0.9934 - val_loss: 0.3304 - val_accuracy: 0.9121
2021-10-25 18:33:20.281378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 18:33:20.281465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 18:33:20.281570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 18:33:20.281745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 18:33:20.281764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 18:33:20.281780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 18:33:20.281795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 18:33:20.282147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 18:33:20.282231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [96, 128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
Running... {'run_id': 'MobileNetV2_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'MobileNetV2', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\MobileNetV2_VISOB_left_aug_gender_base_F75M25.05-0.3728.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_11"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
mobilenetv2_1.00_224 (Functi (None, 5, 8, 1280)        2257984   
_________________________________________________________________
global_average_pooling2d_11  (None, 1280)              0         
_________________________________________________________________
dense_22 (Dense)             (None, 1024)              1311744   
_________________________________________________________________
batch_normalization_312 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_11 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_308 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_23 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 3,574,849
Trainable params: 1,314,817
Non-trainable params: 2,260,032
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\MobileNetV2_VISOB_left_aug_gender_base_F75M25.05-0.3728.hdf5
Model: "sequential_11"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
mobilenetv2_1.00_224 (Functi (None, 5, 8, 1280)        2257984   
_________________________________________________________________
global_average_pooling2d_11  (None, 1280)              0         
_________________________________________________________________
dense_22 (Dense)             (None, 1024)              1311744   
_________________________________________________________________
batch_normalization_312 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_11 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_308 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_23 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 3,574,849
Trainable params: 3,538,689
Non-trainable params: 36,160
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 18:34:27.761487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 18:34:31.132425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\verifications_rgb\\3410_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\enrollments_rgb\\3371_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\3295_1006_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3328_1004_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3375_1005_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 179s - loss: 0.4365 - accuracy: 0.8010 - val_loss: 0.5669 - val_accuracy: 0.7599
Epoch 2/1000
295/295 - 55s - loss: 0.2747 - accuracy: 0.8765 - val_loss: 0.3765 - val_accuracy: 0.8338
Epoch 3/1000
295/295 - 56s - loss: 0.2041 - accuracy: 0.9140 - val_loss: 0.3637 - val_accuracy: 0.8474
Epoch 4/1000
295/295 - 56s - loss: 0.1546 - accuracy: 0.9399 - val_loss: 0.3656 - val_accuracy: 0.8522
Epoch 5/1000
295/295 - 56s - loss: 0.1153 - accuracy: 0.9581 - val_loss: 0.3247 - val_accuracy: 0.8709
Epoch 6/1000
295/295 - 55s - loss: 0.0821 - accuracy: 0.9740 - val_loss: 0.3314 - val_accuracy: 0.8735
Epoch 7/1000
295/295 - 54s - loss: 0.0593 - accuracy: 0.9835 - val_loss: 0.3396 - val_accuracy: 0.8748
Epoch 8/1000
295/295 - 55s - loss: 0.0470 - accuracy: 0.9875 - val_loss: 0.3570 - val_accuracy: 0.8791
Epoch 9/1000
295/295 - 55s - loss: 0.0379 - accuracy: 0.9897 - val_loss: 0.3626 - val_accuracy: 0.8789
Epoch 10/1000
295/295 - 56s - loss: 0.0298 - accuracy: 0.9919 - val_loss: 0.3657 - val_accuracy: 0.8791
Epoch 11/1000
295/295 - 55s - loss: 0.0278 - accuracy: 0.9916 - val_loss: 0.3757 - val_accuracy: 0.8779
Epoch 12/1000
295/295 - 55s - loss: 0.0211 - accuracy: 0.9942 - val_loss: 0.4057 - val_accuracy: 0.8767
Epoch 13/1000
295/295 - 55s - loss: 0.0208 - accuracy: 0.9938 - val_loss: 0.3926 - val_accuracy: 0.8823
Epoch 14/1000
295/295 - 55s - loss: 0.0217 - accuracy: 0.9936 - val_loss: 0.3842 - val_accuracy: 0.8864
Epoch 15/1000
295/295 - 55s - loss: 0.0177 - accuracy: 0.9947 - val_loss: 0.4258 - val_accuracy: 0.8825
Epoch 16/1000
295/295 - 55s - loss: 0.0184 - accuracy: 0.9944 - val_loss: 0.4721 - val_accuracy: 0.8767
Epoch 17/1000
295/295 - 55s - loss: 0.0165 - accuracy: 0.9950 - val_loss: 0.4398 - val_accuracy: 0.8830
Epoch 18/1000
295/295 - 55s - loss: 0.0153 - accuracy: 0.9951 - val_loss: 0.4207 - val_accuracy: 0.8828
Epoch 19/1000
295/295 - 56s - loss: 0.0189 - accuracy: 0.9929 - val_loss: 0.4629 - val_accuracy: 0.8769
Epoch 20/1000
295/295 - 55s - loss: 0.0132 - accuracy: 0.9957 - val_loss: 0.4438 - val_accuracy: 0.8924
Epoch 21/1000
295/295 - 55s - loss: 0.0129 - accuracy: 0.9957 - val_loss: 0.5094 - val_accuracy: 0.8847
Epoch 22/1000
295/295 - 55s - loss: 0.0144 - accuracy: 0.9953 - val_loss: 0.4386 - val_accuracy: 0.8905
Epoch 23/1000
295/295 - 55s - loss: 0.0176 - accuracy: 0.9942 - val_loss: 0.4384 - val_accuracy: 0.8883
Epoch 24/1000
295/295 - 57s - loss: 0.0123 - accuracy: 0.9955 - val_loss: 0.4432 - val_accuracy: 0.8835
Epoch 25/1000
295/295 - 57s - loss: 0.0132 - accuracy: 0.9954 - val_loss: 0.4730 - val_accuracy: 0.8847
2021-10-25 18:59:06.732031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 18:59:06.732128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 18:59:06.732248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 18:59:06.732455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 18:59:06.732477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 18:59:06.732494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 18:59:06.732512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 18:59:06.732903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 18:59:06.733001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'InceptionV3_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'InceptionV3', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\InceptionV3_VISOB_left_aug_gender_base_F75M25.05-0.4422.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_12"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
inception_v3 (Functional)    (None, 3, 6, 2048)        21802784  
_________________________________________________________________
global_average_pooling2d_12  (None, 2048)              0         
_________________________________________________________________
dense_24 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_407 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_12 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_403 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_25 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 23,906,081
Trainable params: 2,101,249
Non-trainable params: 21,804,832
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\InceptionV3_VISOB_left_aug_gender_base_F75M25.05-0.4422.hdf5
Model: "sequential_12"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
inception_v3 (Functional)    (None, 3, 6, 2048)        21802784  
_________________________________________________________________
global_average_pooling2d_12  (None, 2048)              0         
_________________________________________________________________
dense_24 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_407 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_12 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_403 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_25 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 23,906,081
Trainable params: 23,869,601
Non-trainable params: 36,480
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 19:00:37.013833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 19:00:37.755495: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 180 of 1024
2021-10-25 19:00:41.716007: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\samsung_day_light_short\\samsung_day_light_short\\verifications_rgb\\3400_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\3142_1010_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_dim_light_short\\samsung_dim_light_short\\verifications_rgb\\3367_1004_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\3139_1007_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3346_1008_l_c.png' 1
Image shape:  (160, 240, 3)
Label:  0
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 265s - loss: 0.4606 - accuracy: 0.7942 - val_loss: 0.3721 - val_accuracy: 0.8341
Epoch 2/1000
295/295 - 75s - loss: 0.2277 - accuracy: 0.9001 - val_loss: 0.3573 - val_accuracy: 0.8493
Epoch 3/1000
295/295 - 74s - loss: 0.1233 - accuracy: 0.9541 - val_loss: 0.3664 - val_accuracy: 0.8544
Epoch 4/1000
295/295 - 76s - loss: 0.0740 - accuracy: 0.9751 - val_loss: 0.3692 - val_accuracy: 0.8658
Epoch 5/1000
295/295 - 76s - loss: 0.0501 - accuracy: 0.9841 - val_loss: 0.3901 - val_accuracy: 0.8702
Epoch 6/1000
295/295 - 77s - loss: 0.0390 - accuracy: 0.9871 - val_loss: 0.4406 - val_accuracy: 0.8571
Epoch 7/1000
295/295 - 77s - loss: 0.0331 - accuracy: 0.9885 - val_loss: 0.3732 - val_accuracy: 0.8815
Epoch 8/1000
295/295 - 76s - loss: 0.0284 - accuracy: 0.9903 - val_loss: 0.4672 - val_accuracy: 0.8646
Epoch 9/1000
295/295 - 76s - loss: 0.0293 - accuracy: 0.9897 - val_loss: 0.4380 - val_accuracy: 0.8733
Epoch 10/1000
295/295 - 76s - loss: 0.0303 - accuracy: 0.9896 - val_loss: 0.4239 - val_accuracy: 0.8832
Epoch 11/1000
295/295 - 76s - loss: 0.0280 - accuracy: 0.9898 - val_loss: 0.4833 - val_accuracy: 0.8675
Epoch 12/1000
295/295 - 77s - loss: 0.0311 - accuracy: 0.9881 - val_loss: 0.4273 - val_accuracy: 0.8864
Epoch 13/1000
295/295 - 76s - loss: 0.0273 - accuracy: 0.9901 - val_loss: 0.4320 - val_accuracy: 0.8825
Epoch 14/1000
295/295 - 77s - loss: 0.0253 - accuracy: 0.9910 - val_loss: 0.4064 - val_accuracy: 0.8900
Epoch 15/1000
295/295 - 77s - loss: 0.0262 - accuracy: 0.9899 - val_loss: 0.4477 - val_accuracy: 0.8905
Epoch 16/1000
295/295 - 77s - loss: 0.0257 - accuracy: 0.9908 - val_loss: 0.4581 - val_accuracy: 0.8927
Epoch 17/1000
295/295 - 76s - loss: 0.0229 - accuracy: 0.9915 - val_loss: 0.4565 - val_accuracy: 0.8842
Epoch 18/1000
295/295 - 75s - loss: 0.0180 - accuracy: 0.9934 - val_loss: 0.4008 - val_accuracy: 0.9009
Epoch 19/1000
295/295 - 76s - loss: 0.0158 - accuracy: 0.9950 - val_loss: 0.4198 - val_accuracy: 0.8961
Epoch 20/1000
295/295 - 76s - loss: 0.0197 - accuracy: 0.9931 - val_loss: 0.4525 - val_accuracy: 0.8978
Epoch 21/1000
295/295 - 76s - loss: 0.0187 - accuracy: 0.9927 - val_loss: 0.4346 - val_accuracy: 0.8973
Epoch 22/1000
295/295 - 78s - loss: 0.0180 - accuracy: 0.9933 - val_loss: 0.4915 - val_accuracy: 0.8975
2021-10-25 19:30:54.706951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 19:30:54.706989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 19:30:54.707090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 19:30:54.707157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 19:30:54.707165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 19:30:54.707171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 19:30:54.707175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 19:30:54.707375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 19:30:54.707408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'InceptionResNetV2_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'InceptionResNetV2', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\InceptionResNetV2_VISOB_left_aug_gender_base_F75M25.03-0.4139.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
inception_resnet_v2 (Functio (None, 3, 6, 1536)        54336736  
_________________________________________________________________
global_average_pooling2d_13  (None, 1536)              0         
_________________________________________________________________
dense_26 (Dense)             (None, 1024)              1573888   
_________________________________________________________________
batch_normalization_611 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_13 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_607 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_27 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 55,915,745
Trainable params: 1,576,961
Non-trainable params: 54,338,784
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\InceptionResNetV2_VISOB_left_aug_gender_base_F75M25.03-0.4139.hdf5
Model: "sequential_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
inception_resnet_v2 (Functio (None, 3, 6, 1536)        54336736  
_________________________________________________________________
global_average_pooling2d_13  (None, 1536)              0         
_________________________________________________________________
dense_26 (Dense)             (None, 1024)              1573888   
_________________________________________________________________
batch_normalization_611 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_13 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_607 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_27 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 55,915,745
Trainable params: 55,853,153
Non-trainable params: 62,592
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 19:34:22.489888: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 19:34:22.489969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2 of 1024
2021-10-25 19:34:22.501050: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3 of 1024
2021-10-25 19:34:22.540909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 4 of 1024
2021-10-25 19:34:22.642129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 5 of 1024
2021-10-25 19:34:22.642198: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 6 of 1024
2021-10-25 19:34:28.529954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 383 of 1024
2021-10-25 19:34:38.540200: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 979 of 1024
2021-10-25 19:34:39.409409: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-10-25 19:40:57.981332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 739 of 1024
2021-10-25 19:41:03.601321: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\enrollments_rgb\\3438_1002_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_day_light_short\\oppo_day_light_short\\verifications_rgb\\3390_1003_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\3292_1002_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3409_1008_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\enrollments_rgb\\3558_1001_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  1
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 647s - loss: 0.4206 - accuracy: 0.8061 - val_loss: 0.3611 - val_accuracy: 0.8421
Epoch 2/1000
295/295 - 189s - loss: 0.1993 - accuracy: 0.9168 - val_loss: 0.3310 - val_accuracy: 0.8677
Epoch 3/1000
295/295 - 187s - loss: 0.0983 - accuracy: 0.9655 - val_loss: 0.3323 - val_accuracy: 0.8745
Epoch 4/1000
295/295 - 189s - loss: 0.0455 - accuracy: 0.9863 - val_loss: 0.3571 - val_accuracy: 0.8760
Epoch 5/1000
295/295 - 190s - loss: 0.0303 - accuracy: 0.9907 - val_loss: 0.3460 - val_accuracy: 0.8794
Epoch 6/1000
295/295 - 190s - loss: 0.0225 - accuracy: 0.9933 - val_loss: 0.3760 - val_accuracy: 0.8871
Epoch 7/1000
295/295 - 186s - loss: 0.0250 - accuracy: 0.9919 - val_loss: 0.5127 - val_accuracy: 0.8844
Epoch 8/1000
295/295 - 188s - loss: 0.0199 - accuracy: 0.9937 - val_loss: 0.5000 - val_accuracy: 0.8961
Epoch 9/1000
295/295 - 186s - loss: 0.0255 - accuracy: 0.9906 - val_loss: 0.4517 - val_accuracy: 0.8861
Epoch 10/1000
295/295 - 188s - loss: 0.0251 - accuracy: 0.9908 - val_loss: 0.4393 - val_accuracy: 0.8905
Epoch 11/1000
295/295 - 189s - loss: 0.0253 - accuracy: 0.9911 - val_loss: 0.6795 - val_accuracy: 0.8883
Epoch 12/1000
295/295 - 188s - loss: 0.0227 - accuracy: 0.9914 - val_loss: 0.4621 - val_accuracy: 0.9029
Epoch 13/1000
295/295 - 191s - loss: 0.0156 - accuracy: 0.9943 - val_loss: 0.4957 - val_accuracy: 0.8934
Epoch 14/1000
295/295 - 188s - loss: 0.0169 - accuracy: 0.9944 - val_loss: 0.3879 - val_accuracy: 0.8958
Epoch 15/1000
295/295 - 190s - loss: 0.0159 - accuracy: 0.9945 - val_loss: 0.3863 - val_accuracy: 0.9004
Epoch 16/1000
295/295 - 188s - loss: 0.0169 - accuracy: 0.9937 - val_loss: 0.4185 - val_accuracy: 0.9043
Epoch 17/1000
295/295 - 189s - loss: 0.0170 - accuracy: 0.9944 - val_loss: 0.4373 - val_accuracy: 0.8956
Epoch 18/1000
295/295 - 189s - loss: 0.0183 - accuracy: 0.9936 - val_loss: 0.4128 - val_accuracy: 0.9036
Epoch 19/1000
295/295 - 190s - loss: 0.0147 - accuracy: 0.9946 - val_loss: 0.4014 - val_accuracy: 0.9079
Epoch 20/1000
295/295 - 190s - loss: 0.0114 - accuracy: 0.9959 - val_loss: 0.4027 - val_accuracy: 0.9060
Epoch 21/1000
295/295 - 189s - loss: 0.0148 - accuracy: 0.9952 - val_loss: 0.4315 - val_accuracy: 0.9092
Epoch 22/1000
295/295 - 189s - loss: 0.0132 - accuracy: 0.9951 - val_loss: 0.4606 - val_accuracy: 0.9121
2021-10-25 20:48:34.021178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 20:48:34.021279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 20:48:34.021402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 20:48:34.021604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 20:48:34.021627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 20:48:34.021646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 20:48:34.021663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 20:48:34.022058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 20:48:34.022158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'ResNet50_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'ResNet50', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\ResNet50_VISOB_left_aug_gender_base_F75M25.07-0.3339.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_14"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
resnet50 (Functional)        (None, 5, 8, 2048)        23587712  
_________________________________________________________________
global_average_pooling2d_14  (None, 2048)              0         
_________________________________________________________________
dense_28 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_612 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_14 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_608 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_29 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 25,691,009
Trainable params: 2,101,249
Non-trainable params: 23,589,760
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\ResNet50_VISOB_left_aug_gender_base_F75M25.07-0.3339.hdf5
Model: "sequential_14"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
resnet50 (Functional)        (None, 5, 8, 2048)        23587712  
_________________________________________________________________
global_average_pooling2d_14  (None, 2048)              0         
_________________________________________________________________
dense_28 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_612 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_14 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_608 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_29 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 25,691,009
Trainable params: 25,635,841
Non-trainable params: 55,168
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 20:50:02.086183: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 20:50:02.086230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2 of 1024
2021-10-25 20:50:08.018376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\2949_1001_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3202_1004_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3467_1005_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3267_1005_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\verifications_rgb\\2530_1002_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  1
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 268s - loss: 0.3677 - accuracy: 0.8488 - val_loss: 0.3222 - val_accuracy: 0.8719
Epoch 2/1000
295/295 - 67s - loss: 0.1078 - accuracy: 0.9621 - val_loss: 0.3416 - val_accuracy: 0.8665
Epoch 3/1000
295/295 - 66s - loss: 0.0470 - accuracy: 0.9866 - val_loss: 0.2930 - val_accuracy: 0.8970
Epoch 4/1000
295/295 - 67s - loss: 0.0292 - accuracy: 0.9923 - val_loss: 0.2934 - val_accuracy: 0.8983
Epoch 5/1000
295/295 - 67s - loss: 0.0195 - accuracy: 0.9953 - val_loss: 0.3782 - val_accuracy: 0.8767
Epoch 6/1000
295/295 - 66s - loss: 0.0185 - accuracy: 0.9943 - val_loss: 0.3190 - val_accuracy: 0.9004
Epoch 7/1000
295/295 - 67s - loss: 0.0174 - accuracy: 0.9951 - val_loss: 0.4080 - val_accuracy: 0.8813
Epoch 8/1000
295/295 - 66s - loss: 0.0216 - accuracy: 0.9931 - val_loss: 0.3996 - val_accuracy: 0.8801
Epoch 9/1000
295/295 - 67s - loss: 0.0282 - accuracy: 0.9903 - val_loss: 0.3560 - val_accuracy: 0.8944
Epoch 10/1000
295/295 - 67s - loss: 0.0235 - accuracy: 0.9921 - val_loss: 0.3653 - val_accuracy: 0.8912
Epoch 11/1000
295/295 - 66s - loss: 0.0222 - accuracy: 0.9926 - val_loss: 0.3010 - val_accuracy: 0.9041
Epoch 12/1000
295/295 - 66s - loss: 0.0137 - accuracy: 0.9955 - val_loss: 0.3170 - val_accuracy: 0.9070
Epoch 13/1000
295/295 - 66s - loss: 0.0145 - accuracy: 0.9952 - val_loss: 0.3242 - val_accuracy: 0.9113
Epoch 14/1000
295/295 - 66s - loss: 0.0203 - accuracy: 0.9933 - val_loss: 0.3401 - val_accuracy: 0.9041
Epoch 15/1000
295/295 - 67s - loss: 0.0233 - accuracy: 0.9916 - val_loss: 0.3274 - val_accuracy: 0.9031
Epoch 16/1000
295/295 - 66s - loss: 0.0136 - accuracy: 0.9952 - val_loss: 0.3044 - val_accuracy: 0.9152
Epoch 17/1000
295/295 - 66s - loss: 0.0111 - accuracy: 0.9968 - val_loss: 0.3035 - val_accuracy: 0.9169
Epoch 18/1000
295/295 - 66s - loss: 0.0097 - accuracy: 0.9964 - val_loss: 0.4372 - val_accuracy: 0.8898
Epoch 19/1000
295/295 - 66s - loss: 0.0159 - accuracy: 0.9946 - val_loss: 0.3377 - val_accuracy: 0.9111
Epoch 20/1000
295/295 - 66s - loss: 0.0172 - accuracy: 0.9942 - val_loss: 0.3625 - val_accuracy: 0.9067
Epoch 21/1000
295/295 - 67s - loss: 0.0129 - accuracy: 0.9960 - val_loss: 0.4176 - val_accuracy: 0.8881
Epoch 22/1000
295/295 - 67s - loss: 0.0097 - accuracy: 0.9966 - val_loss: 0.3248 - val_accuracy: 0.9106
Epoch 23/1000
295/295 - 68s - loss: 0.0105 - accuracy: 0.9967 - val_loss: 0.3300 - val_accuracy: 0.9193
2021-10-25 21:18:03.679588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 21:18:03.679628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 21:18:03.679667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 21:18:03.679734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 21:18:03.679740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 21:18:03.679745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 21:18:03.679749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 21:18:03.679956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 21:18:03.679988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'VGG19_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'VGG19', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\VGG19_VISOB_left_aug_gender_base_F75M25.15-0.3294.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_15"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
vgg19 (Functional)           (None, 5, 7, 512)         20024384  
_________________________________________________________________
global_average_pooling2d_15  (None, 512)               0         
_________________________________________________________________
dense_30 (Dense)             (None, 1024)              525312    
_________________________________________________________________
batch_normalization_613 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_15 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_609 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_31 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 20,554,817
Trainable params: 528,385
Non-trainable params: 20,026,432
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\VGG19_VISOB_left_aug_gender_base_F75M25.15-0.3294.hdf5
Model: "sequential_15"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
vgg19 (Functional)           (None, 5, 7, 512)         20024384  
_________________________________________________________________
global_average_pooling2d_15  (None, 512)               0         
_________________________________________________________________
dense_30 (Dense)             (None, 1024)              525312    
_________________________________________________________________
batch_normalization_613 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_15 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_609 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_31 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 20,554,817
Trainable params: 20,552,769
Non-trainable params: 2,048
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 21:18:54.116759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 21:18:54.140861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2 of 1024
2021-10-25 21:18:58.929032: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-10-25 21:22:16.852061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1002 of 1024
2021-10-25 21:22:17.029064: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\verifications_rgb\\3234_1003_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\verifications_rgb\\3253_1007_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_office_light_short\\oppo_office_light_short\\verifications_rgb\\3477_1003_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3274_1002_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\2945_1001_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  1
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 279s - loss: 0.3558 - accuracy: 0.8462 - val_loss: 0.3087 - val_accuracy: 0.8595
Epoch 2/1000
295/295 - 57s - loss: 0.2175 - accuracy: 0.9067 - val_loss: 0.3432 - val_accuracy: 0.8532
Epoch 3/1000
295/295 - 58s - loss: 0.1551 - accuracy: 0.9356 - val_loss: 0.2531 - val_accuracy: 0.9062
Epoch 4/1000
295/295 - 58s - loss: 0.1079 - accuracy: 0.9577 - val_loss: 0.3244 - val_accuracy: 0.8920
Epoch 5/1000
295/295 - 59s - loss: 0.0774 - accuracy: 0.9724 - val_loss: 0.3489 - val_accuracy: 0.8949
Epoch 6/1000
295/295 - 58s - loss: 0.0607 - accuracy: 0.9782 - val_loss: 0.2084 - val_accuracy: 0.9256
Epoch 7/1000
295/295 - 58s - loss: 0.0505 - accuracy: 0.9826 - val_loss: 0.2455 - val_accuracy: 0.9138
Epoch 8/1000
295/295 - 58s - loss: 0.0422 - accuracy: 0.9849 - val_loss: 0.2351 - val_accuracy: 0.9213
Epoch 9/1000
295/295 - 58s - loss: 0.0371 - accuracy: 0.9863 - val_loss: 0.3020 - val_accuracy: 0.9135
Epoch 10/1000
295/295 - 58s - loss: 0.0393 - accuracy: 0.9865 - val_loss: 0.2209 - val_accuracy: 0.9290
Epoch 11/1000
295/295 - 58s - loss: 0.0341 - accuracy: 0.9889 - val_loss: 0.2063 - val_accuracy: 0.9283
Epoch 12/1000
295/295 - 58s - loss: 0.0251 - accuracy: 0.9910 - val_loss: 0.3051 - val_accuracy: 0.9104
Epoch 13/1000
295/295 - 58s - loss: 0.0289 - accuracy: 0.9896 - val_loss: 0.2233 - val_accuracy: 0.9356
Epoch 14/1000
295/295 - 58s - loss: 0.0342 - accuracy: 0.9873 - val_loss: 0.2204 - val_accuracy: 0.9273
Epoch 15/1000
295/295 - 58s - loss: 0.0251 - accuracy: 0.9909 - val_loss: 0.2230 - val_accuracy: 0.9324
Epoch 16/1000
295/295 - 58s - loss: 0.0191 - accuracy: 0.9928 - val_loss: 0.2777 - val_accuracy: 0.9179
Epoch 17/1000
295/295 - 58s - loss: 0.0304 - accuracy: 0.9892 - val_loss: 0.2215 - val_accuracy: 0.9334
Epoch 18/1000
295/295 - 58s - loss: 0.0268 - accuracy: 0.9900 - val_loss: 0.2670 - val_accuracy: 0.9225
Epoch 19/1000
295/295 - 58s - loss: 0.0237 - accuracy: 0.9919 - val_loss: 0.3021 - val_accuracy: 0.9159
Epoch 20/1000
295/295 - 58s - loss: 0.0153 - accuracy: 0.9945 - val_loss: 0.5306 - val_accuracy: 0.8767
Epoch 21/1000
295/295 - 58s - loss: 0.0185 - accuracy: 0.9936 - val_loss: 0.2229 - val_accuracy: 0.9414
Epoch 22/1000
295/295 - 58s - loss: 0.0166 - accuracy: 0.9941 - val_loss: 0.2489 - val_accuracy: 0.9319
Epoch 23/1000
295/295 - 58s - loss: 0.0284 - accuracy: 0.9898 - val_loss: 0.3185 - val_accuracy: 0.9208
Epoch 24/1000
295/295 - 58s - loss: 0.0212 - accuracy: 0.9925 - val_loss: 0.2719 - val_accuracy: 0.9203
Epoch 25/1000
295/295 - 58s - loss: 0.0152 - accuracy: 0.9947 - val_loss: 0.2132 - val_accuracy: 0.9443
Epoch 26/1000
295/295 - 58s - loss: 0.0127 - accuracy: 0.9954 - val_loss: 0.2445 - val_accuracy: 0.9348
Epoch 27/1000
295/295 - 58s - loss: 0.0203 - accuracy: 0.9929 - val_loss: 0.1993 - val_accuracy: 0.9406
Epoch 28/1000
295/295 - 58s - loss: 0.0176 - accuracy: 0.9935 - val_loss: 0.3031 - val_accuracy: 0.9138
Epoch 29/1000
295/295 - 58s - loss: 0.0161 - accuracy: 0.9941 - val_loss: 0.3116 - val_accuracy: 0.9191
Epoch 30/1000
295/295 - 58s - loss: 0.0085 - accuracy: 0.9974 - val_loss: 0.3015 - val_accuracy: 0.9273
Epoch 31/1000
295/295 - 58s - loss: 0.0153 - accuracy: 0.9944 - val_loss: 0.2674 - val_accuracy: 0.9215
Epoch 32/1000
295/295 - 58s - loss: 0.0218 - accuracy: 0.9914 - val_loss: 0.3260 - val_accuracy: 0.9283
Epoch 33/1000
295/295 - 58s - loss: 0.0156 - accuracy: 0.9943 - val_loss: 0.1948 - val_accuracy: 0.9416
Epoch 34/1000
295/295 - 58s - loss: 0.0125 - accuracy: 0.9955 - val_loss: 0.2322 - val_accuracy: 0.9399
Epoch 35/1000
295/295 - 58s - loss: 0.0147 - accuracy: 0.9940 - val_loss: 0.2288 - val_accuracy: 0.9373
Epoch 36/1000
295/295 - 58s - loss: 0.0136 - accuracy: 0.9943 - val_loss: 0.2437 - val_accuracy: 0.9293
Epoch 37/1000
295/295 - 58s - loss: 0.0127 - accuracy: 0.9953 - val_loss: 0.2385 - val_accuracy: 0.9419
Epoch 38/1000
295/295 - 58s - loss: 0.0102 - accuracy: 0.9962 - val_loss: 0.2009 - val_accuracy: 0.9431
Epoch 39/1000
295/295 - 58s - loss: 0.0138 - accuracy: 0.9950 - val_loss: 0.4461 - val_accuracy: 0.9181
Epoch 40/1000
295/295 - 58s - loss: 0.0148 - accuracy: 0.9941 - val_loss: 0.1998 - val_accuracy: 0.9416
Epoch 41/1000
295/295 - 58s - loss: 0.0184 - accuracy: 0.9927 - val_loss: 0.2198 - val_accuracy: 0.9336
Epoch 42/1000
295/295 - 58s - loss: 0.0152 - accuracy: 0.9944 - val_loss: 0.2710 - val_accuracy: 0.9285
Epoch 43/1000
295/295 - 58s - loss: 0.0108 - accuracy: 0.9963 - val_loss: 0.4699 - val_accuracy: 0.9021
Epoch 44/1000
295/295 - 58s - loss: 0.0064 - accuracy: 0.9972 - val_loss: 0.1934 - val_accuracy: 0.9499
Epoch 45/1000
295/295 - 58s - loss: 0.0055 - accuracy: 0.9981 - val_loss: 0.1961 - val_accuracy: 0.9472
Epoch 46/1000
295/295 - 58s - loss: 0.0168 - accuracy: 0.9936 - val_loss: 0.6624 - val_accuracy: 0.8818
Epoch 47/1000
295/295 - 58s - loss: 0.0158 - accuracy: 0.9945 - val_loss: 0.2656 - val_accuracy: 0.9324
Epoch 48/1000
295/295 - 58s - loss: 0.0088 - accuracy: 0.9971 - val_loss: 0.2287 - val_accuracy: 0.9358
Epoch 49/1000
295/295 - 58s - loss: 0.0089 - accuracy: 0.9962 - val_loss: 0.4257 - val_accuracy: 0.9179
Epoch 50/1000
295/295 - 58s - loss: 0.0090 - accuracy: 0.9967 - val_loss: 0.2158 - val_accuracy: 0.9411
Epoch 51/1000
295/295 - 58s - loss: 0.0150 - accuracy: 0.9951 - val_loss: 0.3404 - val_accuracy: 0.9254
Epoch 52/1000
295/295 - 58s - loss: 0.0119 - accuracy: 0.9952 - val_loss: 0.2249 - val_accuracy: 0.9423
Epoch 53/1000
295/295 - 58s - loss: 0.0038 - accuracy: 0.9983 - val_loss: 0.1867 - val_accuracy: 0.9501
Epoch 54/1000
295/295 - 58s - loss: 0.0092 - accuracy: 0.9962 - val_loss: 0.2707 - val_accuracy: 0.9353
Epoch 55/1000
295/295 - 58s - loss: 0.0134 - accuracy: 0.9951 - val_loss: 0.2158 - val_accuracy: 0.9472
Epoch 56/1000
295/295 - 58s - loss: 0.0130 - accuracy: 0.9949 - val_loss: 0.2618 - val_accuracy: 0.9370
Epoch 57/1000
295/295 - 58s - loss: 0.0078 - accuracy: 0.9968 - val_loss: 0.3291 - val_accuracy: 0.9331
Epoch 58/1000
295/295 - 58s - loss: 0.0145 - accuracy: 0.9943 - val_loss: 0.2181 - val_accuracy: 0.9450
Epoch 59/1000
295/295 - 58s - loss: 0.0053 - accuracy: 0.9981 - val_loss: 0.2143 - val_accuracy: 0.9489
Epoch 60/1000
295/295 - 58s - loss: 0.0060 - accuracy: 0.9977 - val_loss: 0.3558 - val_accuracy: 0.9244
Epoch 61/1000
295/295 - 58s - loss: 0.0133 - accuracy: 0.9950 - val_loss: 0.2637 - val_accuracy: 0.9353
Epoch 62/1000
295/295 - 58s - loss: 0.0137 - accuracy: 0.9948 - val_loss: 0.2116 - val_accuracy: 0.9438
Epoch 63/1000
295/295 - 58s - loss: 0.0085 - accuracy: 0.9964 - val_loss: 0.2502 - val_accuracy: 0.9363
Epoch 64/1000
295/295 - 58s - loss: 0.0053 - accuracy: 0.9976 - val_loss: 0.2147 - val_accuracy: 0.9472
Epoch 65/1000
295/295 - 58s - loss: 0.0138 - accuracy: 0.9950 - val_loss: 0.2464 - val_accuracy: 0.9358
Epoch 66/1000
295/295 - 58s - loss: 0.0090 - accuracy: 0.9964 - val_loss: 0.3009 - val_accuracy: 0.9218
Epoch 67/1000
295/295 - 58s - loss: 0.0088 - accuracy: 0.9967 - val_loss: 0.2523 - val_accuracy: 0.9307
Epoch 68/1000
295/295 - 57s - loss: 0.0092 - accuracy: 0.9964 - val_loss: 0.3293 - val_accuracy: 0.9147
Epoch 69/1000
295/295 - 58s - loss: 0.0041 - accuracy: 0.9984 - val_loss: 0.2155 - val_accuracy: 0.9462
Epoch 70/1000
295/295 - 58s - loss: 0.0032 - accuracy: 0.9985 - val_loss: 0.2172 - val_accuracy: 0.9438
Epoch 71/1000
295/295 - 58s - loss: 0.0065 - accuracy: 0.9974 - val_loss: 0.2477 - val_accuracy: 0.9416
Epoch 72/1000
295/295 - 58s - loss: 0.0259 - accuracy: 0.9908 - val_loss: 0.2606 - val_accuracy: 0.9346
Epoch 73/1000
295/295 - 58s - loss: 0.0061 - accuracy: 0.9974 - val_loss: 0.1780 - val_accuracy: 0.9535
Epoch 74/1000
295/295 - 58s - loss: 0.0048 - accuracy: 0.9980 - val_loss: 0.2213 - val_accuracy: 0.9465
Epoch 75/1000
295/295 - 58s - loss: 0.0047 - accuracy: 0.9983 - val_loss: 0.2399 - val_accuracy: 0.9465
Epoch 76/1000
295/295 - 58s - loss: 0.0119 - accuracy: 0.9955 - val_loss: 0.2698 - val_accuracy: 0.9331
Epoch 77/1000
295/295 - 57s - loss: 0.0078 - accuracy: 0.9968 - val_loss: 0.2333 - val_accuracy: 0.9409
Epoch 78/1000
295/295 - 57s - loss: 0.0048 - accuracy: 0.9980 - val_loss: 0.1954 - val_accuracy: 0.9523
Epoch 79/1000
295/295 - 58s - loss: 0.0078 - accuracy: 0.9970 - val_loss: 0.2452 - val_accuracy: 0.9426
Epoch 80/1000
295/295 - 57s - loss: 0.0138 - accuracy: 0.9947 - val_loss: 0.2822 - val_accuracy: 0.9239
Epoch 81/1000
295/295 - 58s - loss: 0.0116 - accuracy: 0.9952 - val_loss: 0.1948 - val_accuracy: 0.9494
Epoch 82/1000
295/295 - 58s - loss: 0.0036 - accuracy: 0.9985 - val_loss: 0.1984 - val_accuracy: 0.9542
Epoch 83/1000
295/295 - 57s - loss: 0.0032 - accuracy: 0.9984 - val_loss: 0.2594 - val_accuracy: 0.9455
Epoch 84/1000
295/295 - 58s - loss: 0.0027 - accuracy: 0.9983 - val_loss: 0.1681 - val_accuracy: 0.9586
Epoch 85/1000
295/295 - 57s - loss: 0.0023 - accuracy: 0.9988 - val_loss: 0.1698 - val_accuracy: 0.9600
Epoch 86/1000
295/295 - 58s - loss: 0.0031 - accuracy: 0.9985 - val_loss: 0.1772 - val_accuracy: 0.9552
Epoch 87/1000
295/295 - 58s - loss: 0.0029 - accuracy: 0.9987 - val_loss: 0.2603 - val_accuracy: 0.9457
Epoch 88/1000
295/295 - 57s - loss: 0.0281 - accuracy: 0.9903 - val_loss: 0.2156 - val_accuracy: 0.9397
Epoch 89/1000
295/295 - 58s - loss: 0.0106 - accuracy: 0.9958 - val_loss: 0.1794 - val_accuracy: 0.9523
Epoch 90/1000
295/295 - 57s - loss: 0.0048 - accuracy: 0.9980 - val_loss: 0.2214 - val_accuracy: 0.9431
Epoch 91/1000
295/295 - 57s - loss: 0.0041 - accuracy: 0.9981 - val_loss: 0.1891 - val_accuracy: 0.9540
Epoch 92/1000
295/295 - 58s - loss: 0.0045 - accuracy: 0.9980 - val_loss: 0.2627 - val_accuracy: 0.9363
Epoch 93/1000
295/295 - 58s - loss: 0.0133 - accuracy: 0.9952 - val_loss: 0.2607 - val_accuracy: 0.9385
Epoch 94/1000
295/295 - 58s - loss: 0.0090 - accuracy: 0.9961 - val_loss: 0.2031 - val_accuracy: 0.9482
Epoch 95/1000
295/295 - 58s - loss: 0.0031 - accuracy: 0.9985 - val_loss: 0.2275 - val_accuracy: 0.9528
Epoch 96/1000
295/295 - 58s - loss: 0.0116 - accuracy: 0.9955 - val_loss: 0.4954 - val_accuracy: 0.9215
Epoch 97/1000
295/295 - 58s - loss: 0.0087 - accuracy: 0.9964 - val_loss: 0.2165 - val_accuracy: 0.9448
Epoch 98/1000
295/295 - 58s - loss: 0.0045 - accuracy: 0.9979 - val_loss: 0.2183 - val_accuracy: 0.9477
Epoch 99/1000
295/295 - 58s - loss: 0.0028 - accuracy: 0.9987 - val_loss: 0.1846 - val_accuracy: 0.9559
Epoch 100/1000
295/295 - 58s - loss: 0.0036 - accuracy: 0.9984 - val_loss: 0.2346 - val_accuracy: 0.9479
Epoch 101/1000
295/295 - 58s - loss: 0.0162 - accuracy: 0.9939 - val_loss: 0.2611 - val_accuracy: 0.9295
Epoch 102/1000
295/295 - 58s - loss: 0.0085 - accuracy: 0.9966 - val_loss: 0.2024 - val_accuracy: 0.9491
Epoch 103/1000
295/295 - 58s - loss: 0.0076 - accuracy: 0.9972 - val_loss: 0.2509 - val_accuracy: 0.9448
Epoch 104/1000
295/295 - 58s - loss: 0.0066 - accuracy: 0.9974 - val_loss: 0.2401 - val_accuracy: 0.9474
2021-10-25 23:04:08.935762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 23:04:08.935805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 23:04:08.935846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 23:04:08.935913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 23:04:08.935919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 23:04:08.935925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 23:04:08.935930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 23:04:08.936182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 23:04:08.936213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'Xception_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'Xception', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\Xception_VISOB_left_aug_gender_base_F75M25.06-0.4203.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_16"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
xception (Functional)        (None, 5, 8, 2048)        20861480  
_________________________________________________________________
global_average_pooling2d_16  (None, 2048)              0         
_________________________________________________________________
dense_32 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_618 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_16 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_610 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_33 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 22,964,777
Trainable params: 2,101,249
Non-trainable params: 20,863,528
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\Xception_VISOB_left_aug_gender_base_F75M25.06-0.4203.hdf5
Model: "sequential_16"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
xception (Functional)        (None, 5, 8, 2048)        20861480  
_________________________________________________________________
global_average_pooling2d_16  (None, 2048)              0         
_________________________________________________________________
dense_32 (Dense)             (None, 1024)              2098176   
_________________________________________________________________
batch_normalization_618 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_16 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_610 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_33 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 22,964,777
Trainable params: 22,908,201
Non-trainable params: 56,576
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 23:05:13.177602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 23:05:16.684272: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3377_1002_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\3137_1008_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\iphone_dim_light_short\\iphone_dim_light_short\\enrollments_rgb\\3266_1007_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\iphone_day_light_short\\iphone_day_light_short\\verifications_rgb\\3442_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\verifications_rgb\\3443_1004_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  1
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 213s - loss: 0.4648 - accuracy: 0.7997 - val_loss: 0.3681 - val_accuracy: 0.8326
Epoch 2/1000
295/295 - 91s - loss: 0.2115 - accuracy: 0.9104 - val_loss: 0.3537 - val_accuracy: 0.8498
Epoch 3/1000
295/295 - 91s - loss: 0.1062 - accuracy: 0.9632 - val_loss: 0.3661 - val_accuracy: 0.8549
Epoch 4/1000
295/295 - 91s - loss: 0.0523 - accuracy: 0.9859 - val_loss: 0.3888 - val_accuracy: 0.8561
Epoch 5/1000
295/295 - 91s - loss: 0.0323 - accuracy: 0.9921 - val_loss: 0.3940 - val_accuracy: 0.8675
Epoch 6/1000
295/295 - 91s - loss: 0.0221 - accuracy: 0.9946 - val_loss: 0.4223 - val_accuracy: 0.8636
Epoch 7/1000
295/295 - 91s - loss: 0.0189 - accuracy: 0.9947 - val_loss: 0.4175 - val_accuracy: 0.8709
Epoch 8/1000
295/295 - 92s - loss: 0.0162 - accuracy: 0.9959 - val_loss: 0.4192 - val_accuracy: 0.8762
Epoch 9/1000
295/295 - 92s - loss: 0.0139 - accuracy: 0.9962 - val_loss: 0.4252 - val_accuracy: 0.8765
Epoch 10/1000
295/295 - 92s - loss: 0.0156 - accuracy: 0.9954 - val_loss: 0.4439 - val_accuracy: 0.8779
Epoch 11/1000
295/295 - 93s - loss: 0.0115 - accuracy: 0.9970 - val_loss: 0.4417 - val_accuracy: 0.8811
Epoch 12/1000
295/295 - 93s - loss: 0.0135 - accuracy: 0.9960 - val_loss: 0.4714 - val_accuracy: 0.8791
Epoch 13/1000
295/295 - 92s - loss: 0.0151 - accuracy: 0.9948 - val_loss: 0.4803 - val_accuracy: 0.8733
Epoch 14/1000
295/295 - 93s - loss: 0.0166 - accuracy: 0.9945 - val_loss: 0.4367 - val_accuracy: 0.8813
Epoch 15/1000
295/295 - 92s - loss: 0.0158 - accuracy: 0.9943 - val_loss: 0.4385 - val_accuracy: 0.8861
Epoch 16/1000
295/295 - 92s - loss: 0.0134 - accuracy: 0.9959 - val_loss: 0.4287 - val_accuracy: 0.8900
Epoch 17/1000
295/295 - 93s - loss: 0.0116 - accuracy: 0.9961 - val_loss: 0.4612 - val_accuracy: 0.8903
Epoch 18/1000
295/295 - 92s - loss: 0.0111 - accuracy: 0.9961 - val_loss: 0.4717 - val_accuracy: 0.8874
Epoch 19/1000
295/295 - 92s - loss: 0.0123 - accuracy: 0.9951 - val_loss: 0.4924 - val_accuracy: 0.8808
Epoch 20/1000
295/295 - 93s - loss: 0.0153 - accuracy: 0.9939 - val_loss: 0.4560 - val_accuracy: 0.8929
Epoch 21/1000
295/295 - 93s - loss: 0.0135 - accuracy: 0.9949 - val_loss: 0.4390 - val_accuracy: 0.8912
Epoch 22/1000
295/295 - 92s - loss: 0.0100 - accuracy: 0.9963 - val_loss: 0.4591 - val_accuracy: 0.8893
2021-10-25 23:40:39.217692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 23:40:39.217799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:65:00.0 name: Quadro RTX 6000 computeCapability: 7.5
coreClock: 1.77GHz coreCount: 72 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 625.94GiB/s
2021-10-25 23:40:39.218020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0, 1
2021-10-25 23:40:39.218230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-10-25 23:40:39.218251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2021-10-25 23:40:39.218269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N Y 
2021-10-25 23:40:39.218286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   Y N 
2021-10-25 23:40:39.218721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22053 MB memory) -> physical GPU (device: 0, name: Quadro RTX 6000, pci bus id: 0000:17:00.0, compute capability: 7.5)
2021-10-25 23:40:39.218820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 22053 MB memory) -> physical GPU (device: 1, name: Quadro RTX 6000, pci bus id: 0000:65:00.0, compute capability: 7.5)
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
WARNING:tensorflow:Collective ops is not configured at program startup. Some performance features may not be enabled.
Running... {'run_id': 'EfficientNetB0_VISOB_left_aug_gender_finetuned_F75M25', 'model': 'EfficientNetB0', 'class': 'gender', 'allow_growth': True, 'mode': 'train', 'test_mode': 0, 'fine-tune': True, 'ratio': 'F75M25', 'fold': '1', 'optimizer': {'name': 'adam', 'initial_learning_rate': 0.0003, 'lr_scheduler': 'none', 'first_decay_steps': 1000, 'decay_rate': 0.9}, 'train': {'batch_size': 256, 'gpu': [0, 1], 'epochs': 100, 'unfreeze_epoch': 1000, 'steps_per_batch': 100, 'validation_split': 0.2, 'buffer_size': 1024, 'ckpt_dir': 'F:\\Lab\\nfs\\base-visob\\checkpoints', 'pretrained': False, 'pretrained_weight': 'F:\\Lab\\nfs\\base-visob\\checkpoints\\EfficientNetB0_VISOB_left_aug_gender_base_F75M25.13-0.2884.hdf5', 'pretrained_epoch': 15}, 'input': {'type': 'left', 'image_height': 160, 'image_width': 240, 'channels': 3, 'train_dir': 'F:\\Lab\\datasets\\visob', 'eval_dir': 'F:\\Lab\\datasets\\visob', 'labels': 'F:\\Lab\\datasets\\visob\\gender.json', 'randaugment': True, 'randaugment_layers': 2, 'randaugment_magnitude': 12}}
Number of devices: 2
Model: "sequential_17"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb0 (Functional)  (None, 5, 8, 1280)        4049571   
_________________________________________________________________
global_average_pooling2d_17  (None, 1280)              0         
_________________________________________________________________
dense_34 (Dense)             (None, 1024)              1311744   
_________________________________________________________________
batch_normalization_619 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_17 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_611 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_35 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 5,366,436
Trainable params: 1,314,817
Non-trainable params: 4,051,619
_________________________________________________________________
Loading weights : F:\Lab\nfs\base-visob\checkpoints\EfficientNetB0_VISOB_left_aug_gender_base_F75M25.13-0.2884.hdf5
Model: "sequential_17"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb0 (Functional)  (None, 5, 8, 1280)        4049571   
_________________________________________________________________
global_average_pooling2d_17  (None, 1280)              0         
_________________________________________________________________
dense_34 (Dense)             (None, 1024)              1311744   
_________________________________________________________________
batch_normalization_619 (Bat (None, 1024)              4096      
_________________________________________________________________
dropout_17 (Dropout)         (None, 1024)              0         
_________________________________________________________________
activation_611 (Activation)  (None, 1024)              0         
_________________________________________________________________
dense_35 (Dense)             (None, 1)                 1025      
=================================================================
Total params: 5,366,436
Trainable params: 5,322,365
Non-trainable params: 44,071
_________________________________________________________________
{'1141': 0, '1142': 1, '1144': 1, '1147': 0, '1148': 0, '1149': 0, '1151': 1, '1152': 1, '1153': 1, '1154': 1, '1155': 1, '1156': 1, '1157': 1, '1158': 0, '1159': 1, '1160': 1, '1161': 1, '1162': 1, '1163': 0, '1166': 0, '1171': 1, '1172': 1, '1173': 1, '1174': 1, '1175': 1, '1176': 1, '1177': 1, '1181': 1, '1182': 1, '1183': 1, '1184': 1, '1185': 1, '1186': 0, '1187': 0, '1188': 0, '1178': 0, '1179': 0, '1189': 1, '1190': 1, '1191': 1, '1192': 0, '1193': 0, '1194': 1, '1195': 1, '1196': 1, '1197': 1, '1198': 1, '1199': 1, '1200': 1, '1234': 1, '2381': 0, '2382': 0, '2383': 0, '2386': 1, '2387': 1, '2390': 1, '2391': 0, '2481': 1, '2482': 1, '2483': 1, '2484': 1, '2485': 1, '2486': 1, '2487': 0, '2488': 0, '2511': 1, '2512': 1, '2513': 1, '2514': 0, '2515': 1, '2384': 0, '2385': 1, '2516': 1, '2523': 0, '2524': 1, '2525': 1, '2520': 1, '2521': 0, '2526': 1, '2527': 0, '2528': 1, '2529': 0, '2530': 0, '2531': 0, '2610': 0, '2611': 1, '2612': 1, '2613': 1, '2614': 1, '2615': 1, '2616': 1, '2617': 1, '2489': 1, '2618': 1, '2619': 1, '2620': 1, '2621': 1, '2710': 1, '2711': 1, '2720': 0, '2712': 1, '2713': 1, '2714': 1, '2715': 1, '2716': 0, '2717': 0, '2718': 1, '2810': 1, '2811': 1, '2812': 0, '2813': 1, '2814': 1, '2815': 1, '2816': 1, '2517': 1, '2518': 1, '2910': 1, '2911': 0, '2912': 0, '2913': 1, '2914': 0, '2915': 1, '2916': 1, '2917': 0, '2919': 1, '2920': 1, '2921': 0, '2922': 1, '2923': 1, '2924': 1, '2926': 1, '2927': 0, '2928': 0, '2929': 1, '2930': 0, '2931': 1, '2932': 1, '2933': 1, '2934': 1, '2935': 1, '2936': 1, '2937': 0, '2938': 0, '2939': 1, '2940': 0, '2941': 1, '2942': 0, '2943': 0, '2944': 0, '2945': 0, '2946': 1, '2947': 1, '2948': 1, '2949': 1, '2950': 1, '2951': 1, '2952': 1, '2953': 1, '2954': 1, '2955': 1, '2956': 0, '2957': 0, '2958': 1, '2959': 0, '2960': 0, '2961': 0, '2962': 0, '2963': 1, '2964': 1, '2965': 1, '2966': 1, '2967': 1, '2968': 1, '2970': 1, '2971': 1, '3110': 1, '3111': 1, '3112': 1, '3113': 0, '3114': 0, '3115': 1, '3116': 1, '3117': 1, '3118': 1, '3119': 0, '3120': 1, '3121': 1, '3122': 0, '3123': 1, '3124': 1, '3125': 1, '3126': 1, '3127': 0, '3128': 0, '3129': 1, '3130': 1, '3131': 0, '3132': 1, '3133': 1, '3134': 1, '3135': 1, '3136': 1, '3137': 0, '3138': 1, '3139': 1, '3140': 0, '3142': 0, '3143': 0, '3144': 1, '3145': 0, '3146': 0, '3147': 0, '3148': 1, '3149': 0, '3150': 1, '3151': 1, '3152': 0, '3200': 1, '3201': 0, '3202': 1, '3203': 1, '3204': 1, '3205': 0, '3206': 1, '3207': 1, '3208': 1, '3209': 0, '3210': 0, '3212': 0, '3211': 0, '3213': 0, '3214': 1, '3215': 1, '3216': 1, '3217': 0, '3218': 0, '3219': 1, '3220': 0, '3221': 0, '3222': 0, '3223': 1, '3224': 1, '3225': 1, '3226': 1, '3227': 1, '3228': 0, '3229': 0, '3230': 1, '3231': 0, '3233': 1, '3234': 1, '3235': 1, '3236': 1, '3237': 1, '3238': 1, '3239': 0, '3240': 0, '3241': 1, '3242': 1, '3243': 1, '3244': 0, '3245': 0, '3246': 1, '3247': 0, '3248': 0, '3249': 1, '3250': 1, '3251': 0, '3252': 1, '3253': 0, '3254': 1, '3255': 1, '3256': 1, '3257': 0, '3258': 1, '3259': 1, '3260': 1, '3261': 1, '3262': 1, '3263': 1, '3264': 1, '3265': 1, '3266': 1, '3267': 1, '3268': 1, '3269': 0, '3270': 0, '3271': 1, '3272': 0, '3273': 0, '3274': 1, '3275': 0, '3276': 0, '3277': 1, '3278': 0, '3280': 1, '3279': 1, '3281': 1, '3282': 0, '3283': 1, '3284': 1, '3285': 1, '3286': 1, '3287': 1, '3288': 1, '3289': 1, '3290': 1, '3291': 1, '3292': 0, '3293': 1, '3294': 1, '3295': 1, '3296': 1, '3297': 1, '3298': 1, '3299': 0, '3300': 1, '3301': 1, '3302': 0, '3303': 1, '3304': 0, '3305': 1, '3306': 1, '3307': 1, '3308': 1, '3309': 1, '3310': 1, '3311': 1, '3312': 1, '3313': 1, '3314': 1, '3315': 1, '3316': 0, '3317': 0, '3318': 1, '3319': 1, '3320': 1, '3321': 1, '3322': 0, '3325': 0, '3326': 1, '3328': 1, '3329': 1, '3330': 0, '3331': 0, '3332': 0, '3333': 1, '3334': 0, '3335': 1, '3336': 1, '3337': 0, '3338': 1, '3339': 0, '3340': 0, '3341': 1, '3342': 0, '3343': 1, '3344': 1, '3345': 1, '3346': 1, '3347': 0, '3348': 0, '3349': 1, '3350': 0, '3351': 1, '3352': 1, '3353': 0, '3354': 1, '3355': 1, '3356': 0, '3357': 1, '3558': 0, '3559': 1, '3360': 1, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0, '3367': 0, '3368': 1, '3369': 1, '3370': 0, '3371': 0, '3372': 1, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 1, '3378': 1, '3379': 1, '3380': 1, '3381': 0, '3382': 0, '3383': 0, '3384': 0, '3385': 0, '3386': 0, '3387': 1, '3389': 1, '3390': 0, '3391': 0, '3392': 1, '3393': 1, '3394': 0, '3395': 0, '3396': 1, '3397': 0, '3400': 0, '3401': 1, '3402': 1, '3403': 0, '3404': 0, '3405': 1, '3406': 0, '3407': 1, '3399': 1, '3408': 1, '3409': 1, '3410': 0, '3411': 0, '3412': 0, '3413': 0, '3414': 1, '3415': 0, '3416': 1, '3417': 1, '3418': 1, '3419': 0, '3420': 0, '3421': 1, '3422': 0, '3423': 0, '3424': 1, '3425': 1, '3426': 1, '3427': 0, '3428': 0, '3429': 0, '3430': 1, '3431': 0, '3432': 0, '3433': 0, '3434': 1, '3435': 0, '3436': 1, '3437': 1, '3438': 1, '3439': 1, '3440': 1, '3441': 0, '3442': 0, '3443': 0, '3444': 1, '3445': 1, '3446': 1, '3447': 1, '3448': 0, '3449': 1, '3450': 0, '3451': 0, '3452': 0, '3453': 1, '3454': 0, '3455': 0, '3456': 1, '3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}2021-10-25 23:42:14.079586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 1 of 1024
2021-10-25 23:42:14.079726: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 2 of 1024
2021-10-25 23:42:14.079761: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 3 of 1024
2021-10-25 23:42:20.524354: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 988 of 1024
2021-10-25 23:42:20.690734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.
2021-10-25 23:45:04.815819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:177] Filling up shuffle buffer (this may take a while): 977 of 1024
2021-10-25 23:45:05.196117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:230] Shuffle buffer filled.

                                                   0  1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  1  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  2  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  3  0
Male : 5160, Female: 15481
{'3457': 1, '3458': 1, '3459': 1, '3460': 0, '3461': 0, '3462': 1, '3463': 1, '3464': 0, '3465': 1, '3466': 0, '3467': 0, '3468': 0, '3469': 1, '3470': 0, '3471': 0, '3472': 0, '3473': 1, '3474': 0, '3475': 1, '3476': 0, '3477': 0, '3478': 0, '3479': 1, '3480': 0, '3481': 1, '3482': 0, '3483': 1, '3484': 1, '3485': 1, '3486': 1, '3487': 1, '3488': 0, '3489': 1, '3490': 1, '3491': 1, '3493': 1, '3494': 1, '3495': 1, '3496': 1, '3497': 1, '3498': 1, '3499': 0, '3500': 0, '3501': 0, '3502': 1, '3503': 1, '3504': 1, '3505': 1, '5406': 1, '5407': 1, '5408': 0, '5409': 1, '5410': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  468  1
Male : 586, Female: 1758
{'5411': 1, '5412': 0, '5413': 1, '5414': 0, '5415': 1, '5416': 0, '2721': 1, '5417': 1, '5418': 1, '5419': 1, '5420': 1, '5421': 0, '5422': 0, '5423': 0, '3551': 1, '3552': 1, '3553': 1, '3554': 1, '3555': 1, '3556': 1, '3557': 1, '3560': 1, '3561': 1, '5425': 0, '5426': 1, '5427': 0, '5428': 0, '5429': 0, '5430': 1, '5431': 1, '5432': 1, '3562': 1, '3563': 1, '3564': 1, '3565': 1, '5433': 1, '3566': 0, '3567': 0, '3568': 1, '3569': 0, '3570': 0, '3571': 1, '5550': 0, '5438': 1, '5434': 1, '5435': 1, '5551': 1, '5436': 1, '5437': 1, '5552': 1, '5553': 0, '5554': 0, '5555': 1, '6000': 1, '6001': 1, '6002': 1, '6003': 1, '6004': 0}
                                                   0    1  2
0  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
1  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
2  F:\Lab\datasets\visob\iphone_day_light_short\i...  527  1
3  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
4  F:\Lab\datasets\visob\iphone_day_light_short\i...  536  1
Male : 3453, Female: 1792
b'F:\\Lab\\datasets\\visob\\iphone_office_short\\iphone_office_short\\enrollments_rgb\\3283_1001_l_c.png' 1
b'F:\\Lab\\datasets\\visob\\oppo_dim_light_short\\oppo_dim_light_short\\enrollments_rgb\\3317_1003_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_day_light_short\\samsung_day_light_short\\enrollments_rgb\\2383_1004_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_day_light_short\\samsung_day_light_short\\enrollments_rgb\\1158_1001_l_c.png' 0
b'F:\\Lab\\datasets\\visob\\samsung_dim_light_short\\samsung_dim_light_short\\verifications_rgb\\3210_1003_l_c.png' 0
Image shape:  (160, 240, 3)
Label:  1
Train Size : 18857
Validation Size : 4128
Test Size : 5245
Epoch 1/1000
295/295 - 291s - loss: 0.5325 - accuracy: 0.7927 - val_loss: 0.4240 - val_accuracy: 0.8270
Epoch 2/1000
295/295 - 80s - loss: 0.3391 - accuracy: 0.8507 - val_loss: 0.3433 - val_accuracy: 0.8556
Epoch 3/1000
295/295 - 80s - loss: 0.2629 - accuracy: 0.8824 - val_loss: 0.3125 - val_accuracy: 0.8668
Epoch 4/1000
295/295 - 81s - loss: 0.2179 - accuracy: 0.9049 - val_loss: 0.2948 - val_accuracy: 0.8757
Epoch 5/1000
295/295 - 81s - loss: 0.1776 - accuracy: 0.9243 - val_loss: 0.2807 - val_accuracy: 0.8794
Epoch 6/1000
295/295 - 79s - loss: 0.1485 - accuracy: 0.9386 - val_loss: 0.2659 - val_accuracy: 0.8898
Epoch 7/1000
295/295 - 80s - loss: 0.1261 - accuracy: 0.9501 - val_loss: 0.2547 - val_accuracy: 0.8937
Epoch 8/1000
295/295 - 80s - loss: 0.1080 - accuracy: 0.9580 - val_loss: 0.2457 - val_accuracy: 0.8983
Epoch 9/1000
295/295 - 81s - loss: 0.0889 - accuracy: 0.9664 - val_loss: 0.2523 - val_accuracy: 0.9000
Epoch 10/1000
295/295 - 81s - loss: 0.0817 - accuracy: 0.9702 - val_loss: 0.2418 - val_accuracy: 0.9007
Epoch 11/1000
295/295 - 81s - loss: 0.0669 - accuracy: 0.9757 - val_loss: 0.2408 - val_accuracy: 0.9067
Epoch 12/1000
295/295 - 81s - loss: 0.0620 - accuracy: 0.9783 - val_loss: 0.2445 - val_accuracy: 0.9087
Epoch 13/1000
295/295 - 81s - loss: 0.0551 - accuracy: 0.9807 - val_loss: 0.2345 - val_accuracy: 0.9130
Epoch 14/1000
295/295 - 80s - loss: 0.0478 - accuracy: 0.9837 - val_loss: 0.2301 - val_accuracy: 0.9135
Epoch 15/1000
295/295 - 80s - loss: 0.0415 - accuracy: 0.9859 - val_loss: 0.2371 - val_accuracy: 0.9157
Epoch 16/1000
295/295 - 80s - loss: 0.0370 - accuracy: 0.9877 - val_loss: 0.2387 - val_accuracy: 0.9205
Epoch 17/1000
295/295 - 80s - loss: 0.0323 - accuracy: 0.9894 - val_loss: 0.2396 - val_accuracy: 0.9188
Epoch 18/1000
295/295 - 81s - loss: 0.0353 - accuracy: 0.9872 - val_loss: 0.2410 - val_accuracy: 0.9218
Epoch 19/1000
295/295 - 82s - loss: 0.0291 - accuracy: 0.9901 - val_loss: 0.2412 - val_accuracy: 0.9205
Epoch 20/1000
295/295 - 81s - loss: 0.0314 - accuracy: 0.9890 - val_loss: 0.2429 - val_accuracy: 0.9218
Epoch 21/1000
295/295 - 81s - loss: 0.0292 - accuracy: 0.9903 - val_loss: 0.2332 - val_accuracy: 0.9232
Epoch 22/1000
295/295 - 80s - loss: 0.0254 - accuracy: 0.9912 - val_loss: 0.2321 - val_accuracy: 0.9232
Epoch 23/1000
295/295 - 79s - loss: 0.0226 - accuracy: 0.9924 - val_loss: 0.2359 - val_accuracy: 0.9261
Epoch 24/1000
295/295 - 80s - loss: 0.0211 - accuracy: 0.9926 - val_loss: 0.2414 - val_accuracy: 0.9210
Epoch 25/1000
295/295 - 78s - loss: 0.0227 - accuracy: 0.9919 - val_loss: 0.2307 - val_accuracy: 0.9271
Epoch 26/1000
295/295 - 77s - loss: 0.0203 - accuracy: 0.9935 - val_loss: 0.2410 - val_accuracy: 0.9264
Epoch 27/1000
295/295 - 77s - loss: 0.0189 - accuracy: 0.9940 - val_loss: 0.2393 - val_accuracy: 0.9232
Epoch 28/1000
295/295 - 77s - loss: 0.0168 - accuracy: 0.9939 - val_loss: 0.2302 - val_accuracy: 0.9254
Epoch 29/1000
295/295 - 77s - loss: 0.0156 - accuracy: 0.9951 - val_loss: 0.2392 - val_accuracy: 0.9271
Epoch 30/1000
295/295 - 77s - loss: 0.0165 - accuracy: 0.9945 - val_loss: 0.2266 - val_accuracy: 0.9293
Epoch 31/1000
295/295 - 77s - loss: 0.0154 - accuracy: 0.9947 - val_loss: 0.2418 - val_accuracy: 0.9261
Epoch 32/1000
295/295 - 77s - loss: 0.0146 - accuracy: 0.9949 - val_loss: 0.2460 - val_accuracy: 0.9312
Epoch 33/1000
295/295 - 77s - loss: 0.0145 - accuracy: 0.9952 - val_loss: 0.2369 - val_accuracy: 0.9310
Epoch 34/1000
295/295 - 77s - loss: 0.0132 - accuracy: 0.9955 - val_loss: 0.2370 - val_accuracy: 0.9314
Epoch 35/1000
295/295 - 78s - loss: 0.0126 - accuracy: 0.9955 - val_loss: 0.2479 - val_accuracy: 0.9305
Epoch 36/1000
295/295 - 77s - loss: 0.0117 - accuracy: 0.9961 - val_loss: 0.2342 - val_accuracy: 0.9346
Epoch 37/1000
295/295 - 77s - loss: 0.0135 - accuracy: 0.9957 - val_loss: 0.2451 - val_accuracy: 0.9305
Epoch 38/1000
295/295 - 79s - loss: 0.0127 - accuracy: 0.9958 - val_loss: 0.2343 - val_accuracy: 0.9319
Epoch 39/1000
295/295 - 77s - loss: 0.0108 - accuracy: 0.9967 - val_loss: 0.2388 - val_accuracy: 0.9341
Epoch 40/1000
295/295 - 77s - loss: 0.0112 - accuracy: 0.9959 - val_loss: 0.2403 - val_accuracy: 0.9314
Epoch 41/1000
295/295 - 77s - loss: 0.0126 - accuracy: 0.9958 - val_loss: 0.2496 - val_accuracy: 0.9293
Epoch 42/1000
295/295 - 77s - loss: 0.0136 - accuracy: 0.9947 - val_loss: 0.2468 - val_accuracy: 0.9314
Epoch 43/1000
295/295 - 76s - loss: 0.0105 - accuracy: 0.9961 - val_loss: 0.2352 - val_accuracy: 0.9346
Epoch 44/1000
295/295 - 76s - loss: 0.0099 - accuracy: 0.9961 - val_loss: 0.2380 - val_accuracy: 0.9312
Epoch 45/1000
295/295 - 77s - loss: 0.0091 - accuracy: 0.9967 - val_loss: 0.2303 - val_accuracy: 0.9351
Epoch 46/1000
295/295 - 77s - loss: 0.0091 - accuracy: 0.9970 - val_loss: 0.2315 - val_accuracy: 0.9348
Epoch 47/1000
295/295 - 77s - loss: 0.0103 - accuracy: 0.9966 - val_loss: 0.2388 - val_accuracy: 0.9329
Epoch 48/1000
295/295 - 76s - loss: 0.0099 - accuracy: 0.9966 - val_loss: 0.2356 - val_accuracy: 0.9339
Epoch 49/1000
295/295 - 77s - loss: 0.0089 - accuracy: 0.9964 - val_loss: 0.2305 - val_accuracy: 0.9365
Epoch 50/1000
295/295 - 77s - loss: 0.0086 - accuracy: 0.9970 - val_loss: 0.2352 - val_accuracy: 0.9331
F:\Lab\env\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
